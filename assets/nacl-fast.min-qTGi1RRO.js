const c5=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},h5=typeof c5=="object"&&"crypto"in c5?c5.crypto:void 0,m={};var v=function(o){var a,t=new Float64Array(16);if(o)for(a=0;a<o.length;a++)t[a]=o[a];return t},A5=function(){throw Error("no PRNG")},S5=new Uint8Array(32);S5[0]=9;var M5=v(),y5=v([1]),W5=v([56129,1]),D5=v([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),H5=v([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d5=v([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),F5=v([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),O5=v([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p5(o,a,t,r){o[a]=t>>24&255,o[a+1]=t>>16&255,o[a+2]=t>>8&255,o[a+3]=255&t,o[a+4]=r>>24&255,o[a+5]=r>>16&255,o[a+6]=r>>8&255,o[a+7]=255&r}function X5(o,a,t,r){return(function(f,i,w,n,M){var A,c=0;for(A=0;A<M;A++)c|=f[i+A]^w[n+A];return(1&c-1>>>8)-1})(o,a,t,r,32)}function f5(o,a){var t;for(t=0;t<16;t++)o[t]=0|a[t]}function w5(o){var a,t,r=1;for(a=0;a<16;a++)t=o[a]+r+65535,r=Math.floor(t/65536),o[a]=t-65536*r;o[0]+=r-1+37*(r-1)}function i5(o,a,t){for(var r,f=~(t-1),i=0;i<16;i++)r=f&(o[i]^a[i]),o[i]^=r,a[i]^=r}function l5(o,a){var t,r,f,i=v(),w=v();for(t=0;t<16;t++)w[t]=a[t];for(w5(w),w5(w),w5(w),r=0;r<2;r++){for(i[0]=w[0]-65517,t=1;t<15;t++)i[t]=w[t]-65535-(i[t-1]>>16&1),i[t-1]&=65535;i[15]=w[15]-32767-(i[14]>>16&1),f=i[15]>>16&1,i[14]&=65535,i5(w,i,1-f)}for(t=0;t<16;t++)o[2*t]=255&w[t],o[2*t+1]=w[t]>>8}function R5(o,a){var t=new Uint8Array(32),r=new Uint8Array(32);return l5(t,o),l5(r,a),X5(t,0,r,0)}function _5(o){var a=new Uint8Array(32);return l5(a,o),1&a[0]}function $5(o,a){var t;for(t=0;t<16;t++)o[t]=a[2*t]+(a[2*t+1]<<8);o[15]&=32767}function r5(o,a,t){for(var r=0;r<16;r++)o[r]=a[r]+t[r]}function t5(o,a,t){for(var r=0;r<16;r++)o[r]=a[r]-t[r]}function F(o,a,t){var r,f,i=0,w=0,n=0,M=0,A=0,c=0,g=0,b=0,p=0,I=0,D=0,H=0,B=0,X=0,S=0,U=0,N=0,R=0,d=0,e=0,u=0,s=0,l=0,y=0,h=0,x=0,P=0,j=0,E=0,o5=0,e5=0,V=t[0],J=t[1],T=t[2],O=t[3],Y=t[4],_=t[5],$=t[6],Q=t[7],Z=t[8],q=t[9],W=t[10],G=t[11],K=t[12],C=t[13],L=t[14],z=t[15];i+=(r=a[0])*V,w+=r*J,n+=r*T,M+=r*O,A+=r*Y,c+=r*_,g+=r*$,b+=r*Q,p+=r*Z,I+=r*q,D+=r*W,H+=r*G,B+=r*K,X+=r*C,S+=r*L,U+=r*z,w+=(r=a[1])*V,n+=r*J,M+=r*T,A+=r*O,c+=r*Y,g+=r*_,b+=r*$,p+=r*Q,I+=r*Z,D+=r*q,H+=r*W,B+=r*G,X+=r*K,S+=r*C,U+=r*L,N+=r*z,n+=(r=a[2])*V,M+=r*J,A+=r*T,c+=r*O,g+=r*Y,b+=r*_,p+=r*$,I+=r*Q,D+=r*Z,H+=r*q,B+=r*W,X+=r*G,S+=r*K,U+=r*C,N+=r*L,R+=r*z,M+=(r=a[3])*V,A+=r*J,c+=r*T,g+=r*O,b+=r*Y,p+=r*_,I+=r*$,D+=r*Q,H+=r*Z,B+=r*q,X+=r*W,S+=r*G,U+=r*K,N+=r*C,R+=r*L,d+=r*z,A+=(r=a[4])*V,c+=r*J,g+=r*T,b+=r*O,p+=r*Y,I+=r*_,D+=r*$,H+=r*Q,B+=r*Z,X+=r*q,S+=r*W,U+=r*G,N+=r*K,R+=r*C,d+=r*L,e+=r*z,c+=(r=a[5])*V,g+=r*J,b+=r*T,p+=r*O,I+=r*Y,D+=r*_,H+=r*$,B+=r*Q,X+=r*Z,S+=r*q,U+=r*W,N+=r*G,R+=r*K,d+=r*C,e+=r*L,u+=r*z,g+=(r=a[6])*V,b+=r*J,p+=r*T,I+=r*O,D+=r*Y,H+=r*_,B+=r*$,X+=r*Q,S+=r*Z,U+=r*q,N+=r*W,R+=r*G,d+=r*K,e+=r*C,u+=r*L,s+=r*z,b+=(r=a[7])*V,p+=r*J,I+=r*T,D+=r*O,H+=r*Y,B+=r*_,X+=r*$,S+=r*Q,U+=r*Z,N+=r*q,R+=r*W,d+=r*G,e+=r*K,u+=r*C,s+=r*L,l+=r*z,p+=(r=a[8])*V,I+=r*J,D+=r*T,H+=r*O,B+=r*Y,X+=r*_,S+=r*$,U+=r*Q,N+=r*Z,R+=r*q,d+=r*W,e+=r*G,u+=r*K,s+=r*C,l+=r*L,y+=r*z,I+=(r=a[9])*V,D+=r*J,H+=r*T,B+=r*O,X+=r*Y,S+=r*_,U+=r*$,N+=r*Q,R+=r*Z,d+=r*q,e+=r*W,u+=r*G,s+=r*K,l+=r*C,y+=r*L,h+=r*z,D+=(r=a[10])*V,H+=r*J,B+=r*T,X+=r*O,S+=r*Y,U+=r*_,N+=r*$,R+=r*Q,d+=r*Z,e+=r*q,u+=r*W,s+=r*G,l+=r*K,y+=r*C,h+=r*L,x+=r*z,H+=(r=a[11])*V,B+=r*J,X+=r*T,S+=r*O,U+=r*Y,N+=r*_,R+=r*$,d+=r*Q,e+=r*Z,u+=r*q,s+=r*W,l+=r*G,y+=r*K,h+=r*C,x+=r*L,P+=r*z,B+=(r=a[12])*V,X+=r*J,S+=r*T,U+=r*O,N+=r*Y,R+=r*_,d+=r*$,e+=r*Q,u+=r*Z,s+=r*q,l+=r*W,y+=r*G,h+=r*K,x+=r*C,P+=r*L,j+=r*z,X+=(r=a[13])*V,S+=r*J,U+=r*T,N+=r*O,R+=r*Y,d+=r*_,e+=r*$,u+=r*Q,s+=r*Z,l+=r*q,y+=r*W,h+=r*G,x+=r*K,P+=r*C,j+=r*L,E+=r*z,S+=(r=a[14])*V,U+=r*J,N+=r*T,R+=r*O,d+=r*Y,e+=r*_,u+=r*$,s+=r*Q,l+=r*Z,y+=r*q,h+=r*W,x+=r*G,P+=r*K,j+=r*C,E+=r*L,o5+=r*z,U+=(r=a[15])*V,w+=38*(R+=r*T),n+=38*(d+=r*O),M+=38*(e+=r*Y),A+=38*(u+=r*_),c+=38*(s+=r*$),g+=38*(l+=r*Q),b+=38*(y+=r*Z),p+=38*(h+=r*q),I+=38*(x+=r*W),D+=38*(P+=r*G),H+=38*(j+=r*K),B+=38*(E+=r*C),X+=38*(o5+=r*L),S+=38*(e5+=r*z),i=(r=(i+=38*(N+=r*J))+(f=1)+65535)-65536*(f=Math.floor(r/65536)),w=(r=w+f+65535)-65536*(f=Math.floor(r/65536)),n=(r=n+f+65535)-65536*(f=Math.floor(r/65536)),M=(r=M+f+65535)-65536*(f=Math.floor(r/65536)),A=(r=A+f+65535)-65536*(f=Math.floor(r/65536)),c=(r=c+f+65535)-65536*(f=Math.floor(r/65536)),g=(r=g+f+65535)-65536*(f=Math.floor(r/65536)),b=(r=b+f+65535)-65536*(f=Math.floor(r/65536)),p=(r=p+f+65535)-65536*(f=Math.floor(r/65536)),I=(r=I+f+65535)-65536*(f=Math.floor(r/65536)),D=(r=D+f+65535)-65536*(f=Math.floor(r/65536)),H=(r=H+f+65535)-65536*(f=Math.floor(r/65536)),B=(r=B+f+65535)-65536*(f=Math.floor(r/65536)),X=(r=X+f+65535)-65536*(f=Math.floor(r/65536)),S=(r=S+f+65535)-65536*(f=Math.floor(r/65536)),U=(r=U+f+65535)-65536*(f=Math.floor(r/65536)),i=(r=(i+=f-1+37*(f-1))+(f=1)+65535)-65536*(f=Math.floor(r/65536)),w=(r=w+f+65535)-65536*(f=Math.floor(r/65536)),n=(r=n+f+65535)-65536*(f=Math.floor(r/65536)),M=(r=M+f+65535)-65536*(f=Math.floor(r/65536)),A=(r=A+f+65535)-65536*(f=Math.floor(r/65536)),c=(r=c+f+65535)-65536*(f=Math.floor(r/65536)),g=(r=g+f+65535)-65536*(f=Math.floor(r/65536)),b=(r=b+f+65535)-65536*(f=Math.floor(r/65536)),p=(r=p+f+65535)-65536*(f=Math.floor(r/65536)),I=(r=I+f+65535)-65536*(f=Math.floor(r/65536)),D=(r=D+f+65535)-65536*(f=Math.floor(r/65536)),H=(r=H+f+65535)-65536*(f=Math.floor(r/65536)),B=(r=B+f+65535)-65536*(f=Math.floor(r/65536)),X=(r=X+f+65535)-65536*(f=Math.floor(r/65536)),S=(r=S+f+65535)-65536*(f=Math.floor(r/65536)),U=(r=U+f+65535)-65536*(f=Math.floor(r/65536)),i+=f-1+37*(f-1),o[0]=i,o[1]=w,o[2]=n,o[3]=M,o[4]=A,o[5]=c,o[6]=g,o[7]=b,o[8]=p,o[9]=I,o[10]=D,o[11]=H,o[12]=B,o[13]=X,o[14]=S,o[15]=U}function k(o,a){F(o,a,a)}function B5(o,a){var t,r=v();for(t=0;t<16;t++)r[t]=a[t];for(t=253;t>=0;t--)k(r,r),t!==2&&t!==4&&F(r,r,a);for(t=0;t<16;t++)o[t]=r[t]}function J5(o,a,t){var r,f,i=new Uint8Array(32),w=new Float64Array(80),n=v(),M=v(),A=v(),c=v(),g=v(),b=v();for(f=0;f<31;f++)i[f]=a[f];for(i[31]=127&a[31]|64,i[0]&=248,$5(w,t),f=0;f<16;f++)M[f]=w[f],c[f]=n[f]=A[f]=0;for(n[0]=c[0]=1,f=254;f>=0;--f)i5(n,M,r=i[f>>>3]>>>(7&f)&1),i5(A,c,r),r5(g,n,A),t5(n,n,A),r5(A,M,c),t5(M,M,c),k(c,g),k(b,n),F(n,A,n),F(A,M,g),r5(g,n,A),t5(n,n,A),k(M,n),t5(A,c,b),F(n,A,W5),r5(n,n,c),F(A,A,n),F(n,c,b),F(c,M,w),k(M,g),i5(n,M,r),i5(A,c,r);for(f=0;f<16;f++)w[f+16]=n[f],w[f+32]=A[f],w[f+48]=M[f],w[f+64]=c[f];var p=w.subarray(32),I=w.subarray(16);return B5(p,p),F(I,I,p),l5(o,I),0}function V5(o,a){return J5(o,a,S5)}var Y5=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Z5(o,a,t,r){for(var f,i,w,n,M,A,c,g,b,p,I,D,H,B,X,S,U,N,R,d,e,u,s,l,y,h,x=new Int32Array(16),P=new Int32Array(16),j=o[0],E=o[1],o5=o[2],e5=o[3],V=o[4],J=o[5],T=o[6],O=o[7],Y=a[0],_=a[1],$=a[2],Q=a[3],Z=a[4],q=a[5],W=a[6],G=a[7],K=0;r>=128;){for(R=0;R<16;R++)d=8*R+K,x[R]=t[d+0]<<24|t[d+1]<<16|t[d+2]<<8|t[d+3],P[R]=t[d+4]<<24|t[d+5]<<16|t[d+6]<<8|t[d+7];for(R=0;R<80;R++)if(f=j,i=E,w=o5,n=e5,M=V,A=J,c=T,b=Y,p=_,I=$,D=Q,H=Z,B=q,X=W,s=65535&(u=G),l=u>>>16,y=65535&(e=O),h=e>>>16,s+=65535&(u=(Z>>>14|V<<18)^(Z>>>18|V<<14)^(V>>>9|Z<<23)),l+=u>>>16,y+=65535&(e=(V>>>14|Z<<18)^(V>>>18|Z<<14)^(Z>>>9|V<<23)),h+=e>>>16,s+=65535&(u=Z&q^~Z&W),l+=u>>>16,y+=65535&(e=V&J^~V&T),h+=e>>>16,s+=65535&(u=Y5[2*R+1]),l+=u>>>16,y+=65535&(e=Y5[2*R]),h+=e>>>16,e=x[R%16],l+=(u=P[R%16])>>>16,y+=65535&e,h+=e>>>16,y+=(l+=(s+=65535&u)>>>16)>>>16,s=65535&(u=N=65535&s|l<<16),l=u>>>16,y=65535&(e=U=65535&y|(h+=y>>>16)<<16),h=e>>>16,s+=65535&(u=(Y>>>28|j<<4)^(j>>>2|Y<<30)^(j>>>7|Y<<25)),l+=u>>>16,y+=65535&(e=(j>>>28|Y<<4)^(Y>>>2|j<<30)^(Y>>>7|j<<25)),h+=e>>>16,l+=(u=Y&_^Y&$^_&$)>>>16,y+=65535&(e=j&E^j&o5^E&o5),h+=e>>>16,g=65535&(y+=(l+=(s+=65535&u)>>>16)>>>16)|(h+=y>>>16)<<16,S=65535&s|l<<16,s=65535&(u=D),l=u>>>16,y=65535&(e=n),h=e>>>16,l+=(u=N)>>>16,y+=65535&(e=U),h+=e>>>16,E=f,o5=i,e5=w,V=n=65535&(y+=(l+=(s+=65535&u)>>>16)>>>16)|(h+=y>>>16)<<16,J=M,T=A,O=c,j=g,_=b,$=p,Q=I,Z=D=65535&s|l<<16,q=H,W=B,G=X,Y=S,R%16==15)for(d=0;d<16;d++)e=x[d],s=65535&(u=P[d]),l=u>>>16,y=65535&e,h=e>>>16,e=x[(d+9)%16],s+=65535&(u=P[(d+9)%16]),l+=u>>>16,y+=65535&e,h+=e>>>16,U=x[(d+1)%16],s+=65535&(u=((N=P[(d+1)%16])>>>1|U<<31)^(N>>>8|U<<24)^(N>>>7|U<<25)),l+=u>>>16,y+=65535&(e=(U>>>1|N<<31)^(U>>>8|N<<24)^U>>>7),h+=e>>>16,U=x[(d+14)%16],l+=(u=((N=P[(d+14)%16])>>>19|U<<13)^(U>>>29|N<<3)^(N>>>6|U<<26))>>>16,y+=65535&(e=(U>>>19|N<<13)^(N>>>29|U<<3)^U>>>6),h+=e>>>16,h+=(y+=(l+=(s+=65535&u)>>>16)>>>16)>>>16,x[d]=65535&y|h<<16,P[d]=65535&s|l<<16;s=65535&(u=Y),l=u>>>16,y=65535&(e=j),h=e>>>16,e=o[0],l+=(u=a[0])>>>16,y+=65535&e,h+=e>>>16,h+=(y+=(l+=(s+=65535&u)>>>16)>>>16)>>>16,o[0]=j=65535&y|h<<16,a[0]=Y=65535&s|l<<16,s=65535&(u=_),l=u>>>16,y=65535&(e=E),h=e>>>16,e=o[1],l+=(u=a[1])>>>16,y+=65535&e,h+=e>>>16,h+=(y+=(l+=(s+=65535&u)>>>16)>>>16)>>>16,o[1]=E=65535&y|h<<16,a[1]=_=65535&s|l<<16,s=65535&(u=$),l=u>>>16,y=65535&(e=o5),h=e>>>16,e=o[2],l+=(u=a[2])>>>16,y+=65535&e,h+=e>>>16,h+=(y+=(l+=(s+=65535&u)>>>16)>>>16)>>>16,o[2]=o5=65535&y|h<<16,a[2]=$=65535&s|l<<16,s=65535&(u=Q),l=u>>>16,y=65535&(e=e5),h=e>>>16,e=o[3],l+=(u=a[3])>>>16,y+=65535&e,h+=e>>>16,h+=(y+=(l+=(s+=65535&u)>>>16)>>>16)>>>16,o[3]=e5=65535&y|h<<16,a[3]=Q=65535&s|l<<16,s=65535&(u=Z),l=u>>>16,y=65535&(e=V),h=e>>>16,e=o[4],l+=(u=a[4])>>>16,y+=65535&e,h+=e>>>16,h+=(y+=(l+=(s+=65535&u)>>>16)>>>16)>>>16,o[4]=V=65535&y|h<<16,a[4]=Z=65535&s|l<<16,s=65535&(u=q),l=u>>>16,y=65535&(e=J),h=e>>>16,e=o[5],l+=(u=a[5])>>>16,y+=65535&e,h+=e>>>16,h+=(y+=(l+=(s+=65535&u)>>>16)>>>16)>>>16,o[5]=J=65535&y|h<<16,a[5]=q=65535&s|l<<16,s=65535&(u=W),l=u>>>16,y=65535&(e=T),h=e>>>16,e=o[6],l+=(u=a[6])>>>16,y+=65535&e,h+=e>>>16,h+=(y+=(l+=(s+=65535&u)>>>16)>>>16)>>>16,o[6]=T=65535&y|h<<16,a[6]=W=65535&s|l<<16,s=65535&(u=G),l=u>>>16,y=65535&(e=O),h=e>>>16,e=o[7],l+=(u=a[7])>>>16,y+=65535&e,h+=e>>>16,h+=(y+=(l+=(s+=65535&u)>>>16)>>>16)>>>16,o[7]=O=65535&y|h<<16,a[7]=G=65535&s|l<<16,K+=128,r-=128}return r}function u5(o,a,t){var r,f=new Int32Array(8),i=new Int32Array(8),w=new Uint8Array(256),n=t;for(f[0]=1779033703,f[1]=3144134277,f[2]=1013904242,f[3]=2773480762,f[4]=1359893119,f[5]=2600822924,f[6]=528734635,f[7]=1541459225,i[0]=4089235720,i[1]=2227873595,i[2]=4271175723,i[3]=1595750129,i[4]=2917565137,i[5]=725511199,i[6]=4215389547,i[7]=327033209,Z5(f,i,a,t),t%=128,r=0;r<t;r++)w[r]=a[n-t+r];for(w[t]=128,w[(t=256-128*(t<112?1:0))-9]=0,p5(w,t-8,n/536870912|0,n<<3),Z5(f,i,w,t),r=0;r<8;r++)p5(o,8*r,f[r],i[r]);return 0}function g5(o,a){var t=v(),r=v(),f=v(),i=v(),w=v(),n=v(),M=v(),A=v(),c=v();t5(t,o[1],o[0]),t5(c,a[1],a[0]),F(t,t,c),r5(r,o[0],o[1]),r5(c,a[0],a[1]),F(r,r,c),F(f,o[3],a[3]),F(f,f,H5),F(i,o[2],a[2]),r5(i,i,i),t5(w,r,t),t5(n,i,f),r5(M,i,f),r5(A,r,t),F(o[0],w,n),F(o[1],A,M),F(o[2],M,n),F(o[3],w,A)}function I5(o,a,t){var r;for(r=0;r<4;r++)i5(o[r],a[r],t)}function U5(o,a){var t=v(),r=v(),f=v();B5(f,a[2]),F(t,a[0],f),F(r,a[1],f),l5(o,r),o[31]^=_5(t)<<7}function T5(o,a,t){var r,f;for(f5(o[0],M5),f5(o[1],y5),f5(o[2],y5),f5(o[3],M5),f=255;f>=0;--f)I5(o,a,r=t[f/8|0]>>(7&f)&1),g5(a,o),g5(o,o),I5(o,a,r)}function b5(o,a){var t=[v(),v(),v(),v()];f5(t[0],d5),f5(t[1],F5),f5(t[2],y5),F(t[3],d5,F5),T5(o,t,a)}function N5(o,a,t){var r,f=new Uint8Array(64),i=[v(),v(),v(),v()];for(t||A5(a,32),u5(f,a,32),f[0]&=248,f[31]&=127,f[31]|=64,b5(i,f),U5(o,i),r=0;r<32;r++)a[r+32]=o[r];return 0}var v5=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function q5(o,a){var t,r,f,i;for(r=63;r>=32;--r){for(t=0,f=r-32,i=r-12;f<i;++f)a[f]+=t-16*a[r]*v5[f-(r-32)],t=Math.floor((a[f]+128)/256),a[f]-=256*t;a[f]+=t,a[r]=0}for(t=0,f=0;f<32;f++)a[f]+=t-(a[31]>>4)*v5[f],t=a[f]>>8,a[f]&=255;for(f=0;f<32;f++)a[f]-=t*v5[f];for(r=0;r<32;r++)a[r+1]+=a[r]>>8,o[r]=255&a[r]}function s5(o){var a,t=new Float64Array(64);for(a=0;a<64;a++)t[a]=o[a];for(a=0;a<64;a++)o[a]=0;q5(o,t)}function Q5(o,a){var t=v(),r=v(),f=v(),i=v(),w=v(),n=v(),M=v();return f5(o[2],y5),$5(o[1],a),k(f,o[1]),F(i,f,D5),t5(f,f,o[2]),r5(i,o[2],i),k(w,i),k(n,w),F(M,n,w),F(t,M,f),F(t,t,i),(function(A,c){var g,b=v();for(g=0;g<16;g++)b[g]=c[g];for(g=250;g>=0;g--)k(b,b),g!==1&&F(b,b,c);for(g=0;g<16;g++)A[g]=b[g]})(t,t),F(t,t,f),F(t,t,i),F(t,t,i),F(o[0],t,i),k(r,o[0]),F(r,r,i),R5(r,f)&&F(o[0],o[0],O5),k(r,o[0]),F(r,r,i),R5(r,f)?-1:(_5(o[0])===a[31]>>7&&t5(o[0],M5,o[0]),F(o[3],o[0],o[1]),0)}var a5=64;function n5(){for(var o=0;o<arguments.length;o++)if(!(arguments[o]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}m.scalarMult=function(o,a){if(n5(o,a),o.length!==32)throw Error("bad n size");if(a.length!==32)throw Error("bad p size");var t=new Uint8Array(32);return J5(t,o,a),t},m.box={},m.box.keyPair=function(){var o,a,t=new Uint8Array(32),r=new Uint8Array(32);return o=t,A5(a=r,32),V5(o,a),{publicKey:t,secretKey:r}},m.box.keyPair.fromSecretKey=function(o){if(n5(o),o.length!==32)throw Error("bad secret key size");var a=new Uint8Array(32);return V5(a,o),{publicKey:a,secretKey:new Uint8Array(o)}},m.sign=function(o,a){if(n5(o,a),a.length!==64)throw Error("bad secret key size");var t=new Uint8Array(a5+o.length);return(function(r,f,i,w){var n,M,A=new Uint8Array(64),c=new Uint8Array(64),g=new Uint8Array(64),b=new Float64Array(64),p=[v(),v(),v(),v()];for(u5(A,w,32),A[0]&=248,A[31]&=127,A[31]|=64,n=0;n<i;n++)r[64+n]=f[n];for(n=0;n<32;n++)r[32+n]=A[32+n];for(u5(g,r.subarray(32),i+32),s5(g),b5(p,g),U5(r,p),n=32;n<64;n++)r[n]=w[n];for(u5(c,r,i+64),s5(c),n=0;n<64;n++)b[n]=0;for(n=0;n<32;n++)b[n]=g[n];for(n=0;n<32;n++)for(M=0;M<32;M++)b[n+M]+=c[n]*A[M];q5(r.subarray(32),b)})(t,o,o.length,a),t},m.sign.detached=function(o,a){for(var t=m.sign(o,a),r=new Uint8Array(a5),f=0;f<r.length;f++)r[f]=t[f];return r},m.sign.detached.verify=function(o,a,t){if(n5(o,a,t),a.length!==a5)throw Error("bad signature size");if(t.length!==32)throw Error("bad public key size");var r,f=new Uint8Array(a5+o.length),i=new Uint8Array(a5+o.length);for(r=0;r<a5;r++)f[r]=a[r];for(r=0;r<o.length;r++)f[r+a5]=o[r];return(function(w,n,M,A){var c,g=new Uint8Array(32),b=new Uint8Array(64),p=[v(),v(),v(),v()],I=[v(),v(),v(),v()];if(M<64||Q5(I,A))return-1;for(c=0;c<M;c++)w[c]=n[c];for(c=0;c<32;c++)w[c+32]=A[c];if(u5(b,w,M),s5(b),T5(p,I,b),b5(I,n.subarray(32)),g5(p,I),U5(g,p),M-=64,X5(n,0,g,0)){for(c=0;c<M;c++)w[c]=0;return-1}for(c=0;c<M;c++)w[c]=n[c+64];return M})(i,f,f.length,t)>=0},m.sign.keyPair=function(){var o=new Uint8Array(32),a=new Uint8Array(64);return N5(o,a),{publicKey:o,secretKey:a}},m.sign.keyPair.fromSecretKey=function(o){if(n5(o),o.length!==64)throw Error("bad secret key size");for(var a=new Uint8Array(32),t=0;t<a.length;t++)a[t]=o[32+t];return{publicKey:a,secretKey:new Uint8Array(o)}},m.sign.keyPair.fromSeed=function(o){if(n5(o),o.length!==32)throw Error("bad seed size");for(var a=new Uint8Array(32),t=new Uint8Array(64),r=0;r<32;r++)t[r]=o[r];return N5(a,t,!0),{publicKey:a,secretKey:t}},m.setPRNG=function(o){A5=o},(function(){h5&&h5.getRandomValues&&m.setPRNG((function(o,a){var t,r=new Uint8Array(a);for(t=0;t<a;t+=65536)h5.getRandomValues(r.subarray(t,t+Math.min(a-t,65536)));for(t=0;t<a;t++)o[t]=r[t];(function(f){for(var i=0;i<f.length;i++)f[i]=0})(r)}))})();export{m as default};
