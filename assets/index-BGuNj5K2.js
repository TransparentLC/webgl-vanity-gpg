const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./noble_curves.min-CVhER5Zk.js","./sha3.min-Dxc9pZ0t.js","./noble_hashes.min-DhilNtsz.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var xo=Object.defineProperty,Bo=(n,e,r)=>e in n?xo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,It=(n,e,r)=>(Bo(n,typeof e!="symbol"?e+"":e,r),r);function To(n,e){const r=Object.create(null),t=n.split(",");for(let i=0;i<t.length;i++)r[t[i]]=!0;return i=>!!r[i]}function Ys(n){if(ye(n)){const e={};for(let r=0;r<n.length;r++){const t=n[r],i=tr(t)?Ro(t):Ys(t);if(i)for(const s in i)e[s]=i[s]}return e}else if(tr(n)||Kt(n))return n}const Lo=/;(?![^(]*\))/g,Mo=/:(.+)/;function Ro(n){const e={};return n.split(Lo).forEach(r=>{if(r){const t=r.split(Mo);t.length>1&&(e[t[0].trim()]=t[1].trim())}}),e}function Js(n){let e="";if(tr(n))e=n;else if(ye(n))for(let r=0;r<n.length;r++){const t=Js(n[r]);t&&(e+=t+" ")}else if(Kt(n))for(const r in n)n[r]&&(e+=r+" ");return e.trim()}function Fo(n,e){if(n.length!==e.length)return!1;let r=!0;for(let t=0;r&&t<n.length;t++)r=Xt(n[t],e[t]);return r}function Xt(n,e){if(n===e)return!0;let r=Fi(n),t=Fi(e);if(r||t)return r&&t?n.getTime()===e.getTime():!1;if(r=ye(n),t=ye(e),r||t)return r&&t?Fo(n,e):!1;if(r=Kt(n),t=Kt(e),r||t){if(!r||!t)return!1;const i=Object.keys(n).length,s=Object.keys(e).length;if(i!==s)return!1;for(const a in n){const o=n.hasOwnProperty(a),u=e.hasOwnProperty(a);if(o&&!u||!o&&u||!Xt(n[a],e[a]))return!1}}return String(n)===String(e)}function Sn(n,e){return n.findIndex(r=>Xt(r,e))}const No=Object.assign,Oo=(n,e)=>{const r=n.indexOf(e);r>-1&&n.splice(r,1)},Ho=Object.prototype.hasOwnProperty,mi=(n,e)=>Ho.call(n,e),ye=Array.isArray,En=n=>ea(n)==="[object Map]",Fi=n=>n instanceof Date,tr=n=>typeof n=="string",wi=n=>typeof n=="symbol",Kt=n=>n!==null&&typeof n=="object",$o=Object.prototype.toString,ea=n=>$o.call(n),zo=n=>ea(n).slice(8,-1),bi=n=>tr(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,ta=n=>{const e=Object.create(null);return r=>e[r]||(e[r]=n(r))},_o=/-(\w)/g,jo=ta(n=>n.replace(_o,(e,r)=>r?r.toUpperCase():"")),qo=/\B([A-Z])/g,ra=ta(n=>n.replace(qo,"-$1").toLowerCase()),Go=(n,e)=>!Object.is(n,e),Ni=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let Wo;function na(n,e){e=e||Wo,e&&e.active&&e.effects.push(n)}const ia=n=>{const e=new Set(n);return e.w=0,e.n=0,e},sa=n=>(n.w&Ut)>0,aa=n=>(n.n&Ut)>0,Vo=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=Ut},Qo=n=>{const{deps:e}=n;if(e.length){let r=0;for(let t=0;t<e.length;t++){const i=e[t];sa(i)&&!aa(i)?i.delete(n):e[r++]=i,i.w&=~Ut,i.n&=~Ut}e.length=r}},_n=new WeakMap;let pr=0,Ut=1;const jn=30,or=[];let Rt;const Nr=Symbol(""),Oi=Symbol("");let Zo=class{constructor(e,r=null,t){this.fn=e,this.scheduler=r,this.active=!0,this.deps=[],na(this,t)}run(){if(!this.active)return this.fn();if(!or.includes(this))try{return or.push(Rt=this),ec(),Ut=1<<++pr,pr<=jn?Vo(this):Hi(this),this.fn()}finally{pr<=jn&&Qo(this),Ut=1<<--pr,oa(),or.pop();const e=or.length;Rt=e>0?or[e-1]:void 0}}stop(){this.active&&(Hi(this),this.onStop&&this.onStop(),this.active=!1)}};function Hi(n){const{deps:e}=n;if(e.length){for(let r=0;r<e.length;r++)e[r].delete(n);e.length=0}}function Xo(n,e){n.effect&&(n=n.effect.fn);const r=new Zo(n);e&&(No(r,e),e.scope&&na(r,e.scope)),(!e||!e.lazy)&&r.run();const t=r.run.bind(r);return t.effect=r,t}function Yo(n){n.effect.stop()}let rr=!0;const ki=[];function Jo(){ki.push(rr),rr=!1}function ec(){ki.push(rr),rr=!0}function oa(){const n=ki.pop();rr=n===void 0?!0:n}function un(n,e,r){if(!tc())return;let t=_n.get(n);t||_n.set(n,t=new Map);let i=t.get(r);i||t.set(r,i=ia()),rc(i)}function tc(){return rr&&Rt!==void 0}function rc(n,e){let r=!1;pr<=jn?aa(n)||(n.n|=Ut,r=!sa(n)):r=!n.has(Rt),r&&(n.add(Rt),Rt.deps.push(n))}function qn(n,e,r,t,i,s){const a=_n.get(n);if(!a)return;let o=[];if(e==="clear")o=[...a.values()];else if(r==="length"&&ye(n))a.forEach((u,l)=>{(l==="length"||l>=t)&&o.push(u)});else switch(r!==void 0&&o.push(a.get(r)),e){case"add":ye(n)?bi(r)&&o.push(a.get("length")):(o.push(a.get(Nr)),En(n)&&o.push(a.get(Oi)));break;case"delete":ye(n)||(o.push(a.get(Nr)),En(n)&&o.push(a.get(Oi)));break;case"set":En(n)&&o.push(a.get(Nr));break}if(o.length===1)o[0]&&$i(o[0]);else{const u=[];for(const l of o)l&&u.push(...l);$i(ia(u))}}function $i(n,e){for(const r of ye(n)?n:[...n])(r!==Rt||r.allowRecurse)&&(r.scheduler?r.scheduler():r.run())}const nc=To("__proto__,__v_isRef,__isVue"),ca=new Set(Object.getOwnPropertyNames(Symbol).map(n=>Symbol[n]).filter(wi)),ic=ua(),sc=ua(!0),zi=ac();function ac(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...r){const t=Ft(this);for(let s=0,a=this.length;s<a;s++)un(t,"get",s+"");const i=t[e](...r);return i===-1||i===!1?t[e](...r.map(Ft)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...r){Jo();const t=Ft(this)[e].apply(this,r);return oa(),t}}),n}function ua(n=!1,e=!1){return function(r,t,i){if(t==="__v_isReactive")return!n;if(t==="__v_isReadonly")return n;if(t==="__v_raw"&&i===(n?e?gc:ha:e?fc:la).get(r))return r;const s=ye(r);if(!n&&s&&mi(zi,t))return Reflect.get(zi,t,i);const a=Reflect.get(r,t,i);return(wi(t)?ca.has(t):nc(t))||(n||un(r,"get",t),e)?a:Gn(a)?!s||!bi(t)?a.value:a:Kt(a)?n?wc(a):ln(a):a}}const oc=cc();function cc(n=!1){return function(e,r,t,i){let s=e[r];if(!n&&!bc(t)&&(t=Ft(t),s=Ft(s),!ye(e)&&Gn(s)&&!Gn(t)))return s.value=t,!0;const a=ye(e)&&bi(r)?Number(r)<e.length:mi(e,r),o=Reflect.set(e,r,t,i);return e===Ft(i)&&(a?Go(t,s)&&qn(e,"set",r,t):qn(e,"add",r,t)),o}}function uc(n,e){const r=mi(n,e);n[e];const t=Reflect.deleteProperty(n,e);return t&&r&&qn(n,"delete",e,void 0),t}function lc(n,e){const r=Reflect.has(n,e);return(!wi(e)||!ca.has(e))&&un(n,"has",e),r}function hc(n){return un(n,"iterate",ye(n)?"length":Nr),Reflect.ownKeys(n)}const yc={get:ic,set:oc,deleteProperty:uc,has:lc,ownKeys:hc},pc={get:sc,set(n,e){return!0},deleteProperty(n,e){return!0}},la=new WeakMap,fc=new WeakMap,ha=new WeakMap,gc=new WeakMap;function dc(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function mc(n){return n.__v_skip||!Object.isExtensible(n)?0:dc(zo(n))}function ln(n){return n&&n.__v_isReadonly?n:ya(n,!1,yc,null,la)}function wc(n){return ya(n,!0,pc,null,ha)}function ya(n,e,r,t,i){if(!Kt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=i.get(n);if(s)return s;const a=mc(n);if(a===0)return n;const o=new Proxy(n,a===2?t:r);return i.set(n,o),o}function bc(n){return!!(n&&n.__v_isReadonly)}function Ft(n){const e=n&&n.__v_raw;return e?Ft(e):n}function Gn(n){return!!(n&&n.__v_isRef===!0)}Promise.resolve();let Wn=!1;const _r=[],kc=Promise.resolve(),hn=n=>kc.then(n),_i=n=>{_r.includes(n)||_r.push(n),Wn||(Wn=!0,hn(vc))},vc=()=>{for(const n of _r)n();_r.length=0,Wn=!1},Ac=/^(spellcheck|draggable|form|list|type)$/,Vn=({el:n,get:e,effect:r,arg:t,modifiers:i})=>{let s;t==="class"&&(n._class=n.className),r(()=>{let a=e();if(t)i?.camel&&(t=jo(t)),Pn(n,t,a,s);else{for(const o in a)Pn(n,o,a[o],s&&s[o]);for(const o in s)(!a||!(o in a))&&Pn(n,o,null)}s=a})},Pn=(n,e,r,t)=>{if(e==="class")n.setAttribute("class",Js(n._class?[n._class,r]:r)||"");else if(e==="style"){r=Ys(r);const{style:i}=n;if(!r)n.removeAttribute("style");else if(tr(r))r!==t&&(i.cssText=r);else{for(const s in r)Qn(i,s,r[s]);if(t&&!tr(t))for(const s in t)r[s]==null&&Qn(i,s,"")}}else!(n instanceof SVGElement)&&e in n&&!Ac.test(e)?(n[e]=r,e==="value"&&(n._value=r)):e==="true-value"?n._trueValue=r:e==="false-value"?n._falseValue=r:r!=null?n.setAttribute(e,r):n.removeAttribute(e)},ji=/\s*!important$/,Qn=(n,e,r)=>{ye(r)?r.forEach(t=>Qn(n,e,t)):e.startsWith("--")?n.setProperty(e,r):ji.test(r)?n.setProperty(ra(e),r.replace(ji,""),"important"):n[e]=r},bt=(n,e)=>{const r=n.getAttribute(e);return r!=null&&n.removeAttribute(e),r},wt=(n,e,r,t)=>{n.addEventListener(e,r,t)},Sc=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,Ec=["ctrl","shift","alt","meta"],Pc={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>Ec.some(r=>n[`${r}Key`]&&!e[r])},pa=({el:n,get:e,exp:r,arg:t,modifiers:i})=>{if(!t)return;let s=Sc.test(r)?e(`(e => ${r}(e))`):e(`($event => { ${r} })`);if(t==="vue:mounted"){hn(s);return}else if(t==="vue:unmounted")return()=>s();if(i){t==="click"&&(i.right&&(t="contextmenu"),i.middle&&(t="mouseup"));const a=s;s=o=>{if(!("key"in o&&!(ra(o.key)in i))){for(const u in i){const l=Pc[u];if(l&&l(o,i))return}return a(o)}}}wt(n,t,s,i)},Kc=({el:n,get:e,effect:r})=>{const t=n.style.display;r(()=>{n.style.display=e()?t:"none"})},fa=({el:n,get:e,effect:r})=>{r(()=>{n.textContent=ga(e())})},ga=n=>n==null?"":Kt(n)?JSON.stringify(n,null,2):String(n),Uc=({el:n,get:e,effect:r})=>{r(()=>{n.innerHTML=e()})},Ic=({el:n,exp:e,get:r,effect:t,modifiers:i})=>{const s=n.type,a=r(`(val) => { ${e} = val }`),{trim:o,number:u=s==="number"}=i||{};if(n.tagName==="SELECT"){const l=n;wt(n,"change",()=>{const h=Array.prototype.filter.call(l.options,p=>p.selected).map(p=>u?Ni(gt(p)):gt(p));a(l.multiple?h:h[0])}),t(()=>{const h=r(),p=l.multiple;for(let f=0,g=l.options.length;f<g;f++){const d=l.options[f],m=gt(d);if(p)ye(h)?d.selected=Sn(h,m)>-1:d.selected=h.has(m);else if(Xt(gt(d),h)){l.selectedIndex!==f&&(l.selectedIndex=f);return}}!p&&l.selectedIndex!==-1&&(l.selectedIndex=-1)})}else if(s==="checkbox"){wt(n,"change",()=>{const h=r(),p=n.checked;if(ye(h)){const f=gt(n),g=Sn(h,f),d=g!==-1;if(p&&!d)a(h.concat(f));else if(!p&&d){const m=[...h];m.splice(g,1),a(m)}}else a(qi(n,p))});let l;t(()=>{const h=r();ye(h)?n.checked=Sn(h,gt(n))>-1:h!==l&&(n.checked=Xt(h,qi(n,!0))),l=h})}else if(s==="radio"){wt(n,"change",()=>{a(gt(n))});let l;t(()=>{const h=r();h!==l&&(n.checked=Xt(h,gt(n)))})}else{const l=h=>o?h.trim():u?Ni(h):h;wt(n,"compositionstart",Dc),wt(n,"compositionend",Cc),wt(n,i?.lazy?"change":"input",()=>{n.composing||a(l(n.value))}),o&&wt(n,"change",()=>{n.value=n.value.trim()}),t(()=>{if(n.composing)return;const h=n.value,p=r();document.activeElement===n&&l(h)===p||h!==p&&(n.value=p)})}},gt=n=>"_value"in n?n._value:n.value,qi=(n,e)=>{const r=e?"_trueValue":"_falseValue";return r in n?n[r]:e},Dc=n=>{n.target.composing=!0},Cc=n=>{const e=n.target;e.composing&&(e.composing=!1,xc(e,"input"))},xc=(n,e)=>{const r=document.createEvent("HTMLEvents");r.initEvent(e,!0,!0),n.dispatchEvent(r)},Gi=Object.create(null),Sr=(n,e,r)=>da(n,`return(${e})`,r),da=(n,e,r)=>{const t=Gi[e]||(Gi[e]=Bc(e));try{return t(n,r)}catch(i){console.error(i)}},Bc=n=>{try{return new Function("$data","$el",`with($data){${n}}`)}catch(e){return console.error(`${e.message} in expression: ${n}`),()=>{}}},Tc=({el:n,ctx:e,exp:r,effect:t})=>{hn(()=>t(()=>da(e.scope,r,n)))},Lc={bind:Vn,on:pa,show:Kc,text:fa,html:Uc,model:Ic,effect:Tc},Mc=(n,e,r)=>{const t=n.parentElement,i=new Comment("v-if");t.insertBefore(i,n);const s=[{exp:e,el:n}];let a,o;for(;(a=n.nextElementSibling)&&(o=null,bt(a,"v-else")===""||(o=bt(a,"v-else-if")));)t.removeChild(a),s.push({exp:o,el:a});const u=n.nextSibling;t.removeChild(n);let l,h=-1;const p=()=>{l&&(t.insertBefore(i,l.el),l.remove(),l=void 0)};return r.effect(()=>{for(let f=0;f<s.length;f++){const{exp:g,el:d}=s[f];if(!g||Sr(r.scope,g)){f!==h&&(p(),l=new vi(d,r),l.insert(t,i),t.removeChild(i),h=f);return}}h=-1,p()}),u},Rc=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,Wi=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,Fc=/^\(|\)$/g,Nc=/^[{[]\s*((?:[\w_$]+\s*,?\s*)+)[\]}]$/,Oc=(n,e,r)=>{const t=e.match(Rc);if(!t)return;const i=n.nextSibling,s=n.parentElement,a=new Text("");s.insertBefore(a,n),s.removeChild(n);const o=t[2].trim();let u=t[1].trim().replace(Fc,"").trim(),l,h=!1,p,f,g="key",d=n.getAttribute(g)||n.getAttribute(g=":key")||n.getAttribute(g="v-bind:key");d&&(n.removeAttribute(g),g==="key"&&(d=JSON.stringify(d)));let m;(m=u.match(Wi))&&(u=u.replace(Wi,"").trim(),p=m[1].trim(),m[2]&&(f=m[2].trim())),(m=u.match(Nc))&&(l=m[1].split(",").map(I=>I.trim()),h=u[0]==="[");let b=!1,w,v,E;const A=I=>{const k=new Map,S=[];if(ye(I))for(let D=0;D<I.length;D++)S.push(U(k,I[D],D));else if(typeof I=="number")for(let D=0;D<I;D++)S.push(U(k,D+1,D));else if(Kt(I)){let D=0;for(const P in I)S.push(U(k,I[P],D++,P))}return[S,k]},U=(I,k,S,D)=>{const P={};l?l.forEach((G,V)=>P[G]=k[h?V:G]):P[u]=k,D?(p&&(P[p]=D),f&&(P[f]=S)):p&&(P[p]=S);const K=ka(r,P),x=d?Sr(K.scope,d):S;return I.set(x,S),K.key=x,K},C=(I,k)=>{const S=new vi(n,I);return S.key=I.key,S.insert(s,k),S};return r.effect(()=>{const I=Sr(r.scope,o),k=E;if([v,E]=A(I),!b)w=v.map(S=>C(S,a)),b=!0;else{for(let x=0;x<w.length;x++)E.has(w[x].key)||w[x].remove();const S=[];let D=v.length,P,K;for(;D--;){const x=v[D],G=k.get(x.key);let V;G==null?V=C(x,P?P.el:a):(V=w[G],Object.assign(V.ctx.scope,x.scope),G!==D&&(w[G+1]!==P||K===P)&&(K=V,V.insert(s,P?P.el:a))),S.unshift(P=V)}w=S}}),i},ma=({el:n,ctx:{scope:{$refs:e}},get:r,effect:t})=>{let i;return t(()=>{const s=r();e[s]=n,i&&s!==i&&delete e[i],i=s}),()=>{i&&delete e[i]}},Hc=/^(?:v-|:|@)/,$c=/\.([\w-]+)/g;let Zn=!1;const wa=(n,e)=>{const r=n.nodeType;if(r===1){const t=n;if(t.hasAttribute("v-pre"))return;bt(t,"v-cloak");let i;if(i=bt(t,"v-if"))return Mc(t,i,e);if(i=bt(t,"v-for"))return Oc(t,i,e);if((i=bt(t,"v-scope"))||i===""){const o=i?Sr(e.scope,i):{};e=ka(e,o),o.$template&&zc(t,o.$template)}const s=bt(t,"v-once")!=null;s&&(Zn=!0),(i=bt(t,"ref"))&&Xn(t,ma,`"${i}"`,e),Vi(t,e);const a=[];for(const{name:o,value:u}of[...t.attributes])Hc.test(o)&&o!=="v-cloak"&&(o==="v-model"?a.unshift([o,u]):o[0]==="@"||/^v-on\b/.test(o)?a.push([o,u]):Qi(t,o,u,e));for(const[o,u]of a)Qi(t,o,u,e);s&&(Zn=!1)}else if(r===3){const t=n.data;if(t.includes(e.delimiters[0])){let i=[],s=0,a;for(;a=e.delimitersRE.exec(t);){const o=t.slice(s,a.index);o&&i.push(JSON.stringify(o)),i.push(`$s(${a[1]})`),s=a.index+a[0].length}s<t.length&&i.push(JSON.stringify(t.slice(s))),Xn(n,fa,i.join("+"),e)}}else r===11&&Vi(n,e)},Vi=(n,e)=>{let r=n.firstChild;for(;r;)r=wa(r,e)||r.nextSibling},Qi=(n,e,r,t)=>{let i,s,a;if(e=e.replace($c,(o,u)=>((a||(a={}))[u]=!0,"")),e[0]===":")i=Vn,s=e.slice(1);else if(e[0]==="@")i=pa,s=e.slice(1);else{const o=e.indexOf(":"),u=o>0?e.slice(2,o):e.slice(2);i=Lc[u]||t.dirs[u],s=o>0?e.slice(o+1):void 0}i&&(i===Vn&&s==="ref"&&(i=ma),Xn(n,i,r,t,s,a),n.removeAttribute(e))},Xn=(n,e,r,t,i,s)=>{const a=e({el:n,get:(o=r)=>Sr(t.scope,o,n),effect:t.effect,ctx:t,exp:r,arg:i,modifiers:s});a&&t.cleanups.push(a)},zc=(n,e)=>{if(e[0]==="#"){const r=document.querySelector(e);n.appendChild(r.content.cloneNode(!0));return}n.innerHTML=e},ba=n=>{const e={delimiters:["{{","}}"],delimitersRE:/\{\{([^]+?)\}\}/g,...n,scope:n?n.scope:ln({}),dirs:n?n.dirs:{},effects:[],blocks:[],cleanups:[],effect:r=>{if(Zn)return _i(r),r;const t=Xo(r,{scheduler:()=>_i(t)});return e.effects.push(t),t}};return e},ka=(n,e={})=>{const r=n.scope,t=Object.create(r);Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)),t.$refs=Object.create(r.$refs);const i=ln(new Proxy(t,{set(s,a,o,u){return u===i&&!s.hasOwnProperty(a)?Reflect.set(r,a,o):Reflect.set(s,a,o,u)}}));return va(i),{...n,scope:i}},va=n=>{for(const e of Object.keys(n))typeof n[e]=="function"&&(n[e]=n[e].bind(n))};let vi=class{constructor(e,r,t=!1){It(this,"template"),It(this,"ctx"),It(this,"key"),It(this,"parentCtx"),It(this,"isFragment"),It(this,"start"),It(this,"end"),this.isFragment=e instanceof HTMLTemplateElement,t?this.template=e:this.isFragment?this.template=e.content.cloneNode(!0):this.template=e.cloneNode(!0),t?this.ctx=r:(this.parentCtx=r,r.blocks.push(this),this.ctx=ba(r)),wa(this.template,this.ctx)}get el(){return this.start||this.template}insert(e,r=null){if(this.isFragment)if(this.start){let t=this.start,i;for(;t&&(i=t.nextSibling,e.insertBefore(t,r),t!==this.end);)t=i}else this.start=new Text(""),this.end=new Text(""),e.insertBefore(this.end,r),e.insertBefore(this.start,this.end),e.insertBefore(this.template,this.end);else e.insertBefore(this.template,r)}remove(){if(this.parentCtx&&Oo(this.parentCtx.blocks,this),this.start){const e=this.start.parentNode;let r=this.start,t;for(;r&&(t=r.nextSibling,e.removeChild(r),r!==this.end);)r=t}else this.template.parentNode.removeChild(this.template);this.teardown()}teardown(){this.ctx.blocks.forEach(e=>{e.teardown()}),this.ctx.effects.forEach(Yo),this.ctx.cleanups.forEach(e=>e())}};const Zi=n=>n.replace(/[-.*+?^${}()|[\]\/\\]/g,"\\$&"),Aa=n=>{const e=ba();if(n&&(e.scope=ln(n),va(e.scope),n.$delimiters)){const[t,i]=e.delimiters=n.$delimiters;e.delimitersRE=new RegExp(Zi(t)+"([^]+?)"+Zi(i),"g")}e.scope.$s=ga,e.scope.$nextTick=hn,e.scope.$refs=Object.create(null);let r;return{directive(t,i){return i?(e.dirs[t]=i,this):e.dirs[t]},mount(t){if(typeof t=="string"&&(t=document.querySelector(t),!t))return;t=t||document.documentElement;let i;return t.hasAttribute("v-scope")?i=[t]:i=[...t.querySelectorAll("[v-scope]")].filter(s=>!s.matches("[v-scope] [v-scope]")),i.length||(i=[t]),r=i.map(s=>new vi(s,e,!0)),this},unmount(){r.forEach(t=>t.teardown())}}},Xi=document.currentScript;Xi&&Xi.hasAttribute("init")&&Aa().mount();const _c="modulepreload",jc=function(n,e){return new URL(n,e).href},Yi={},yn=function(e,r,t){let i=Promise.resolve();if(r&&r.length>0){const a=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),u=o?.nonce||o?.getAttribute("nonce");i=Promise.allSettled(r.map(l=>{if(l=jc(l,t),l in Yi)return;Yi[l]=!0;const h=l.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(!!t)for(let d=a.length-1;d>=0;d--){const m=a[d];if(m.href===l&&(!h||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${p}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":_c,h||(g.as="script"),g.crossOrigin="",g.href=l,u&&g.setAttribute("nonce",u),document.head.appendChild(g),h)return new Promise((d,m)=>{g.addEventListener("load",d),g.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})},Re=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wt=Symbol("doneWritingPromise"),Sa=Symbol("doneWritingResolve"),Ea=Symbol("doneWritingReject"),cr=Symbol("readingIndex");class Fe extends Array{constructor(){super(),Object.setPrototypeOf(this,Fe.prototype),this[Wt]=new Promise((e,r)=>{this[Sa]=e,this[Ea]=r}),this[Wt].catch(()=>{})}}function Se(n){return n&&n.getReader&&Array.isArray(n)}function fr(n){if(!Se(n)){const e=n.getWriter(),r=e.releaseLock;return e.releaseLock=()=>{e.closed.catch(function(){}),r.call(e)},e}this.stream=n}function De(n){if(Se(n))return"array";if(Re.ReadableStream&&Re.ReadableStream.prototype.isPrototypeOf(n))return"web";if(n&&!(Re.ReadableStream&&n instanceof Re.ReadableStream)&&typeof n._read=="function"&&typeof n._readableState=="object")throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!n||!n.getReader)&&"web-like"}function pn(n){return Uint8Array.prototype.isPrototypeOf(n)}function Pa(n){if(n.length===1)return n[0];let e=0;for(let i=0;i<n.length;i++){if(!pn(n[i]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");e+=n[i].length}const r=new Uint8Array(e);let t=0;return n.forEach(function(i){r.set(i,t),t+=i.length}),r}Fe.prototype.getReader=function(){return this[cr]===void 0&&(this[cr]=0),{read:async()=>(await this[Wt],this[cr]===this.length?{value:void 0,done:!0}:{value:this[this[cr]++],done:!1})}},Fe.prototype.readToEnd=async function(n){await this[Wt];const e=n(this.slice(this[cr]));return this.length=0,e},Fe.prototype.clone=function(){const n=new Fe;return n[Wt]=this[Wt].then(()=>{n.push(...this)}),n},fr.prototype.write=async function(n){this.stream.push(n)},fr.prototype.close=async function(){this.stream[Sa]()},fr.prototype.abort=async function(n){return this.stream[Ea](n),n},fr.prototype.releaseLock=function(){},typeof Re.process=="object"&&Re.process.versions;const Ji=new WeakSet,j=Symbol("externalBuffer");function qe(n){if(this.stream=n,n[j]&&(this[j]=n[j].slice()),Se(n)){const r=n.getReader();return this._read=r.read.bind(r),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(De(n)){const r=n.getReader();return this._read=r.read.bind(r),this._releaseLock=()=>{r.closed.catch(function(){}),r.releaseLock()},void(this._cancel=r.cancel.bind(r))}let e=!1;this._read=async()=>e||Ji.has(n)?{value:void 0,done:!0}:(e=!0,{value:n,done:!1}),this._releaseLock=()=>{if(e)try{Ji.add(n)}catch{}}}function Ai(n){return De(n)?n:new ReadableStream({start(e){e.enqueue(n),e.close()}})}function Ka(n){if(De(n))return n;const e=new Fe;return(async()=>{const r=tt(e);await r.write(n),await r.close()})(),e}function Me(n){return n.some(e=>De(e)&&!Se(e))?function(e){e=e.map(Ai);const r=Ia(async function(s){await Promise.all(i.map(a=>Gc(a,s)))});let t=Promise.resolve();const i=e.map((s,a)=>fn(s,(o,u)=>(t=t.then(()=>jr(o,r.writable,{preventClose:a!==e.length-1})),t)));return r.readable}(n):n.some(e=>Se(e))?function(e){const r=new Fe;let t=Promise.resolve();return e.forEach((i,s)=>(t=t.then(()=>jr(i,r,{preventClose:s!==e.length-1})),t)),r}(n):typeof n[0]=="string"?n.join(""):Pa(n)}async function jr(n,e,{preventClose:r=!1,preventAbort:t=!1,preventCancel:i=!1}={}){if(De(n)&&!Se(n)){n=Ai(n);try{if(n[j]){const o=tt(e);for(let u=0;u<n[j].length;u++)await o.ready,await o.write(n[j][u]);o.releaseLock()}await n.pipeTo(e,{preventClose:r,preventAbort:t,preventCancel:i})}catch{}return}const s=ar(n=Ka(n)),a=tt(e);try{for(;;){await a.ready;const{done:o,value:u}=await s.read();if(o){r||await a.close();break}await a.write(u)}}catch(o){t||await a.abort(o)}finally{s.releaseLock(),a.releaseLock()}}function Ua(n,e){const r=new TransformStream(e);return jr(n,r.writable),r.readable}function Ia(n){let e,r,t,i=!1,s=!1;return{readable:new ReadableStream({start(a){t=a},pull(){e?e():i=!0},async cancel(a){s=!0,n&&await n(a),r&&r(a)}},{highWaterMark:0}),writable:new WritableStream({write:async function(a){if(s)throw Error("Stream is cancelled");t.enqueue(a),i?i=!1:(await new Promise((o,u)=>{e=o,r=u}),e=null,r=null)},close:t.close.bind(t),abort:t.error.bind(t)})}}function ne(n,e=()=>{},r=()=>{}){if(Se(n)){const s=new Fe;return(async()=>{const a=tt(s);try{const o=await nr(n),u=e(o),l=r();let h;h=u!==void 0&&l!==void 0?Me([u,l]):u!==void 0?u:l,await a.write(h),await a.close()}catch(o){await a.abort(o)}})(),s}if(De(n))return Ua(n,{async transform(s,a){try{const o=await e(s);o!==void 0&&a.enqueue(o)}catch(o){a.error(o)}},async flush(s){try{const a=await r();a!==void 0&&s.enqueue(a)}catch(a){s.error(a)}}});const t=e(n),i=r();return t!==void 0&&i!==void 0?Me([t,i]):t!==void 0?t:i}function fn(n,e){if(De(n)&&!Se(n)){let t;const i=new TransformStream({start(o){t=o}}),s=jr(n,i.writable),a=Ia(async function(o){t.error(o),await s,await new Promise(setTimeout)});return e(i.readable,a.writable),a.readable}n=Ka(n);const r=new Fe;return e(n,r),r}function qr(n){if(Se(n))return n.clone();if(De(n)){const e=function(r){if(Se(r))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(De(r)){const t=Ai(r).tee();return t[0][j]=t[1][j]=r[j],t}return[xe(r),xe(r)]}(n);return Da(n,e[0]),e[1]}return xe(n)}function qc(n){return Se(n)?qr(n):De(n)?new ReadableStream({start(e){const r=fn(n,async(t,i)=>{const s=ar(t),a=tt(i);try{for(;;){await a.ready;const{done:o,value:u}=await s.read();if(o){try{e.close()}catch{}return void await a.close()}try{e.enqueue(u)}catch{}await a.write(u)}}catch(o){e.error(o),await a.abort(o)}});Da(n,r)}}):xe(n)}function Da(n,e){Object.entries(Object.getOwnPropertyDescriptors(n.constructor.prototype)).forEach(([r,t])=>{r!=="constructor"&&(t.value?t.value=t.value.bind(e):t.get=t.get.bind(e),Object.defineProperty(n,r,t))})}function xe(n,e=0,r=1/0){if(Se(n))throw Error("Not implemented");if(De(n)){if(e>=0&&r>=0){let t=0;return Ua(n,{transform(i,s){t<r?(t+i.length>=e&&s.enqueue(xe(i,Math.max(e-t,0),r-t)),t+=i.length):s.terminate()}})}if(e<0&&(r<0||r===1/0)){let t=[];return ne(n,i=>{i.length>=-e?t=[i]:t.push(i)},()=>xe(Me(t),e,r))}if(e===0&&r<0){let t;return ne(n,i=>{const s=t?Me([t,i]):i;if(s.length>=-r)return t=xe(s,r),xe(s,e,r);t=s})}return console.warn(`stream.slice(input, ${e}, ${r}) not implemented efficiently.`),Si(async()=>xe(await nr(n),e,r))}return n[j]&&(n=Me(n[j].concat([n]))),pn(n)?n.subarray(e,r===1/0?n.length:r):n.slice(e,r)}async function nr(n,e=Me){return Se(n)?n.readToEnd(e):De(n)?ar(n).readToEnd(e):n}async function Gc(n,e){if(De(n)){if(n.cancel){const r=await n.cancel(e);return await new Promise(setTimeout),r}if(n.destroy)return n.destroy(e),await new Promise(setTimeout),e}}function Si(n){const e=new Fe;return(async()=>{const r=tt(e);try{await r.write(await n()),await r.close()}catch(t){await r.abort(t)}})(),e}function ar(n){return new qe(n)}function tt(n){return new fr(n)}qe.prototype.read=async function(){return this[j]&&this[j].length?{done:!1,value:this[j].shift()}:this._read()},qe.prototype.releaseLock=function(){this[j]&&(this.stream[j]=this[j]),this._releaseLock()},qe.prototype.cancel=function(n){return this._cancel(n)},qe.prototype.readLine=async function(){let n,e=[];for(;!n;){let{done:r,value:t}=await this.read();if(t+="",r)return e.length?Me(e):void 0;const i=t.indexOf(`
`)+1;i&&(n=Me(e.concat(t.substr(0,i))),e=[]),i!==t.length&&e.push(t.substr(i))}return this.unshift(...e),n},qe.prototype.readByte=async function(){const{done:n,value:e}=await this.read();if(n)return;const r=e[0];return this.unshift(xe(e,1)),r},qe.prototype.readBytes=async function(n){const e=[];let r=0;for(;;){const{done:t,value:i}=await this.read();if(t)return e.length?Me(e):void 0;if(e.push(i),r+=i.length,r>=n){const s=Me(e);return this.unshift(xe(s,n)),xe(s,0,n)}}},qe.prototype.peekBytes=async function(n){const e=await this.readBytes(n);return this.unshift(e),e},qe.prototype.unshift=function(...n){this[j]||(this[j]=[]),n.length===1&&pn(n[0])&&this[j].length&&n[0].length&&this[j][0].byteOffset>=n[0].length?this[j][0]=new Uint8Array(this[j][0].buffer,this[j][0].byteOffset-n[0].length,this[j][0].byteLength+n[0].length):this[j].unshift(...n.filter(e=>e&&e.length))},qe.prototype.readToEnd=async function(n=Me){const e=[];for(;;){const{done:r,value:t}=await this.read();if(r)break;e.push(t)}return n(e)};const ur=Symbol("byValue");var c={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(n,e){if(typeof e=="number"&&(e=this.read(n,e)),n[e]!==void 0)return n[e];throw Error("Invalid enum value.")},read:function(n,e){if(n[ur]||(n[ur]=[],Object.entries(n).forEach(([r,t])=>{n[ur][t]=r})),n[ur][e]!==void 0)return n[ur][e];throw Error("Invalid enum value.")}},L={preferredHashAlgorithm:c.hash.sha512,preferredSymmetricAlgorithm:c.symmetric.aes256,preferredCompressionAlgorithm:c.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:c.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:c.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([c.symmetric.aes128,c.symmetric.aes192,c.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.0.0",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([c.hash.md5,c.hash.ripemd]),rejectMessageHashAlgorithms:new Set([c.hash.md5,c.hash.ripemd,c.hash.sha1]),rejectPublicKeyAlgorithms:new Set([c.publicKey.elgamal,c.publicKey.dsa]),rejectCurves:new Set([c.curve.secp256k1])};const es=(()=>{try{return!1}catch{}return!1})(),y={isString:function(n){return typeof n=="string"||n instanceof String},nodeRequire:()=>{},isArray:function(n){return n instanceof Array},isUint8Array:pn,isStream:De,getNobleCurve:async(n,e)=>{if(!L.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:r}=await yn(async()=>{const{nobleCurves:t}=await import("./noble_curves.min-CVhER5Zk.js");return{nobleCurves:t}},__vite__mapDeps([0,1]),import.meta.url);switch(n){case c.publicKey.ecdh:case c.publicKey.ecdsa:{const t=r.get(e);if(!t)throw Error("Unsupported curve");return t}case c.publicKey.x448:return r.get("x448");case c.publicKey.ed448:return r.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(n){let e=0;for(let r=0;r<n.length;r++)e+=256**r*n[n.length-1-r];return e},writeNumber:function(n,e){const r=new Uint8Array(e);for(let t=0;t<e;t++)r[t]=n>>8*(e-t-1)&255;return r},readDate:function(n){const e=y.readNumber(n);return new Date(1e3*e)},writeDate:function(n){const e=Math.floor(n.getTime()/1e3);return y.writeNumber(e,4)},normalizeDate:function(n=Date.now()){return n===null||n===1/0?n:new Date(1e3*Math.floor(+n/1e3))},readMPI:function(n){const e=(n[0]<<8|n[1])+7>>>3;return y.readExactSubarray(n,2,2+e)},readExactSubarray:function(n,e,r){if(n.length<r-e)throw Error("Input array too short");return n.subarray(e,r)},leftPad(n,e){if(n.length>e)throw Error("Input array too long");const r=new Uint8Array(e),t=e-n.length;return r.set(n,t),r},uint8ArrayToMPI:function(n){const e=y.uint8ArrayBitLength(n);if(e===0)throw Error("Zero MPI");const r=n.subarray(n.length-Math.ceil(e/8)),t=new Uint8Array([(65280&e)>>8,255&e]);return y.concatUint8Array([t,r])},uint8ArrayBitLength:function(n){let e;for(e=0;e<n.length&&n[e]===0;e++);if(e===n.length)return 0;const r=n.subarray(e);return 8*(r.length-1)+y.nbits(r[0])},hexToUint8Array:function(n){const e=new Uint8Array(n.length>>1);for(let r=0;r<n.length>>1;r++)e[r]=parseInt(n.substr(r<<1,2),16);return e},uint8ArrayToHex:function(n){const e="0123456789abcdef";let r="";return n.forEach(t=>{r+=e[t>>4]+e[15&t]}),r},stringToUint8Array:function(n){return ne(n,e=>{if(!y.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");const r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r})},uint8ArrayToString:function(n){const e=[],t=(n=new Uint8Array(n)).length;for(let i=0;i<t;i+=16384)e.push(String.fromCharCode.apply(String,n.subarray(i,i+16384<t?i+16384:t)));return e.join("")},encodeUTF8:function(n){const e=new TextEncoder("utf-8");function r(t,i=!1){return e.encode(t,{stream:!i})}return ne(n,r,()=>r("",!0))},decodeUTF8:function(n){const e=new TextDecoder("utf-8");function r(t,i=!1){return e.decode(t,{stream:!i})}return ne(n,r,()=>r(new Uint8Array,!0))},concat:Me,concatUint8Array:Pa,equalsUint8Array:function(n,e){if(!y.isUint8Array(n)||!y.isUint8Array(e))throw Error("Data must be in the form of a Uint8Array");if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(n[r]!==e[r])return!1;return!0},writeChecksum:function(n){let e=0;for(let r=0;r<n.length;r++)e=e+n[r]&65535;return y.writeNumber(e,2)},printDebug:function(n){es&&console.log("[OpenPGP.js debug]",n)},printDebugError:function(n){es&&console.error("[OpenPGP.js debug]",n)},nbits:function(n){let e=1,r=n>>>16;return r!==0&&(n=r,e+=16),r=n>>8,r!==0&&(n=r,e+=8),r=n>>4,r!==0&&(n=r,e+=4),r=n>>2,r!==0&&(n=r,e+=2),r=n>>1,r!==0&&(n=r,e+=1),e},double:function(n){const e=new Uint8Array(n.length),r=n.length-1;for(let t=0;t<r;t++)e[t]=n[t]<<1^n[t+1]>>7;return e[r]=n[r]<<1^135*(n[0]>>7),e},shiftRight:function(n,e){if(e)for(let r=n.length-1;r>=0;r--)n[r]>>=e,r>0&&(n[r]|=n[r-1]<<8-e);return n},getWebCrypto:function(){const n=Re!==void 0&&Re.crypto&&Re.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!n)throw Error("The WebCrypto API is not available");return n},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(n){return y.isString(n)?/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(n):!1},canonicalizeEOL:function(n){let e=!1;return ne(n,r=>{let t;e&&(r=y.concatUint8Array([new Uint8Array([13]),r])),r[r.length-1]===13?(e=!0,r=r.subarray(0,-1)):e=!1;const i=[];for(let o=0;t=r.indexOf(10,o)+1,t;o=t)r[t-2]!==13&&i.push(t);if(!i.length)return r;const s=new Uint8Array(r.length+i.length);let a=0;for(let o=0;o<i.length;o++){const u=r.subarray(i[o-1]||0,i[o]);s.set(u,a),a+=u.length,s[a-1]=13,s[a]=10,a++}return s.set(r.subarray(i[i.length-1]||0),a),s},()=>e?new Uint8Array([13]):void 0)},nativeEOL:function(n){let e=!1;return ne(n,r=>{let t;(r=e&&r[0]!==10?y.concatUint8Array([new Uint8Array([13]),r]):new Uint8Array(r))[r.length-1]===13?(e=!0,r=r.subarray(0,-1)):e=!1;let i=0;for(let s=0;s!==r.length;s=t){t=r.indexOf(13,s)+1,t||(t=r.length);const a=t-(r[t]===10?1:0);s&&r.copyWithin(i,s,a),i+=a-s}return r.subarray(0,i)},()=>e?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(n){return n.split(`
`).map(e=>{let r=e.length-1;for(;r>=0&&(e[r]===" "||e[r]==="	"||e[r]==="\r");r--);return e.substr(0,r+1)}).join(`
`)},wrapError:function(n,e){if(!e)return Error(n);try{e.message=n+": "+e.message}catch{}return e},constructAllowedPackets:function(n){const e={};return n.forEach(r=>{if(!r.tag)throw Error("Invalid input: expected a packet class");e[r.tag]=r}),e},anyPromise:function(n){return new Promise(async(e,r)=>{let t;await Promise.all(n.map(async i=>{try{e(await i)}catch(s){t=s}})),r(t)})},selectUint8Array:function(n,e,r){const t=Math.max(e.length,r.length),i=new Uint8Array(t);let s=0;for(let a=0;a<i.length;a++)i[a]=e[a]&256-n|r[a]&255+n,s+=n&a<e.length|1-n&a<r.length;return i.subarray(0,s)},selectUint8:function(n,e,r){return e&256-n|r&255+n},isAES:function(n){return n===c.symmetric.aes128||n===c.symmetric.aes192||n===c.symmetric.aes256}},Kn=y.getNodeBuffer();let Gr,Wr;function st(n){let e=new Uint8Array;return ne(n,r=>{e=y.concatUint8Array([e,r]);const t=[],i=Math.floor(e.length/45),s=45*i,a=Gr(e.subarray(0,s));for(let o=0;o<i;o++)t.push(a.substr(60*o,60)),t.push(`
`);return e=e.subarray(s),t.join("")},()=>e.length?Gr(e)+`
`:"")}function Ca(n){let e="";return ne(n,r=>{e+=r;let t=0;const i=[" ","	","\r",`
`];for(let o=0;o<i.length;o++){const u=i[o];for(let l=e.indexOf(u);l!==-1;l=e.indexOf(u,l+1))t++}let s=e.length;for(;s>0&&(s-t)%4!=0;s--)i.includes(e[s])&&t--;const a=Wr(e.substr(0,s));return e=e.substr(s),a},()=>Wr(e))}function $e(n){return Ca(n.replace(/-/g,"+").replace(/_/g,"/"))}function Ae(n,e){let r=st(n).replace(/[\r\n]/g,"");return r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),r}function Wc(n){const e=n.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!e)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(e[1])?c.armor.multipartSection:/MESSAGE, PART \d+/.test(e[1])?c.armor.multipartLast:/SIGNED MESSAGE/.test(e[1])?c.armor.signed:/MESSAGE/.test(e[1])?c.armor.message:/PUBLIC KEY BLOCK/.test(e[1])?c.armor.publicKey:/PRIVATE KEY BLOCK/.test(e[1])?c.armor.privateKey:/SIGNATURE/.test(e[1])?c.armor.signature:void 0}function Dt(n,e){let r="";return e.showVersion&&(r+="Version: "+e.versionString+`
`),e.showComment&&(r+="Comment: "+e.commentString+`
`),n&&(r+="Comment: "+n+`
`),r+=`
`,r}function Ct(n){const e=function(r){let t=13501623;return ne(r,i=>{const s=Vc?Math.floor(i.length/4):0,a=new Uint32Array(i.buffer,i.byteOffset,s);for(let o=0;o<s;o++)t^=a[o],t=he[0][t>>24&255]^he[1][t>>16&255]^he[2][t>>8&255]^he[3][255&t];for(let o=4*s;o<i.length;o++)t=t>>8^he[0][255&t^i[o]]},()=>new Uint8Array([t,t>>8,t>>16]))}(n);return st(e)}Kn?(Gr=n=>Kn.from(n).toString("base64"),Wr=n=>{const e=Kn.from(n,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}):(Gr=n=>btoa(y.uint8ArrayToString(n)),Wr=n=>y.stringToUint8Array(atob(n)));const he=[Array(255),Array(255),Array(255),Array(255)];for(let n=0;n<=255;n++){let e=n<<16;for(let r=0;r<8;r++)e=e<<1^(8388608&e?8801531:0);he[0][n]=(16711680&e)>>16|65280&e|(255&e)<<16}for(let n=0;n<=255;n++)he[1][n]=he[0][n]>>8^he[0][255&he[0][n]];for(let n=0;n<=255;n++)he[2][n]=he[1][n]>>8^he[0][255&he[1][n]];for(let n=0;n<=255;n++)he[3][n]=he[2][n]>>8^he[0][255&he[2][n]];const Vc=function(){const n=new ArrayBuffer(2);return new DataView(n).setInt16(0,255,!0),new Int16Array(n)[0]===255}();function ts(n){for(let e=0;e<n.length;e++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(n[e])||y.printDebugError(Error("Improperly formatted armor header: "+n[e])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(n[e])||y.printDebugError(Error("Unknown header: "+n[e]))}function Qc(n){let e=n;const r=n.lastIndexOf("=");return r>=0&&r!==n.length-1&&(e=n.slice(0,r)),e}function xa(n){return new Promise(async(e,r)=>{try{const t=/^-----[^-]+-----$/m,i=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,u,l=a,h=[];const p=Ca(fn(n,async(f,g)=>{const d=ar(f);try{for(;;){let b=await d.readLine();if(b===void 0)throw Error("Misformed armored text");if(b=y.removeTrailingSpaces(b.replace(/[\r\n]/g,"")),s)if(o)u||s!==c.armor.signed||(t.test(b)?(h=h.join(`\r
`),u=!0,ts(l),l=[],o=!1):h.push(b.replace(/^- /,"")));else if(t.test(b)&&r(Error("Mandatory blank line missing between armor headers and armor data")),i.test(b)){if(ts(l),o=!0,u||s!==c.armor.signed){e({text:h,data:p,headers:a,type:s});break}}else l.push(b);else t.test(b)&&(s=Wc(b))}}catch(b){return void r(b)}const m=tt(g);try{for(;;){await m.ready;const{done:b,value:w}=await d.read();if(b)throw Error("Misformed armored text");const v=w+"";if(v.indexOf("=")!==-1||v.indexOf("-")!==-1){let E=await d.readToEnd();E.length||(E=""),E=v+E,E=y.removeTrailingSpaces(E.replace(/\r/g,""));const A=E.split(t);if(A.length===1)throw Error("Misformed armored text");const U=Qc(A[0].slice(0,-1));await m.write(U);break}await m.write(v)}await m.ready,await m.close()}catch(b){await m.abort(b)}}))}catch(t){r(t)}}).then(async e=>(Se(e.data)&&(e.data=await nr(e.data)),e))}function Ei(n,e,r,t,i,s=!1,a=L){let o,u;n===c.armor.signed&&(o=e.text,u=e.hash,e=e.data);const l=s&&qc(e),h=[];switch(n){case c.armor.multipartSection:h.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+t+`-----
`),h.push(Dt(i,a)),h.push(st(e)),l&&h.push("=",Ct(l)),h.push("-----END PGP MESSAGE, PART "+r+"/"+t+`-----
`);break;case c.armor.multipartLast:h.push("-----BEGIN PGP MESSAGE, PART "+r+`-----
`),h.push(Dt(i,a)),h.push(st(e)),l&&h.push("=",Ct(l)),h.push("-----END PGP MESSAGE, PART "+r+`-----
`);break;case c.armor.signed:h.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),h.push(u?`Hash: ${u}

`:`
`),h.push(o.replace(/^-/gm,"- -")),h.push(`
-----BEGIN PGP SIGNATURE-----
`),h.push(Dt(i,a)),h.push(st(e)),l&&h.push("=",Ct(l)),h.push(`-----END PGP SIGNATURE-----
`);break;case c.armor.message:h.push(`-----BEGIN PGP MESSAGE-----
`),h.push(Dt(i,a)),h.push(st(e)),l&&h.push("=",Ct(l)),h.push(`-----END PGP MESSAGE-----
`);break;case c.armor.publicKey:h.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),h.push(Dt(i,a)),h.push(st(e)),l&&h.push("=",Ct(l)),h.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case c.armor.privateKey:h.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),h.push(Dt(i,a)),h.push(st(e)),l&&h.push("=",Ct(l)),h.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case c.armor.signature:h.push(`-----BEGIN PGP SIGNATURE-----
`),h.push(Dt(i,a)),h.push(st(e)),l&&h.push("=",Ct(l)),h.push(`-----END PGP SIGNATURE-----
`)}return y.concat(h)}async function Yn(n){switch(n){case c.symmetric.aes128:case c.symmetric.aes192:case c.symmetric.aes256:throw Error("Not a legacy cipher");case c.symmetric.cast5:case c.symmetric.blowfish:case c.symmetric.twofish:case c.symmetric.tripledes:{const{legacyCiphers:e}=await yn(async()=>{const{legacyCiphers:t}=await import("./legacy_ciphers.min-DeP2ndyc.js");return{legacyCiphers:t}},[],import.meta.url),r=e.get(n);if(!r)throw Error("Unsupported cipher algorithm");return r}default:throw Error("Unsupported cipher algorithm")}}function Zc(n){switch(n){case c.symmetric.aes128:case c.symmetric.aes192:case c.symmetric.aes256:case c.symmetric.twofish:return 16;case c.symmetric.blowfish:case c.symmetric.cast5:case c.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function Xc(n){switch(n){case c.symmetric.aes128:case c.symmetric.blowfish:case c.symmetric.cast5:return 16;case c.symmetric.aes192:case c.symmetric.tripledes:return 24;case c.symmetric.aes256:case c.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function ke(n){return{keySize:Xc(n),blockSize:Zc(n)}}var Yc=Object.freeze({__proto__:null,getCipherParams:ke,getLegacyCipher:Yn});function Un(n,e){let r=n[0],t=n[1],i=n[2],s=n[3];r=de(r,t,i,s,e[0],7,-680876936),s=de(s,r,t,i,e[1],12,-389564586),i=de(i,s,r,t,e[2],17,606105819),t=de(t,i,s,r,e[3],22,-1044525330),r=de(r,t,i,s,e[4],7,-176418897),s=de(s,r,t,i,e[5],12,1200080426),i=de(i,s,r,t,e[6],17,-1473231341),t=de(t,i,s,r,e[7],22,-45705983),r=de(r,t,i,s,e[8],7,1770035416),s=de(s,r,t,i,e[9],12,-1958414417),i=de(i,s,r,t,e[10],17,-42063),t=de(t,i,s,r,e[11],22,-1990404162),r=de(r,t,i,s,e[12],7,1804603682),s=de(s,r,t,i,e[13],12,-40341101),i=de(i,s,r,t,e[14],17,-1502002290),t=de(t,i,s,r,e[15],22,1236535329),r=me(r,t,i,s,e[1],5,-165796510),s=me(s,r,t,i,e[6],9,-1069501632),i=me(i,s,r,t,e[11],14,643717713),t=me(t,i,s,r,e[0],20,-373897302),r=me(r,t,i,s,e[5],5,-701558691),s=me(s,r,t,i,e[10],9,38016083),i=me(i,s,r,t,e[15],14,-660478335),t=me(t,i,s,r,e[4],20,-405537848),r=me(r,t,i,s,e[9],5,568446438),s=me(s,r,t,i,e[14],9,-1019803690),i=me(i,s,r,t,e[3],14,-187363961),t=me(t,i,s,r,e[8],20,1163531501),r=me(r,t,i,s,e[13],5,-1444681467),s=me(s,r,t,i,e[2],9,-51403784),i=me(i,s,r,t,e[7],14,1735328473),t=me(t,i,s,r,e[12],20,-1926607734),r=we(r,t,i,s,e[5],4,-378558),s=we(s,r,t,i,e[8],11,-2022574463),i=we(i,s,r,t,e[11],16,1839030562),t=we(t,i,s,r,e[14],23,-35309556),r=we(r,t,i,s,e[1],4,-1530992060),s=we(s,r,t,i,e[4],11,1272893353),i=we(i,s,r,t,e[7],16,-155497632),t=we(t,i,s,r,e[10],23,-1094730640),r=we(r,t,i,s,e[13],4,681279174),s=we(s,r,t,i,e[0],11,-358537222),i=we(i,s,r,t,e[3],16,-722521979),t=we(t,i,s,r,e[6],23,76029189),r=we(r,t,i,s,e[9],4,-640364487),s=we(s,r,t,i,e[12],11,-421815835),i=we(i,s,r,t,e[15],16,530742520),t=we(t,i,s,r,e[2],23,-995338651),r=be(r,t,i,s,e[0],6,-198630844),s=be(s,r,t,i,e[7],10,1126891415),i=be(i,s,r,t,e[14],15,-1416354905),t=be(t,i,s,r,e[5],21,-57434055),r=be(r,t,i,s,e[12],6,1700485571),s=be(s,r,t,i,e[3],10,-1894986606),i=be(i,s,r,t,e[10],15,-1051523),t=be(t,i,s,r,e[1],21,-2054922799),r=be(r,t,i,s,e[8],6,1873313359),s=be(s,r,t,i,e[15],10,-30611744),i=be(i,s,r,t,e[6],15,-1560198380),t=be(t,i,s,r,e[13],21,1309151649),r=be(r,t,i,s,e[4],6,-145523070),s=be(s,r,t,i,e[11],10,-1120210379),i=be(i,s,r,t,e[2],15,718787259),t=be(t,i,s,r,e[9],21,-343485551),n[0]=At(r,n[0]),n[1]=At(t,n[1]),n[2]=At(i,n[2]),n[3]=At(s,n[3])}function gn(n,e,r,t,i,s){return e=At(At(e,n),At(t,s)),At(e<<i|e>>>32-i,r)}function de(n,e,r,t,i,s,a){return gn(e&r|~e&t,n,e,i,s,a)}function me(n,e,r,t,i,s,a){return gn(e&t|r&~t,n,e,i,s,a)}function we(n,e,r,t,i,s,a){return gn(e^r^t,n,e,i,s,a)}function be(n,e,r,t,i,s,a){return gn(r^(e|~t),n,e,i,s,a)}function Jc(n){const e=[];let r;for(r=0;r<64;r+=4)e[r>>2]=n.charCodeAt(r)+(n.charCodeAt(r+1)<<8)+(n.charCodeAt(r+2)<<16)+(n.charCodeAt(r+3)<<24);return e}const rs="0123456789abcdef".split("");function eu(n){let e="",r=0;for(;r<4;r++)e+=rs[n>>8*r+4&15]+rs[n>>8*r&15];return e}function At(n,e){return n+e&4294967295}const ns=y.getWebCrypto(),Vr=y.getNodeCrypto(),tu=Vr&&Vr.getHashes();function nt(n){if(Vr&&tu.includes(n))return async function(e){const r=Vr.createHash(n);return ne(e,t=>{r.update(t)},()=>new Uint8Array(r.digest()))}}function dt(n,e){const r=async()=>{const{nobleHashes:t}=await yn(async()=>{const{nobleHashes:s}=await import("./noble_hashes.min-DhilNtsz.js");return{nobleHashes:s}},__vite__mapDeps([2,1]),import.meta.url),i=t.get(n);if(!i)throw Error("Unsupported hash");return i};return async function(t){if(Se(t)&&(t=await nr(t)),y.isStream(t)){const i=(await r()).create();return ne(t,s=>{i.update(s)},()=>i.digest())}return ns&&e?new Uint8Array(await ns.digest(e,t)):(await r())(t)}}var Be={md5:nt("md5")||async function(n){const e=function(r){const t=r.length,i=[1732584193,-271733879,-1732584194,271733878];let s;for(s=64;s<=r.length;s+=64)Un(i,Jc(r.substring(s-64,s)));r=r.substring(s-64);const a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<r.length;s++)a[s>>2]|=r.charCodeAt(s)<<(s%4<<3);if(a[s>>2]|=128<<(s%4<<3),s>55)for(Un(i,a),s=0;s<16;s++)a[s]=0;return a[14]=8*t,Un(i,a),i}(y.uint8ArrayToString(n));return y.hexToUint8Array(function(r){for(let t=0;t<r.length;t++)r[t]=eu(r[t]);return r.join("")}(e))},sha1:nt("sha1")||dt("sha1","SHA-1"),sha224:nt("sha224")||dt("sha224"),sha256:nt("sha256")||dt("sha256","SHA-256"),sha384:nt("sha384")||dt("sha384","SHA-384"),sha512:nt("sha512")||dt("sha512","SHA-512"),ripemd:nt("ripemd160")||dt("ripemd160"),sha3_256:nt("sha3-256")||dt("sha3_256"),sha3_512:nt("sha3-512")||dt("sha3_512"),digest:function(n,e){switch(n){case c.hash.md5:return this.md5(e);case c.hash.sha1:return this.sha1(e);case c.hash.ripemd:return this.ripemd(e);case c.hash.sha256:return this.sha256(e);case c.hash.sha384:return this.sha384(e);case c.hash.sha512:return this.sha512(e);case c.hash.sha224:return this.sha224(e);case c.hash.sha3_256:return this.sha3_256(e);case c.hash.sha3_512:return this.sha3_512(e);default:throw Error("Unsupported hash function")}},getHashByteLength:function(n){switch(n){case c.hash.md5:return 16;case c.hash.sha1:case c.hash.ripemd:return 20;case c.hash.sha256:return 32;case c.hash.sha384:return 48;case c.hash.sha512:return 64;case c.hash.sha224:return 28;case c.hash.sha3_256:return 32;case c.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}};function Ba(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function z(n,...e){if(!Ba(n))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw Error(`Uint8Array expected of length ${e}, not of length=${n.length}`)}function Qr(n,e=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(e&&n.finished)throw Error("Hash#digest() has already been called")}function Ta(n,e){z(n);const r=e.outputLen;if(n.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const Pi=n=>new Uint8Array(n.buffer,n.byteOffset,n.byteLength),q=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),Zr=n=>new DataView(n.buffer,n.byteOffset,n.byteLength);if(new Uint8Array(new Uint32Array([287454020]).buffer)[0]!==68)throw Error("Non little-endian hardware is not supported");function Er(n){if(typeof n=="string")n=function(e){if(typeof e!="string")throw Error("string expected, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(n);else{if(!Ba(n))throw Error("Uint8Array expected, got "+typeof n);n=Ue(n)}return n}function La(n,e){if(n.length!==e.length)return!1;let r=0;for(let t=0;t<n.length;t++)r|=n[t]^e[t];return r===0}const Ur=(n,e)=>(Object.assign(e,n),e);function In(n,e,r,t){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,r,t);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s);n.setUint32(e+0,a,t),n.setUint32(e+4,o,t)}function Ne(n){return n.byteOffset%4==0}function Ue(n){return Uint8Array.from(n)}function ve(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}const at=16,Ki=new Uint8Array(16),Qe=q(Ki),Te=n=>(n>>>0&255)<<24|(n>>>8&255)<<16|(n>>>16&255)<<8|n>>>24&255;class Ma{constructor(e,r){this.blockLen=at,this.outputLen=at,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,z(e=Er(e),16);const t=Zr(e);let i=t.getUint32(0,!1),s=t.getUint32(4,!1),a=t.getUint32(8,!1),o=t.getUint32(12,!1);const u=[];for(let w=0;w<128;w++)u.push({s0:Te(i),s1:Te(s),s2:Te(a),s3:Te(o)}),{s0:i,s1:s,s2:a,s3:o}={s3:(p=a)<<31|(f=o)>>>1,s2:(h=s)<<31|p>>>1,s1:(l=i)<<31|h>>>1,s0:l>>>1^225<<24&-(1&f)};var l,h,p,f;const g=(w=>w>65536?8:w>1024?4:2)(r||1024);if(![1,2,4,8].includes(g))throw Error(`ghash: wrong window size=${g}, should be 2, 4 or 8`);this.W=g;const d=128/g,m=this.windowSize=2**g,b=[];for(let w=0;w<d;w++)for(let v=0;v<m;v++){let E=0,A=0,U=0,C=0;for(let I=0;I<g;I++){if(!(v>>>g-I-1&1))continue;const{s0:k,s1:S,s2:D,s3:P}=u[g*w+I];E^=k,A^=S,U^=D,C^=P}b.push({s0:E,s1:A,s2:U,s3:C})}this.t=b}_updateBlock(e,r,t,i){e^=this.s0,r^=this.s1,t^=this.s2,i^=this.s3;const{W:s,t:a,windowSize:o}=this;let u=0,l=0,h=0,p=0;const f=(1<<s)-1;let g=0;for(const d of[e,r,t,i])for(let m=0;m<4;m++){const b=d>>>8*m&255;for(let w=8/s-1;w>=0;w--){const v=b>>>s*w&f,{s0:E,s1:A,s2:U,s3:C}=a[g*o+v];u^=E,l^=A,h^=U,p^=C,g+=1}}this.s0=u,this.s1=l,this.s2=h,this.s3=p}update(e){e=Er(e),Qr(this);const r=q(e),t=Math.floor(e.length/at),i=e.length%at;for(let s=0;s<t;s++)this._updateBlock(r[4*s+0],r[4*s+1],r[4*s+2],r[4*s+3]);return i&&(Ki.set(e.subarray(t*at)),this._updateBlock(Qe[0],Qe[1],Qe[2],Qe[3]),ve(Qe)),this}destroy(){const{t:e}=this;for(const r of e)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(e){Qr(this),Ta(e,this),this.finished=!0;const{s0:r,s1:t,s2:i,s3:s}=this,a=q(e);return a[0]=r,a[1]=t,a[2]=i,a[3]=s,e}digest(){const e=new Uint8Array(at);return this.digestInto(e),this.destroy(),e}}class ru extends Ma{constructor(e,r){const t=function(i){i.reverse();const s=1&i[15];let a=0;for(let o=0;o<i.length;o++){const u=i[o];i[o]=u>>>1|a,a=(1&u)<<7}return i[0]^=225&-s,i}(Ue(e=Er(e)));super(t,r),ve(t)}update(e){e=Er(e),Qr(this);const r=q(e),t=e.length%at,i=Math.floor(e.length/at);for(let s=0;s<i;s++)this._updateBlock(Te(r[4*s+3]),Te(r[4*s+2]),Te(r[4*s+1]),Te(r[4*s+0]));return t&&(Ki.set(e.subarray(i*at)),this._updateBlock(Te(Qe[3]),Te(Qe[2]),Te(Qe[1]),Te(Qe[0])),ve(Qe)),this}digestInto(e){Qr(this),Ta(e,this),this.finished=!0;const{s0:r,s1:t,s2:i,s3:s}=this,a=q(e);return a[0]=r,a[1]=t,a[2]=i,a[3]=s,e.reverse()}}function Ra(n){const e=(t,i)=>n(i,t.length).update(Er(t)).digest(),r=n(new Uint8Array(16),0);return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=(t,i)=>n(t,i),e}const is=Ra((n,e)=>new Ma(n,e));Ra((n,e)=>new ru(n,e));const Pe=16,Dr=new Uint8Array(Pe),nu=283;function Ui(n){return n<<1^nu&-(n>>7)}function Vt(n,e){let r=0;for(;e>0;e>>=1)r^=n&-(1&e),n=Ui(n);return r}const Jn=(()=>{const n=new Uint8Array(256);for(let r=0,t=1;r<256;r++,t^=Ui(t))n[r]=t;const e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let t=n[255-r];t|=t<<8,e[n[r]]=255&(t^t>>4^t>>5^t>>6^t>>7^99)}return ve(n),e})(),iu=Jn.map((n,e)=>Jn.indexOf(e)),su=n=>n<<24|n>>>8,Dn=n=>n<<8|n>>>24,ss=n=>n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255;function Fa(n,e){if(n.length!==256)throw Error("Wrong sbox length");const r=new Uint32Array(256).map((l,h)=>e(n[h])),t=r.map(Dn),i=t.map(Dn),s=i.map(Dn),a=new Uint32Array(65536),o=new Uint32Array(65536),u=new Uint16Array(65536);for(let l=0;l<256;l++)for(let h=0;h<256;h++){const p=256*l+h;a[p]=r[l]^t[h],o[p]=i[l]^s[h],u[p]=n[l]<<8|n[h]}return{sbox:n,sbox2:u,T0:r,T1:t,T2:i,T3:s,T01:a,T23:o}}const Ii=Fa(Jn,n=>Vt(n,3)<<24|n<<16|n<<8|Vt(n,2)),Na=Fa(iu,n=>Vt(n,11)<<24|Vt(n,13)<<16|Vt(n,9)<<8|Vt(n,14)),au=(()=>{const n=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=Ui(r))n[e]=r;return n})();function zt(n){z(n);const e=n.length;if(![16,24,32].includes(e))throw Error("aes: wrong key size: should be 16, 24 or 32, got: "+e);const{sbox2:r}=Ii,t=[];Ne(n)||t.push(n=Ue(n));const i=q(n),s=i.length,a=u=>Xe(r,u,u,u,u),o=new Uint32Array(e+28);o.set(i);for(let u=s;u<o.length;u++){let l=o[u-1];u%s==0?l=a(su(l))^au[u/s-1]:s>6&&u%s==4&&(l=a(l)),o[u]=o[u-s]^l}return ve(...t),o}function Di(n){const e=zt(n),r=e.slice(),t=e.length,{sbox2:i}=Ii,{T0:s,T1:a,T2:o,T3:u}=Na;for(let l=0;l<t;l+=4)for(let h=0;h<4;h++)r[l+h]=e[t-l-4+h];ve(e);for(let l=4;l<t-4;l++){const h=r[l],p=Xe(i,h,h,h,h);r[l]=s[255&p]^a[p>>>8&255]^o[p>>>16&255]^u[p>>>24]}return r}function St(n,e,r,t,i,s){return n[r<<8&65280|t>>>8&255]^e[i>>>8&65280|s>>>24&255]}function Xe(n,e,r,t,i){return n[255&e|65280&r]|n[t>>>16&255|i>>>16&65280]<<16}function ze(n,e,r,t,i){const{sbox2:s,T01:a,T23:o}=Ii;let u=0;e^=n[u++],r^=n[u++],t^=n[u++],i^=n[u++];const l=n.length/4-2;for(let h=0;h<l;h++){const p=n[u++]^St(a,o,e,r,t,i),f=n[u++]^St(a,o,r,t,i,e),g=n[u++]^St(a,o,t,i,e,r),d=n[u++]^St(a,o,i,e,r,t);e=p,r=f,t=g,i=d}return{s0:n[u++]^Xe(s,e,r,t,i),s1:n[u++]^Xe(s,r,t,i,e),s2:n[u++]^Xe(s,t,i,e,r),s3:n[u++]^Xe(s,i,e,r,t)}}function dn(n,e,r,t,i){const{sbox2:s,T01:a,T23:o}=Na;let u=0;e^=n[u++],r^=n[u++],t^=n[u++],i^=n[u++];const l=n.length/4-2;for(let h=0;h<l;h++){const p=n[u++]^St(a,o,e,i,t,r),f=n[u++]^St(a,o,r,e,i,t),g=n[u++]^St(a,o,t,r,e,i),d=n[u++]^St(a,o,i,t,r,e);e=p,r=f,t=g,i=d}return{s0:n[u++]^Xe(s,e,i,t,r),s1:n[u++]^Xe(s,r,e,i,t),s2:n[u++]^Xe(s,t,r,e,i),s3:n[u++]^Xe(s,i,t,r,e)}}function Pr(n,e){if(e===void 0)return new Uint8Array(n);if(z(e),e.length<n)throw Error(`aes: wrong destination length, expected at least ${n}, got: ${e.length}`);if(!Ne(e))throw Error("unaligned dst");return e}function Oa(n,e,r,t){z(e,Pe),z(r);const i=r.length;t=Pr(i,t);const s=e,a=q(s);let{s0:o,s1:u,s2:l,s3:h}=ze(n,a[0],a[1],a[2],a[3]);const p=q(r),f=q(t);for(let d=0;d+4<=p.length;d+=4){f[d+0]=p[d+0]^o,f[d+1]=p[d+1]^u,f[d+2]=p[d+2]^l,f[d+3]=p[d+3]^h;let m=1;for(let b=s.length-1;b>=0;b--)m=m+(255&s[b])|0,s[b]=255&m,m>>>=8;({s0:o,s1:u,s2:l,s3:h}=ze(n,a[0],a[1],a[2],a[3]))}const g=Pe*Math.floor(p.length/4);if(g<i){const d=new Uint32Array([o,u,l,h]),m=Pi(d);for(let b=g,w=0;b<i;b++,w++)t[b]=r[b]^m[w];ve(d)}return t}function gr(n,e,r,t,i){z(r,Pe),z(t),i=Pr(t.length,i);const s=r,a=q(s),o=Zr(s),u=q(t),l=q(i),h=e?0:12,p=t.length;let f=o.getUint32(h,e),{s0:g,s1:d,s2:m,s3:b}=ze(n,a[0],a[1],a[2],a[3]);for(let v=0;v+4<=u.length;v+=4)l[v+0]=u[v+0]^g,l[v+1]=u[v+1]^d,l[v+2]=u[v+2]^m,l[v+3]=u[v+3]^b,f=f+1>>>0,o.setUint32(h,f,e),{s0:g,s1:d,s2:m,s3:b}=ze(n,a[0],a[1],a[2],a[3]);const w=Pe*Math.floor(u.length/4);if(w<p){const v=new Uint32Array([g,d,m,b]),E=Pi(v);for(let A=w,U=0;A<p;A++,U++)i[A]=t[A]^E[U];ve(v)}return i}const ou=Ur({blockSize:16,nonceLength:16},function(n,e){function r(t,i){if(z(t),i!==void 0&&(z(i),!Ne(i)))throw Error("unaligned destination");const s=zt(n),a=Ue(e),o=[s,a];Ne(t)||o.push(t=Ue(t));const u=Oa(s,a,t,i);return ve(...o),u}return z(n),z(e,Pe),{encrypt:(t,i)=>r(t,i),decrypt:(t,i)=>r(t,i)}}),Ha=Ur({blockSize:16,nonceLength:16},function(n,e,r={}){z(n),z(e,16);const t=!r.disablePadding;return{encrypt(i,s){const a=zt(n),{b:o,o:u,out:l}=function(v,E,A){z(v);let U=v.length;const C=U%Pe;if(!E&&C!==0)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");Ne(v)||(v=Ue(v));const I=q(v);if(E){let S=Pe-C;S||(S=Pe),U+=S}const k=Pr(U,A);return{b:I,o:q(k),out:k}}(i,t,s);let h=e;const p=[a];Ne(h)||p.push(h=Ue(h));const f=q(h);let g=f[0],d=f[1],m=f[2],b=f[3],w=0;for(;w+4<=o.length;)g^=o[w+0],d^=o[w+1],m^=o[w+2],b^=o[w+3],{s0:g,s1:d,s2:m,s3:b}=ze(a,g,d,m,b),u[w++]=g,u[w++]=d,u[w++]=m,u[w++]=b;if(t){const v=function(E){const A=new Uint8Array(16),U=q(A);A.set(E);const C=Pe-E.length;for(let I=Pe-C;I<Pe;I++)A[I]=C;return U}(i.subarray(4*w));g^=v[0],d^=v[1],m^=v[2],b^=v[3],{s0:g,s1:d,s2:m,s3:b}=ze(a,g,d,m,b),u[w++]=g,u[w++]=d,u[w++]=m,u[w++]=b}return ve(...p),l},decrypt(i,s){(function(w){if(z(w),w.length%Pe!=0)throw Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")})(i);const a=Di(n);let o=e;const u=[a];Ne(o)||u.push(o=Ue(o));const l=q(o),h=Pr(i.length,s);Ne(i)||u.push(i=Ue(i));const p=q(i),f=q(h);let g=l[0],d=l[1],m=l[2],b=l[3];for(let w=0;w+4<=p.length;){const v=g,E=d,A=m,U=b;g=p[w+0],d=p[w+1],m=p[w+2],b=p[w+3];const{s0:C,s1:I,s2:k,s3:S}=dn(a,g,d,m,b);f[w++]=C^v,f[w++]=I^E,f[w++]=k^A,f[w++]=S^U}return ve(...u),function(w,v){if(!v)return w;const E=w.length;if(!E)throw Error("aes/pcks5: empty ciphertext not allowed");const A=w[E-1];if(A<=0||A>16)throw Error("aes/pcks5: wrong padding");const U=w.subarray(0,-A);for(let C=0;C<A;C++)if(w[E-C-1]!==A)throw Error("aes/pcks5: wrong padding");return U}(h,t)}}}),as=Ur({blockSize:16,nonceLength:16},function(n,e){function r(t,i,s){z(t);const a=t.length;s=Pr(a,s);const o=zt(n);let u=e;const l=[o];Ne(u)||l.push(u=Ue(u)),Ne(t)||l.push(t=Ue(t));const h=q(t),p=q(s),f=i?p:h,g=q(u);let d=g[0],m=g[1],b=g[2],w=g[3];for(let E=0;E+4<=h.length;){const{s0:A,s1:U,s2:C,s3:I}=ze(o,d,m,b,w);p[E+0]=h[E+0]^A,p[E+1]=h[E+1]^U,p[E+2]=h[E+2]^C,p[E+3]=h[E+3]^I,d=f[E++],m=f[E++],b=f[E++],w=f[E++]}const v=Pe*Math.floor(h.length/4);if(v<a){({s0:d,s1:m,s2:b,s3:w}=ze(o,d,m,b,w));const E=Pi(new Uint32Array([d,m,b,w]));for(let A=v,U=0;A<a;A++,U++)s[A]=t[A]^E[U];ve(E)}return ve(...l),s}return z(n),z(e,16),{encrypt:(t,i)=>r(t,!0,i),decrypt:(t,i)=>r(t,!1,i)}}),Cr=Ur({blockSize:16,nonceLength:12,tagLength:16},function(n,e,r){if(z(n),z(e),r!==void 0&&z(r),e.length<8)throw Error("aes/gcm: invalid nonce length");const t=16;function i(a,o,u){const l=function(h,p,f,g,d){const m=d==null?0:d.length,b=h.create(f,g.length+m);d&&b.update(d),b.update(g);const w=new Uint8Array(16),v=Zr(w);d&&In(v,0,BigInt(8*m),p),In(v,8,BigInt(8*g.length),p),b.update(w);const E=b.digest();return ve(w),E}(is,!1,a,u,r);for(let h=0;h<o.length;h++)l[h]^=o[h];return l}function s(){const a=zt(n),o=Dr.slice(),u=Dr.slice();if(gr(a,!1,u,u,o),e.length===12)u.set(e);else{const l=Dr.slice();In(Zr(l),8,BigInt(8*e.length),!1);const h=is.create(o).update(e).update(l);h.digestInto(u),h.destroy()}return{xk:a,authKey:o,counter:u,tagMask:gr(a,!1,u,Dr)}}return{encrypt(a){z(a);const{xk:o,authKey:u,counter:l,tagMask:h}=s(),p=new Uint8Array(a.length+t),f=[o,u,l,h];Ne(a)||f.push(a=Ue(a)),gr(o,!1,l,a,p);const g=i(u,h,p.subarray(0,p.length-t));return f.push(g),p.set(g,a.length),ve(...f),p},decrypt(a){if(z(a),a.length<t)throw Error("aes/gcm: ciphertext less than tagLen (16)");const{xk:o,authKey:u,counter:l,tagMask:h}=s(),p=[o,u,h,l];Ne(a)||p.push(a=Ue(a));const f=a.subarray(0,-16),g=a.subarray(-16),d=i(u,h,f);if(p.push(d),!La(d,g))throw Error("aes/gcm: invalid ghash tag");const m=gr(o,!1,l,f);return ve(...p),m}}});function $a(n){return n!=null&&typeof n=="object"&&(n instanceof Uint32Array||n.constructor.name==="Uint32Array")}function za(n,e){if(z(e,16),!$a(n))throw Error("_encryptBlock accepts result of expandKeyLE");const r=q(e);let{s0:t,s1:i,s2:s,s3:a}=ze(n,r[0],r[1],r[2],r[3]);return r[0]=t,r[1]=i,r[2]=s,r[3]=a,e}function _a(n,e){if(z(e,16),!$a(n))throw Error("_decryptBlock accepts result of expandKeyLE");const r=q(e);let{s0:t,s1:i,s2:s,s3:a}=dn(n,r[0],r[1],r[2],r[3]);return r[0]=t,r[1]=i,r[2]=s,r[3]=a,e}const os={encrypt(n,e){if(e.length>=2**32)throw Error("plaintext should be less than 4gb");const r=zt(n);if(e.length===16)za(r,e);else{const t=q(e);let i=t[0],s=t[1];for(let a=0,o=1;a<6;a++)for(let u=2;u<t.length;u+=2,o++){const{s0:l,s1:h,s2:p,s3:f}=ze(r,i,s,t[u],t[u+1]);i=l,s=h^ss(o),t[u]=p,t[u+1]=f}t[0]=i,t[1]=s}r.fill(0)},decrypt(n,e){if(e.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const r=Di(n),t=e.length/8-1;if(t===1)_a(r,e);else{const i=q(e);let s=i[0],a=i[1];for(let o=0,u=6*t;o<6;o++)for(let l=2*t;l>=1;l-=2,u--){a^=ss(u);const{s0:h,s1:p,s2:f,s3:g}=dn(r,s,a,i[l],i[l+1]);s=h,a=p,i[l]=f,i[l+1]=g}i[0]=s,i[1]=a}r.fill(0)}},cs=new Uint8Array(8).fill(166),ja=Ur({blockSize:8},n=>({encrypt(e){if(z(e),!e.length||e.length%8!=0)throw Error("invalid plaintext length");if(e.length===8)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const r=function(...t){let i=0;for(let a=0;a<t.length;a++){const o=t[a];z(o),i+=o.length}const s=new Uint8Array(i);for(let a=0,o=0;a<t.length;a++){const u=t[a];s.set(u,o),o+=u.length}return s}(cs,e);return os.encrypt(n,r),r},decrypt(e){if(z(e),e.length%8!=0||e.length<24)throw Error("invalid ciphertext length");const r=Ue(e);if(os.decrypt(n,r),!La(r.subarray(0,8),cs))throw Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}})),us={expandKeyLE:zt,expandKeyDecLE:Di,encrypt:ze,decrypt:dn,encryptBlock:za,decryptBlock:_a,ctrCounter:Oa,ctr32:gr},Or=y.getWebCrypto(),kr=y.getNodeCrypto(),xt=kr?kr.getCiphers():[],xr={idea:xt.includes("idea-cfb")?"idea-cfb":void 0,tripledes:xt.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:xt.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:xt.includes("bf-cfb")?"bf-cfb":void 0,aes128:xt.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:xt.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:xt.includes("aes-256-cfb")?"aes-256-cfb":void 0};class ls{constructor(e,r,t){const{blockSize:i}=ke(e);this.key=r,this.prevBlock=t,this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(e){const{keySize:r}=ke(e);return Or.importKey("raw",new Uint8Array(r),"aes-cbc",!1,["encrypt"]).then(()=>!0,()=>!1)}async _runCBC(e,r){const t="AES-CBC";this.keyRef=this.keyRef||await Or.importKey("raw",this.key,t,!1,["encrypt"]);const i=await Or.encrypt({name:t,iv:r||this.zeroBlock},this.keyRef,e);return new Uint8Array(i).subarray(0,e.length)}async encryptChunk(e){const r=this.nextBlock.length-this.i,t=e.subarray(0,r);if(this.nextBlock.set(t,this.i),this.i+e.length>=2*this.blockSize){const s=(e.length-r)%this.blockSize,a=y.concatUint8Array([this.nextBlock,e.subarray(r,e.length-s)]),o=y.concatUint8Array([this.prevBlock,a.subarray(0,a.length-this.blockSize)]),u=await this._runCBC(o);return Br(u,a),this.prevBlock=u.slice(-this.blockSize),s>0&&this.nextBlock.set(e.subarray(-s)),this.i=s,u}let i;if(this.i+=t.length,this.i===this.nextBlock.length){const s=this.nextBlock;i=await this._runCBC(this.prevBlock),Br(i,s),this.prevBlock=i.slice(),this.i=0;const a=e.subarray(t.length);this.nextBlock.set(a,this.i),this.i+=a.length}else i=new Uint8Array;return i}async finish(){let e;if(this.i===0)e=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const r=this.nextBlock,t=await this._runCBC(this.prevBlock);Br(t,r),e=t.subarray(0,r.length)}return this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(e){const r=(await this._runCBC(y.concatUint8Array([new Uint8Array(this.blockSize),e]),this.iv)).subarray(0,e.length);return Br(r,e),this.clearSensitiveData(),r}}class hs{constructor(e,r,t,i){this.forEncryption=e;const{blockSize:s}=ke(r);this.key=us.expandKeyLE(t),i.byteOffset%4!=0&&(i=i.slice()),this.prevBlock=Cn(i),this.nextBlock=new Uint8Array(s),this.i=0,this.blockSize=s}_runCFB(e){const r=Cn(e),t=new Uint8Array(e.length),i=Cn(t);for(let s=0;s+4<=i.length;s+=4){const{s0:a,s1:o,s2:u,s3:l}=us.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);i[s+0]=r[s+0]^a,i[s+1]=r[s+1]^o,i[s+2]=r[s+2]^u,i[s+3]=r[s+3]^l,this.prevBlock=(this.forEncryption?i:r).slice(s,s+4)}return t}async processChunk(e){const r=this.nextBlock.length-this.i,t=e.subarray(0,r);if(this.nextBlock.set(t,this.i),this.i+e.length>=2*this.blockSize){const s=(e.length-r)%this.blockSize,a=y.concatUint8Array([this.nextBlock,e.subarray(r,e.length-s)]),o=this._runCFB(a);return s>0&&this.nextBlock.set(e.subarray(-s)),this.i=s,o}let i;if(this.i+=t.length,this.i===this.nextBlock.length){i=this._runCFB(this.nextBlock),this.i=0;const s=e.subarray(t.length);this.nextBlock.set(s,this.i),this.i+=s.length}else i=new Uint8Array;return i}async finish(){let e;return this.i===0?e=new Uint8Array:e=this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function Br(n,e){const r=Math.min(n.length,e.length);for(let t=0;t<r;t++)n[t]=n[t]^e[t]}const Cn=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4));var cu=Object.freeze({__proto__:null,decrypt:async function(n,e,r,t){const i=c.read(c.symmetric,n);if(kr&&xr[i])return function(h,p,f,g){const d=c.read(c.symmetric,h),m=new kr.createDecipheriv(xr[d],p,g);return ne(f,b=>new Uint8Array(m.update(b)))}(n,e,r,t);if(y.isAES(n))return async function(h,p,f,g){if(y.isStream(f)){const d=new hs(!1,h,p,g);return ne(f,m=>d.processChunk(m),()=>d.finish())}return as(p,g).decrypt(f)}(n,e,r,t);const s=new(await Yn(n))(e),a=s.blockSize;let o=t,u=new Uint8Array;const l=h=>{h&&(u=y.concatUint8Array([u,h]));const p=new Uint8Array(u.length);let f,g=0;for(;h?u.length>=a:u.length;){const d=s.encrypt(o);for(o=u.subarray(0,a),f=0;f<a;f++)p[g++]=o[f]^d[f];u=u.subarray(a)}return p.subarray(0,g)};return ne(r,l,l)},encrypt:async function(n,e,r,t,i){const s=c.read(c.symmetric,n);if(y.getNodeCrypto()&&xr[s])return function(p,f,g,d){const m=c.read(c.symmetric,p),b=new kr.createCipheriv(xr[m],f,d);return ne(g,w=>new Uint8Array(b.update(w)))}(n,e,r,t);if(y.isAES(n))return async function(p,f,g,d){if(Or&&await ls.isSupported(p)){const m=new ls(p,f,d);return y.isStream(g)?ne(g,b=>m.encryptChunk(b),()=>m.finish()):m.encrypt(g)}if(y.isStream(g)){const m=new hs(!0,p,f,d);return ne(g,b=>m.processChunk(b),()=>m.finish())}return as(f,d).encrypt(g)}(n,e,r,t);const a=new(await Yn(n))(e),o=a.blockSize,u=t.slice();let l=new Uint8Array;const h=p=>{p&&(l=y.concatUint8Array([l,p]));const f=new Uint8Array(l.length);let g,d=0;for(;p?l.length>=o:l.length;){const m=a.encrypt(u);for(g=0;g<o;g++)u[g]=l[g]^m[g],f[d++]=u[g];l=l.subarray(o)}return f.subarray(0,d)};return ne(r,h,h)}});const ys=y.getWebCrypto(),uu=y.getNodeCrypto(),ct=16;function ps(n,e){const r=n.length-ct;for(let t=0;t<ct;t++)n[t+r]^=e[t];return n}const Hr=new Uint8Array(ct);async function lu(n){const e=await hu(n),r=y.double(await e(Hr)),t=y.double(r);return async function(i){return(await e(function(s,a,o){if(s.length&&s.length%ct==0)return ps(s,a);const u=new Uint8Array(s.length+(ct-s.length%ct));return u.set(s),u[s.length]=128,ps(u,o)}(i,r,t))).subarray(-ct)}}async function hu(n){if(y.getNodeCrypto())return async function(e){const r=new uu.createCipheriv("aes-"+8*n.length+"-cbc",n,Hr).update(e);return new Uint8Array(r)};if(y.getWebCrypto())try{return n=await ys.importKey("raw",n,{name:"AES-CBC",length:8*n.length},!1,["encrypt"]),async function(e){const r=await ys.encrypt({name:"AES-CBC",iv:Hr,length:8*ct},n,e);return new Uint8Array(r).subarray(0,r.byteLength-ct)}}catch(e){if(e.name!=="NotSupportedError"&&(n.length!==24||e.name!=="OperationError"))throw e;y.printDebugError("Browser did not support operation: "+e.message)}return async function(e){return Ha(n,Hr,{disablePadding:!0}).encrypt(e)}}const fs=y.getWebCrypto(),yu=y.getNodeCrypto(),pu=y.getNodeBuffer(),ht=16,fu=ht,Gt=ht,gs=new Uint8Array(ht),ei=new Uint8Array(ht);ei[ht-1]=1;const ti=new Uint8Array(ht);async function gu(n){const e=await lu(n);return function(r,t){return e(y.concatUint8Array([r,t]))}}async function du(n){if(y.getNodeCrypto())return async function(e,r){const t=new yu.createCipheriv("aes-"+8*n.length+"-ctr",n,r),i=pu.concat([t.update(e),t.final()]);return new Uint8Array(i)};if(y.getWebCrypto())try{const e=await fs.importKey("raw",n,{name:"AES-CTR",length:8*n.length},!1,["encrypt"]);return async function(r,t){const i=await fs.encrypt({name:"AES-CTR",counter:t,length:8*ht},e,r);return new Uint8Array(i)}}catch(e){if(e.name!=="NotSupportedError"&&(n.length!==24||e.name!=="OperationError"))throw e;y.printDebugError("Browser did not support operation: "+e.message)}return async function(e,r){return ou(n,r).encrypt(e)}}async function dr(n,e){if(n!==c.symmetric.aes128&&n!==c.symmetric.aes192&&n!==c.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[r,t]=await Promise.all([gu(e),du(e)]);return{encrypt:async function(i,s,a){const[o,u]=await Promise.all([r(gs,s),r(ei,a)]),l=await t(i,o),h=await r(ti,l);for(let p=0;p<Gt;p++)h[p]^=u[p]^o[p];return y.concatUint8Array([l,h])},decrypt:async function(i,s,a){if(i.length<Gt)throw Error("Invalid EAX ciphertext");const o=i.subarray(0,-Gt),u=i.subarray(-Gt),[l,h,p]=await Promise.all([r(gs,s),r(ei,a),r(ti,o)]),f=p;for(let g=0;g<Gt;g++)f[g]^=h[g]^l[g];if(!y.equalsUint8Array(u,f))throw Error("Authentication tag mismatch");return await t(o,l)}}}ti[ht-1]=2,dr.getNonce=function(n,e){const r=n.slice();for(let t=0;t<e.length;t++)r[8+t]^=e[t];return r},dr.blockLength=ht,dr.ivLength=fu,dr.tagLength=Gt;const Ce=16,ri=16;function ds(n){let e=0;for(let r=1;!(n&r);r<<=1)e++;return e}function Ee(n,e){for(let r=0;r<n.length;r++)n[r]^=e[r];return n}function Tr(n,e){return Ee(n.slice(),e)}const Lr=new Uint8Array(Ce),mu=new Uint8Array([1]);async function mr(n,e){const{keySize:r}=ke(n);if(!y.isAES(n)||e.length!==r)throw Error("Unexpected algorithm or key size");let t=0;const i=Ha(e,Lr,{disablePadding:!0}),s=l=>i.encrypt(l),a=l=>i.decrypt(l);let o;function u(l,h,p,f){const g=h.length/Ce|0;(function(k,S){const D=y.nbits(Math.max(k.length,S.length)/Ce|0)-1;for(let P=t+1;P<=D;P++)o[P]=y.double(o[P-1]);t=D})(h,f);const d=y.concatUint8Array([Lr.subarray(0,15-p.length),mu,p]),m=63&d[15];d[15]&=192;const b=s(d),w=y.concatUint8Array([b,Tr(b.subarray(0,8),b.subarray(1,9))]),v=y.shiftRight(w.subarray(0+(m>>3),17+(m>>3)),8-(7&m)).subarray(1),E=new Uint8Array(Ce),A=new Uint8Array(h.length+ri);let U,C=0;for(U=0;U<g;U++)Ee(v,o[ds(U+1)]),A.set(Ee(l(Tr(v,h)),v),C),Ee(E,l===s?h:A.subarray(C)),h=h.subarray(Ce),C+=Ce;if(h.length){Ee(v,o.x);const k=s(v);A.set(Tr(h,k),C);const S=new Uint8Array(Ce);S.set(l===s?h:A.subarray(C,-16),0),S[h.length]=128,Ee(E,S),C+=h.length}const I=Ee(s(Ee(Ee(E,v),o.$)),function(k){if(!k.length)return Lr;const S=k.length/Ce|0,D=new Uint8Array(Ce),P=new Uint8Array(Ce);for(let K=0;K<S;K++)Ee(D,o[ds(K+1)]),Ee(P,s(Tr(D,k))),k=k.subarray(Ce);if(k.length){Ee(D,o.x);const K=new Uint8Array(Ce);K.set(k,0),K[k.length]=128,Ee(K,D),Ee(P,s(K))}return P}(f));return A.set(I,C),A}return function(){const l=s(Lr),h=y.double(l);o=[],o[0]=y.double(h),o.x=l,o.$=h}(),{encrypt:async function(l,h,p){return u(s,l,h,p)},decrypt:async function(l,h,p){if(l.length<ri)throw Error("Invalid OCB ciphertext");const f=l.subarray(-16);l=l.subarray(0,-16);const g=u(a,l,h,p);if(y.equalsUint8Array(f,g.subarray(-16)))return g.subarray(0,-16);throw Error("Authentication tag mismatch")}}}mr.getNonce=function(n,e){const r=n.slice();for(let t=0;t<e.length;t++)r[7+t]^=e[t];return r},mr.blockLength=Ce,mr.ivLength=15,mr.tagLength=ri;const xn=y.getWebCrypto(),ms=y.getNodeCrypto(),ws=y.getNodeBuffer(),$r=16,Bn="AES-GCM";async function Qt(n,e){if(n!==c.symmetric.aes128&&n!==c.symmetric.aes192&&n!==c.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(y.getNodeCrypto())return{encrypt:async function(r,t,i=new Uint8Array){const s=new ms.createCipheriv("aes-"+8*e.length+"-gcm",e,t);s.setAAD(i);const a=ws.concat([s.update(r),s.final(),s.getAuthTag()]);return new Uint8Array(a)},decrypt:async function(r,t,i=new Uint8Array){const s=new ms.createDecipheriv("aes-"+8*e.length+"-gcm",e,t);s.setAAD(i),s.setAuthTag(r.slice(r.length-$r,r.length));const a=ws.concat([s.update(r.slice(0,r.length-$r)),s.final()]);return new Uint8Array(a)}};if(y.getWebCrypto())try{const r=await xn.importKey("raw",e,{name:Bn},!1,["encrypt","decrypt"]),t=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(i,s,a=new Uint8Array){if(t&&!i.length)return Cr(e,s,a).encrypt(i);const o=await xn.encrypt({name:Bn,iv:s,additionalData:a,tagLength:128},r,i);return new Uint8Array(o)},decrypt:async function(i,s,a=new Uint8Array){if(t&&i.length===$r)return Cr(e,s,a).decrypt(i);try{const o=await xn.decrypt({name:Bn,iv:s,additionalData:a,tagLength:128},r,i);return new Uint8Array(o)}catch(o){if(o.name==="OperationError")throw Error("Authentication tag mismatch")}}}}catch(r){if(r.name!=="NotSupportedError"&&(e.length!==24||r.name!=="OperationError"))throw r;y.printDebugError("Browser did not support operation: "+r.message)}return{encrypt:async function(r,t,i){return Cr(e,t,i).encrypt(r)},decrypt:async function(r,t,i){return Cr(e,t,i).decrypt(r)}}}Qt.getNonce=function(n,e){const r=n.slice();for(let t=0;t<e.length;t++)r[4+t]^=e[t];return r},Qt.blockLength=16,Qt.ivLength=12,Qt.tagLength=$r;var qa={cfb:cu,gcm:Qt,experimentalGCM:Qt,eax:dr,ocb:mr};const Ie=BigInt(0),Yt=BigInt(1);function T(n){const e="0123456789ABCDEF";let r="";return n.forEach(t=>{r+=e[t>>4]+e[15&t]}),BigInt("0x0"+r)}function F(n,e){const r=n%e;return r<Ie?r+e:r}function le(n,e,r){if(r===Ie)throw Error("Modulo cannot be zero");if(r===Yt)return BigInt(0);if(e<Ie)throw Error("Unsopported negative exponent");let t=e,i=n;i%=r;let s=BigInt(1);for(;t>Ie;){const a=t&Yt;t>>=Yt,s=a?s*i%r:s,i=i*i%r}return s}function bs(n){return n>=Ie?n:-n}function Jt(n,e){const{gcd:r,x:t}=function(i,s){let a=BigInt(0),o=BigInt(1),u=BigInt(1),l=BigInt(0),h=bs(i),p=bs(s);const f=i<Ie,g=s<Ie;for(;p!==Ie;){const d=h/p;let m=a;a=u-d*a,u=m,m=o,o=l-d*o,l=m,m=p,p=h%p,h=m}return{x:f?-u:u,y:g?-l:l,gcd:h}}(n,e);if(r!==Yt)throw Error("Inverse does not exist");return F(t+e,e)}function ni(n){const e=Number(n);if(e>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return e}function wu(n,e){return(n>>BigInt(e)&Yt)===Ie?0:1}function ir(n){const e=n<Ie?BigInt(-1):Ie;let r=1,t=n;for(;(t>>=Yt)!==e;)r++;return r}function Ke(n){const e=n<Ie?BigInt(-1):Ie,r=BigInt(8);let t=1,i=n;for(;(i>>=r)!==e;)t++;return t}function oe(n,e="be",r){let t=n.toString(16);t.length%2==1&&(t="0"+t);const i=t.length/2,s=new Uint8Array(r||i),a=r?r-i:0;let o=0;for(;o<i;)s[o+a]=parseInt(t.slice(2*o,2*o+2),16),o++;return e!=="be"&&s.reverse(),s}const bu=y.getNodeCrypto();function yt(n){const e=typeof crypto<"u"?crypto:bu?.webcrypto;if(e?.getRandomValues){const r=new Uint8Array(n);return e.getRandomValues(r)}throw Error("No secure random number generator available.")}function pt(n,e){if(e<n)throw Error("Illegal parameter value: max <= min");const r=e-n;return F(T(yt(Ke(r)+8)),r)+n}var ku=Object.freeze({__proto__:null,getRandomBigInteger:pt,getRandomBytes:yt});const Ge=BigInt(1);function ks(n,e,r){const t=BigInt(30),i=Ge<<BigInt(n-1),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2];let a=pt(i,i<<Ge),o=ni(F(a,t));do a+=BigInt(s[o]),o=(o+s[o])%s.length,ir(a)>n&&(a=F(a,i<<Ge),a+=i,o=ni(F(a,t)));while(!Ga(a,e,r));return a}function Ga(n,e,r){return(!e||function(t,i){let s=t,a=i;for(;a!==Ie;){const o=a;a=s%a,s=o}return s}(n-Ge,e)===Ge)&&!!function(t){const i=BigInt(0);return vu.every(s=>F(t,s)!==i)}(n)&&!!function(t,i=BigInt(2)){return le(i,t-Ge,t)===Ge}(n)&&!!function(t,i){const s=ir(t);i||(i=Math.max(1,s/48|0));const a=t-Ge;let o=0;for(;!wu(a,o);)o++;const u=t>>BigInt(o);for(;i>0;i--){let l,h=le(pt(BigInt(2),a),u,t);if(h!==Ge&&h!==a){for(l=1;l<o;l++){if(h=F(h*h,t),h===Ge)return!1;if(h===a)break}if(l===o)return!1}}return!0}(n,r)}const vu=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map(n=>BigInt(n)),We=[];function Ci(n,e){const r=n.length;if(r>e-11)throw Error("Message too long");const t=function(s){const a=new Uint8Array(s);let o=0;for(;o<s;){const u=yt(s-o);for(let l=0;l<u.length;l++)u[l]!==0&&(a[o++]=u[l])}return a}(e-r-3),i=new Uint8Array(e);return i[1]=2,i.set(t,2),i.set(n,e-r),i}function xi(n,e){let r=2,t=1;for(let o=r;o<n.length;o++)t&=n[o]!==0,r+=t;const i=r-2,s=n.subarray(r+1),a=n[0]===0&n[1]===2&i>=8&!t;if(e)return y.selectUint8Array(a,s,e);if(a)return s;throw Error("Decryption error")}function ii(n,e,r){let t;if(e.length!==Be.getHashByteLength(n))throw Error("Invalid hash length");const i=new Uint8Array(We[n].length);for(t=0;t<We[n].length;t++)i[t]=We[n][t];const s=i.length+e.length;if(r<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(r-s-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(a,2),o.set(i,r-s),o.set(e,r-e.length),o}We[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],We[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],We[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],We[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],We[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],We[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],We[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];var Au=Object.freeze({__proto__:null,emeDecode:xi,emeEncode:Ci,emsaEncode:ii});const jt=y.getWebCrypto(),Bt=y.getNodeCrypto(),kt=BigInt(1);async function Tn(n,e,r,t,i,s){const a=T(t),o=T(i),u=T(r);let l=F(u,o-kt),h=F(u,a-kt);return h=oe(h),l=oe(l),{kty:"RSA",n:Ae(n),e:Ae(e),d:Ae(r),p:Ae(i),q:Ae(t),dp:Ae(l),dq:Ae(h),qi:Ae(s),ext:!0}}function Ln(n,e){return{kty:"RSA",n:Ae(n),e:Ae(e),ext:!0}}function vs(n,e){return{n:$e(n.n),e:oe(e),d:$e(n.d),p:$e(n.q),q:$e(n.p),u:$e(n.qi)}}var Su=Object.freeze({__proto__:null,decrypt:async function(n,e,r,t,i,s,a,o){if(y.getNodeCrypto()&&!o)try{return await async function(u,l,h,p,f,g,d){const m=await Tn(l,h,p,f,g,d),b={key:m,format:"jwk",type:"pkcs1",padding:Bt.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Bt.privateDecrypt(b,u))}catch{throw Error("Decryption error")}}(n,e,r,t,i,s,a)}catch(u){y.printDebugError(u)}return async function(u,l,h,p,f,g,d,m){if(u=T(u),l=T(l),h=T(h),p=T(p),f=T(f),g=T(g),d=T(d),u>=l)throw Error("Data too large.");const b=F(p,g-kt),w=F(p,f-kt),v=pt(BigInt(2),l),E=le(Jt(v,l),h,l);u=F(u*E,l);const A=le(u,w,f),U=le(u,b,g);let I=F(d*(U-A),g)*f+A;return I=F(I*v,l),xi(oe(I,"be",Ke(l)),m)}(n,e,r,t,i,s,a,o)},encrypt:async function(n,e,r){return y.getNodeCrypto()?async function(t,i,s){const a=Ln(i,s),o={key:a,format:"jwk",type:"pkcs1",padding:Bt.constants.RSA_PKCS1_PADDING};return new Uint8Array(Bt.publicEncrypt(o,t))}(n,e,r):async function(t,i,s){if(i=T(i),t=T(Ci(t,Ke(i))),s=T(s),t>=i)throw Error("Message size cannot exceed modulus size");return oe(le(t,s,i),"be",Ke(i))}(n,e,r)},generate:async function(n,e){if(e=BigInt(e),y.getWebCrypto()){const a={name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:oe(e),hash:{name:"SHA-1"}},o=await jt.generateKey(a,!0,["sign","verify"]);return vs(await jt.exportKey("jwk",o.privateKey),e)}if(y.getNodeCrypto()){const a={modulusLength:n,publicExponent:ni(e),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}},o=await new Promise((u,l)=>{Bt.generateKeyPair("rsa",a,(h,p,f)=>{h?l(h):u(f)})});return vs(o,e)}let r,t,i;do t=ks(n-(n>>1),e,40),r=ks(n>>1,e,40),i=r*t;while(ir(i)!==n);const s=(r-kt)*(t-kt);return t<r&&([r,t]=[t,r]),{n:oe(i),e:oe(e),d:oe(Jt(e,s)),p:oe(r),q:oe(t),u:oe(Jt(r,t))}},sign:async function(n,e,r,t,i,s,a,o,u){if(Be.getHashByteLength(n)>=r.length)throw Error("Digest size cannot exceed key modulus size");if(e&&!y.isStream(e)){if(y.getWebCrypto())try{return await async function(l,h,p,f,g,d,m,b){const w=await Tn(p,f,g,d,m,b),v={name:"RSASSA-PKCS1-v1_5",hash:{name:l}},E=await jt.importKey("jwk",w,v,!1,["sign"]);return new Uint8Array(await jt.sign("RSASSA-PKCS1-v1_5",E,h))}(c.read(c.webHash,n),e,r,t,i,s,a,o)}catch(l){y.printDebugError(l)}else if(y.getNodeCrypto())return async function(l,h,p,f,g,d,m,b){const w=Bt.createSign(c.read(c.hash,l));w.write(h),w.end();const v=await Tn(p,f,g,d,m,b);return new Uint8Array(w.sign({key:v,format:"jwk",type:"pkcs1"}))}(n,e,r,t,i,s,a,o)}return async function(l,h,p,f){h=T(h);const g=T(ii(l,f,Ke(h)));return p=T(p),oe(le(g,p,h),"be",Ke(h))}(n,r,i,u)},validateParams:async function(n,e,r,t,i,s){if(n=T(n),(t=T(t))*(i=T(i))!==n)return!1;const a=BigInt(2);if(F(t*(s=T(s)),i)!==BigInt(1))return!1;e=T(e),r=T(r);const o=pt(a,a<<BigInt(Math.floor(ir(n)/3))),u=o*r*e;return!(F(u,t-kt)!==o||F(u,i-kt)!==o)},verify:async function(n,e,r,t,i,s){if(e&&!y.isStream(e)){if(y.getWebCrypto())try{return await async function(a,o,u,l,h){const p=Ln(l,h),f=await jt.importKey("jwk",p,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!1,["verify"]);return jt.verify("RSASSA-PKCS1-v1_5",f,u,o)}(c.read(c.webHash,n),e,r,t,i)}catch(a){y.printDebugError(a)}else if(y.getNodeCrypto())return async function(a,o,u,l,h){const p=Ln(l,h),f={key:p,format:"jwk",type:"pkcs1"},g=Bt.createVerify(c.read(c.hash,a));g.write(o),g.end();try{return g.verify(f,u)}catch{return!1}}(n,e,r,t,i)}return async function(a,o,u,l,h){if(u=T(u),o=T(o),l=T(l),o>=u)throw Error("Signature size cannot exceed modulus size");const p=oe(le(o,l,u),"be",Ke(u)),f=ii(a,h,Ke(u));return y.equalsUint8Array(p,f)}(n,r,t,i,s)}});const mt=BigInt(1);var Eu=Object.freeze({__proto__:null,decrypt:async function(n,e,r,t,i){return n=T(n),e=T(e),r=T(r),xi(oe(F(Jt(le(n,t=T(t),r),r)*e,r),"be",Ke(r)),i)},encrypt:async function(n,e,r,t){e=T(e),r=T(r),t=T(t);const i=T(Ci(n,Ke(e))),s=pt(mt,e-mt);return{c1:oe(le(r,s,e)),c2:oe(F(le(t,s,e)*i,e))}},validateParams:async function(n,e,r,t){if(n=T(n),e=T(e),r=T(r),e<=mt||e>=n)return!1;const i=BigInt(ir(n));if(i<BigInt(1023)||le(e,n-mt,n)!==mt)return!1;let s=e,a=BigInt(1);const o=BigInt(2),u=o<<BigInt(17);for(;a<u;){if(s=F(s*e,n),s===mt)return!1;a++}t=T(t);const l=pt(o<<i-mt,o<<i);return r===le(e,(n-mt)*l+t,n)}});const Mn=typeof Re=="object"&&"crypto"in Re?Re.crypto:void 0,Q={};var B=function(n){var e,r=new Float64Array(16);if(n)for(e=0;e<n.length;e++)r[e]=n[e];return r},si=function(){throw Error("no PRNG")},Wa=new Uint8Array(32);Wa[0]=9;var ai=B(),Xr=B([1]),Pu=B([56129,1]),Ku=B([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Uu=B([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),As=B([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Ss=B([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Iu=B([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Es(n,e,r,t){n[e]=r>>24&255,n[e+1]=r>>16&255,n[e+2]=r>>8&255,n[e+3]=255&r,n[e+4]=t>>24&255,n[e+5]=t>>16&255,n[e+6]=t>>8&255,n[e+7]=255&t}function Va(n,e,r,t){return function(i,s,a,o,u){var l,h=0;for(l=0;l<u;l++)h|=i[s+l]^a[o+l];return(1&h-1>>>8)-1}(n,e,r,t,32)}function Et(n,e){var r;for(r=0;r<16;r++)n[r]=0|e[r]}function Rn(n){var e,r,t=1;for(e=0;e<16;e++)r=n[e]+t+65535,t=Math.floor(r/65536),n[e]=r-65536*t;n[0]+=t-1+37*(t-1)}function Zt(n,e,r){for(var t,i=~(r-1),s=0;s<16;s++)t=i&(n[s]^e[s]),n[s]^=t,e[s]^=t}function Kr(n,e){var r,t,i,s=B(),a=B();for(r=0;r<16;r++)a[r]=e[r];for(Rn(a),Rn(a),Rn(a),t=0;t<2;t++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,Zt(a,s,1-i)}for(r=0;r<16;r++)n[2*r]=255&a[r],n[2*r+1]=a[r]>>8}function Ps(n,e){var r=new Uint8Array(32),t=new Uint8Array(32);return Kr(r,n),Kr(t,e),Va(r,0,t,0)}function Qa(n){var e=new Uint8Array(32);return Kr(e,n),1&e[0]}function Za(n,e){var r;for(r=0;r<16;r++)n[r]=e[2*r]+(e[2*r+1]<<8);n[15]&=32767}function Ze(n,e,r){for(var t=0;t<16;t++)n[t]=e[t]+r[t]}function Ye(n,e,r){for(var t=0;t<16;t++)n[t]=e[t]-r[t]}function N(n,e,r){var t,i,s=0,a=0,o=0,u=0,l=0,h=0,p=0,f=0,g=0,d=0,m=0,b=0,w=0,v=0,E=0,A=0,U=0,C=0,I=0,k=0,S=0,D=0,P=0,K=0,x=0,G=0,V=0,ce=0,je=0,rt=0,_t=0,O=r[0],J=r[1],ee=r[2],ie=r[3],H=r[4],Z=r[5],X=r[6],se=r[7],$=r[8],te=r[9],re=r[10],ae=r[11],ue=r[12],pe=r[13],fe=r[14],ge=r[15];s+=(t=e[0])*O,a+=t*J,o+=t*ee,u+=t*ie,l+=t*H,h+=t*Z,p+=t*X,f+=t*se,g+=t*$,d+=t*te,m+=t*re,b+=t*ae,w+=t*ue,v+=t*pe,E+=t*fe,A+=t*ge,a+=(t=e[1])*O,o+=t*J,u+=t*ee,l+=t*ie,h+=t*H,p+=t*Z,f+=t*X,g+=t*se,d+=t*$,m+=t*te,b+=t*re,w+=t*ae,v+=t*ue,E+=t*pe,A+=t*fe,U+=t*ge,o+=(t=e[2])*O,u+=t*J,l+=t*ee,h+=t*ie,p+=t*H,f+=t*Z,g+=t*X,d+=t*se,m+=t*$,b+=t*te,w+=t*re,v+=t*ae,E+=t*ue,A+=t*pe,U+=t*fe,C+=t*ge,u+=(t=e[3])*O,l+=t*J,h+=t*ee,p+=t*ie,f+=t*H,g+=t*Z,d+=t*X,m+=t*se,b+=t*$,w+=t*te,v+=t*re,E+=t*ae,A+=t*ue,U+=t*pe,C+=t*fe,I+=t*ge,l+=(t=e[4])*O,h+=t*J,p+=t*ee,f+=t*ie,g+=t*H,d+=t*Z,m+=t*X,b+=t*se,w+=t*$,v+=t*te,E+=t*re,A+=t*ae,U+=t*ue,C+=t*pe,I+=t*fe,k+=t*ge,h+=(t=e[5])*O,p+=t*J,f+=t*ee,g+=t*ie,d+=t*H,m+=t*Z,b+=t*X,w+=t*se,v+=t*$,E+=t*te,A+=t*re,U+=t*ae,C+=t*ue,I+=t*pe,k+=t*fe,S+=t*ge,p+=(t=e[6])*O,f+=t*J,g+=t*ee,d+=t*ie,m+=t*H,b+=t*Z,w+=t*X,v+=t*se,E+=t*$,A+=t*te,U+=t*re,C+=t*ae,I+=t*ue,k+=t*pe,S+=t*fe,D+=t*ge,f+=(t=e[7])*O,g+=t*J,d+=t*ee,m+=t*ie,b+=t*H,w+=t*Z,v+=t*X,E+=t*se,A+=t*$,U+=t*te,C+=t*re,I+=t*ae,k+=t*ue,S+=t*pe,D+=t*fe,P+=t*ge,g+=(t=e[8])*O,d+=t*J,m+=t*ee,b+=t*ie,w+=t*H,v+=t*Z,E+=t*X,A+=t*se,U+=t*$,C+=t*te,I+=t*re,k+=t*ae,S+=t*ue,D+=t*pe,P+=t*fe,K+=t*ge,d+=(t=e[9])*O,m+=t*J,b+=t*ee,w+=t*ie,v+=t*H,E+=t*Z,A+=t*X,U+=t*se,C+=t*$,I+=t*te,k+=t*re,S+=t*ae,D+=t*ue,P+=t*pe,K+=t*fe,x+=t*ge,m+=(t=e[10])*O,b+=t*J,w+=t*ee,v+=t*ie,E+=t*H,A+=t*Z,U+=t*X,C+=t*se,I+=t*$,k+=t*te,S+=t*re,D+=t*ae,P+=t*ue,K+=t*pe,x+=t*fe,G+=t*ge,b+=(t=e[11])*O,w+=t*J,v+=t*ee,E+=t*ie,A+=t*H,U+=t*Z,C+=t*X,I+=t*se,k+=t*$,S+=t*te,D+=t*re,P+=t*ae,K+=t*ue,x+=t*pe,G+=t*fe,V+=t*ge,w+=(t=e[12])*O,v+=t*J,E+=t*ee,A+=t*ie,U+=t*H,C+=t*Z,I+=t*X,k+=t*se,S+=t*$,D+=t*te,P+=t*re,K+=t*ae,x+=t*ue,G+=t*pe,V+=t*fe,ce+=t*ge,v+=(t=e[13])*O,E+=t*J,A+=t*ee,U+=t*ie,C+=t*H,I+=t*Z,k+=t*X,S+=t*se,D+=t*$,P+=t*te,K+=t*re,x+=t*ae,G+=t*ue,V+=t*pe,ce+=t*fe,je+=t*ge,E+=(t=e[14])*O,A+=t*J,U+=t*ee,C+=t*ie,I+=t*H,k+=t*Z,S+=t*X,D+=t*se,P+=t*$,K+=t*te,x+=t*re,G+=t*ae,V+=t*ue,ce+=t*pe,je+=t*fe,rt+=t*ge,A+=(t=e[15])*O,a+=38*(C+=t*ee),o+=38*(I+=t*ie),u+=38*(k+=t*H),l+=38*(S+=t*Z),h+=38*(D+=t*X),p+=38*(P+=t*se),f+=38*(K+=t*$),g+=38*(x+=t*te),d+=38*(G+=t*re),m+=38*(V+=t*ae),b+=38*(ce+=t*ue),w+=38*(je+=t*pe),v+=38*(rt+=t*fe),E+=38*(_t+=t*ge),s=(t=(s+=38*(U+=t*J))+(i=1)+65535)-65536*(i=Math.floor(t/65536)),a=(t=a+i+65535)-65536*(i=Math.floor(t/65536)),o=(t=o+i+65535)-65536*(i=Math.floor(t/65536)),u=(t=u+i+65535)-65536*(i=Math.floor(t/65536)),l=(t=l+i+65535)-65536*(i=Math.floor(t/65536)),h=(t=h+i+65535)-65536*(i=Math.floor(t/65536)),p=(t=p+i+65535)-65536*(i=Math.floor(t/65536)),f=(t=f+i+65535)-65536*(i=Math.floor(t/65536)),g=(t=g+i+65535)-65536*(i=Math.floor(t/65536)),d=(t=d+i+65535)-65536*(i=Math.floor(t/65536)),m=(t=m+i+65535)-65536*(i=Math.floor(t/65536)),b=(t=b+i+65535)-65536*(i=Math.floor(t/65536)),w=(t=w+i+65535)-65536*(i=Math.floor(t/65536)),v=(t=v+i+65535)-65536*(i=Math.floor(t/65536)),E=(t=E+i+65535)-65536*(i=Math.floor(t/65536)),A=(t=A+i+65535)-65536*(i=Math.floor(t/65536)),s=(t=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(t/65536)),a=(t=a+i+65535)-65536*(i=Math.floor(t/65536)),o=(t=o+i+65535)-65536*(i=Math.floor(t/65536)),u=(t=u+i+65535)-65536*(i=Math.floor(t/65536)),l=(t=l+i+65535)-65536*(i=Math.floor(t/65536)),h=(t=h+i+65535)-65536*(i=Math.floor(t/65536)),p=(t=p+i+65535)-65536*(i=Math.floor(t/65536)),f=(t=f+i+65535)-65536*(i=Math.floor(t/65536)),g=(t=g+i+65535)-65536*(i=Math.floor(t/65536)),d=(t=d+i+65535)-65536*(i=Math.floor(t/65536)),m=(t=m+i+65535)-65536*(i=Math.floor(t/65536)),b=(t=b+i+65535)-65536*(i=Math.floor(t/65536)),w=(t=w+i+65535)-65536*(i=Math.floor(t/65536)),v=(t=v+i+65535)-65536*(i=Math.floor(t/65536)),E=(t=E+i+65535)-65536*(i=Math.floor(t/65536)),A=(t=A+i+65535)-65536*(i=Math.floor(t/65536)),s+=i-1+37*(i-1),n[0]=s,n[1]=a,n[2]=o,n[3]=u,n[4]=l,n[5]=h,n[6]=p,n[7]=f,n[8]=g,n[9]=d,n[10]=m,n[11]=b,n[12]=w,n[13]=v,n[14]=E,n[15]=A}function He(n,e){N(n,e,e)}function Xa(n,e){var r,t=B();for(r=0;r<16;r++)t[r]=e[r];for(r=253;r>=0;r--)He(t,t),r!==2&&r!==4&&N(t,t,e);for(r=0;r<16;r++)n[r]=t[r]}function Ya(n,e,r){var t,i,s=new Uint8Array(32),a=new Float64Array(80),o=B(),u=B(),l=B(),h=B(),p=B(),f=B();for(i=0;i<31;i++)s[i]=e[i];for(s[31]=127&e[31]|64,s[0]&=248,Za(a,r),i=0;i<16;i++)u[i]=a[i],h[i]=o[i]=l[i]=0;for(o[0]=h[0]=1,i=254;i>=0;--i)Zt(o,u,t=s[i>>>3]>>>(7&i)&1),Zt(l,h,t),Ze(p,o,l),Ye(o,o,l),Ze(l,u,h),Ye(u,u,h),He(h,p),He(f,o),N(o,l,o),N(l,u,p),Ze(p,o,l),Ye(o,o,l),He(u,o),Ye(l,h,f),N(o,l,Pu),Ze(o,o,h),N(l,l,o),N(o,h,f),N(h,u,a),He(u,p),Zt(o,u,t),Zt(l,h,t);for(i=0;i<16;i++)a[i+16]=o[i],a[i+32]=l[i],a[i+48]=u[i],a[i+64]=h[i];var g=a.subarray(32),d=a.subarray(16);return Xa(g,g),N(d,d,g),Kr(n,d),0}function Ks(n,e){return Ya(n,e,Wa)}var Us=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Is(n,e,r,t){for(var i,s,a,o,u,l,h,p,f,g,d,m,b,w,v,E,A,U,C,I,k,S,D,P,K,x,G=new Int32Array(16),V=new Int32Array(16),ce=n[0],je=n[1],rt=n[2],_t=n[3],O=n[4],J=n[5],ee=n[6],ie=n[7],H=e[0],Z=e[1],X=e[2],se=e[3],$=e[4],te=e[5],re=e[6],ae=e[7],ue=0;t>=128;){for(C=0;C<16;C++)I=8*C+ue,G[C]=r[I+0]<<24|r[I+1]<<16|r[I+2]<<8|r[I+3],V[C]=r[I+4]<<24|r[I+5]<<16|r[I+6]<<8|r[I+7];for(C=0;C<80;C++)if(i=ce,s=je,a=rt,o=_t,u=O,l=J,h=ee,f=H,g=Z,d=X,m=se,b=$,w=te,v=re,D=65535&(S=ae),P=S>>>16,K=65535&(k=ie),x=k>>>16,D+=65535&(S=($>>>14|O<<18)^($>>>18|O<<14)^(O>>>9|$<<23)),P+=S>>>16,K+=65535&(k=(O>>>14|$<<18)^(O>>>18|$<<14)^($>>>9|O<<23)),x+=k>>>16,D+=65535&(S=$&te^~$&re),P+=S>>>16,K+=65535&(k=O&J^~O&ee),x+=k>>>16,k=Us[2*C],D+=65535&(S=Us[2*C+1]),P+=S>>>16,K+=65535&k,x+=k>>>16,k=G[C%16],P+=(S=V[C%16])>>>16,K+=65535&k,x+=k>>>16,K+=(P+=(D+=65535&S)>>>16)>>>16,D=65535&(S=U=65535&D|P<<16),P=S>>>16,K=65535&(k=A=65535&K|(x+=K>>>16)<<16),x=k>>>16,D+=65535&(S=(H>>>28|ce<<4)^(ce>>>2|H<<30)^(ce>>>7|H<<25)),P+=S>>>16,K+=65535&(k=(ce>>>28|H<<4)^(H>>>2|ce<<30)^(H>>>7|ce<<25)),x+=k>>>16,P+=(S=H&Z^H&X^Z&X)>>>16,K+=65535&(k=ce&je^ce&rt^je&rt),x+=k>>>16,p=65535&(K+=(P+=(D+=65535&S)>>>16)>>>16)|(x+=K>>>16)<<16,E=65535&D|P<<16,D=65535&(S=m),P=S>>>16,K=65535&(k=o),x=k>>>16,P+=(S=U)>>>16,K+=65535&(k=A),x+=k>>>16,je=i,rt=s,_t=a,O=o=65535&(K+=(P+=(D+=65535&S)>>>16)>>>16)|(x+=K>>>16)<<16,J=u,ee=l,ie=h,ce=p,Z=f,X=g,se=d,$=m=65535&D|P<<16,te=b,re=w,ae=v,H=E,C%16==15)for(I=0;I<16;I++)k=G[I],D=65535&(S=V[I]),P=S>>>16,K=65535&k,x=k>>>16,k=G[(I+9)%16],D+=65535&(S=V[(I+9)%16]),P+=S>>>16,K+=65535&k,x+=k>>>16,A=G[(I+1)%16],D+=65535&(S=((U=V[(I+1)%16])>>>1|A<<31)^(U>>>8|A<<24)^(U>>>7|A<<25)),P+=S>>>16,K+=65535&(k=(A>>>1|U<<31)^(A>>>8|U<<24)^A>>>7),x+=k>>>16,A=G[(I+14)%16],P+=(S=((U=V[(I+14)%16])>>>19|A<<13)^(A>>>29|U<<3)^(U>>>6|A<<26))>>>16,K+=65535&(k=(A>>>19|U<<13)^(U>>>29|A<<3)^A>>>6),x+=k>>>16,x+=(K+=(P+=(D+=65535&S)>>>16)>>>16)>>>16,G[I]=65535&K|x<<16,V[I]=65535&D|P<<16;D=65535&(S=H),P=S>>>16,K=65535&(k=ce),x=k>>>16,k=n[0],P+=(S=e[0])>>>16,K+=65535&k,x+=k>>>16,x+=(K+=(P+=(D+=65535&S)>>>16)>>>16)>>>16,n[0]=ce=65535&K|x<<16,e[0]=H=65535&D|P<<16,D=65535&(S=Z),P=S>>>16,K=65535&(k=je),x=k>>>16,k=n[1],P+=(S=e[1])>>>16,K+=65535&k,x+=k>>>16,x+=(K+=(P+=(D+=65535&S)>>>16)>>>16)>>>16,n[1]=je=65535&K|x<<16,e[1]=Z=65535&D|P<<16,D=65535&(S=X),P=S>>>16,K=65535&(k=rt),x=k>>>16,k=n[2],P+=(S=e[2])>>>16,K+=65535&k,x+=k>>>16,x+=(K+=(P+=(D+=65535&S)>>>16)>>>16)>>>16,n[2]=rt=65535&K|x<<16,e[2]=X=65535&D|P<<16,D=65535&(S=se),P=S>>>16,K=65535&(k=_t),x=k>>>16,k=n[3],P+=(S=e[3])>>>16,K+=65535&k,x+=k>>>16,x+=(K+=(P+=(D+=65535&S)>>>16)>>>16)>>>16,n[3]=_t=65535&K|x<<16,e[3]=se=65535&D|P<<16,D=65535&(S=$),P=S>>>16,K=65535&(k=O),x=k>>>16,k=n[4],P+=(S=e[4])>>>16,K+=65535&k,x+=k>>>16,x+=(K+=(P+=(D+=65535&S)>>>16)>>>16)>>>16,n[4]=O=65535&K|x<<16,e[4]=$=65535&D|P<<16,D=65535&(S=te),P=S>>>16,K=65535&(k=J),x=k>>>16,k=n[5],P+=(S=e[5])>>>16,K+=65535&k,x+=k>>>16,x+=(K+=(P+=(D+=65535&S)>>>16)>>>16)>>>16,n[5]=J=65535&K|x<<16,e[5]=te=65535&D|P<<16,D=65535&(S=re),P=S>>>16,K=65535&(k=ee),x=k>>>16,k=n[6],P+=(S=e[6])>>>16,K+=65535&k,x+=k>>>16,x+=(K+=(P+=(D+=65535&S)>>>16)>>>16)>>>16,n[6]=ee=65535&K|x<<16,e[6]=re=65535&D|P<<16,D=65535&(S=ae),P=S>>>16,K=65535&(k=ie),x=k>>>16,k=n[7],P+=(S=e[7])>>>16,K+=65535&k,x+=k>>>16,x+=(K+=(P+=(D+=65535&S)>>>16)>>>16)>>>16,n[7]=ie=65535&K|x<<16,e[7]=ae=65535&D|P<<16,ue+=128,t-=128}return t}function wr(n,e,r){var t,i=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,Is(i,s,e,r),r%=128,t=0;t<r;t++)a[t]=e[o-r+t];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,Es(a,r-8,o/536870912|0,o<<3),Is(i,s,a,r),t=0;t<8;t++)Es(n,8*t,i[t],s[t]);return 0}function oi(n,e){var r=B(),t=B(),i=B(),s=B(),a=B(),o=B(),u=B(),l=B(),h=B();Ye(r,n[1],n[0]),Ye(h,e[1],e[0]),N(r,r,h),Ze(t,n[0],n[1]),Ze(h,e[0],e[1]),N(t,t,h),N(i,n[3],e[3]),N(i,i,Uu),N(s,n[2],e[2]),Ze(s,s,s),Ye(a,t,r),Ye(o,s,i),Ze(u,s,i),Ze(l,t,r),N(n[0],a,o),N(n[1],l,u),N(n[2],u,o),N(n[3],a,l)}function Ds(n,e,r){var t;for(t=0;t<4;t++)Zt(n[t],e[t],r)}function ci(n,e){var r=B(),t=B(),i=B();Xa(i,e[2]),N(r,e[0],i),N(t,e[1],i),Kr(n,t),n[31]^=Qa(r)<<7}function Ja(n,e,r){var t,i;for(Et(n[0],ai),Et(n[1],Xr),Et(n[2],Xr),Et(n[3],ai),i=255;i>=0;--i)Ds(n,e,t=r[i/8|0]>>(7&i)&1),oi(e,n),oi(n,n),Ds(n,e,t)}function ui(n,e){var r=[B(),B(),B(),B()];Et(r[0],As),Et(r[1],Ss),Et(r[2],Xr),N(r[3],As,Ss),Ja(n,r,e)}function Cs(n,e,r){var t,i=new Uint8Array(64),s=[B(),B(),B(),B()];for(r||si(e,32),wr(i,e,32),i[0]&=248,i[31]&=127,i[31]|=64,ui(s,i),ci(n,s),t=0;t<32;t++)e[t+32]=n[t];return 0}var Fn=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function eo(n,e){var r,t,i,s;for(t=63;t>=32;--t){for(r=0,i=t-32,s=t-12;i<s;++i)e[i]+=r-16*e[t]*Fn[i-(t-32)],r=Math.floor((e[i]+128)/256),e[i]-=256*r;e[i]+=r,e[t]=0}for(r=0,i=0;i<32;i++)e[i]+=r-(e[31]>>4)*Fn[i],r=e[i]>>8,e[i]&=255;for(i=0;i<32;i++)e[i]-=r*Fn[i];for(t=0;t<32;t++)e[t+1]+=e[t]>>8,n[t]=255&e[t]}function Nn(n){var e,r=new Float64Array(64);for(e=0;e<64;e++)r[e]=n[e];for(e=0;e<64;e++)n[e]=0;eo(n,r)}function Du(n,e){var r=B(),t=B(),i=B(),s=B(),a=B(),o=B(),u=B();return Et(n[2],Xr),Za(n[1],e),He(i,n[1]),N(s,i,Ku),Ye(i,i,n[2]),Ze(s,n[2],s),He(a,s),He(o,a),N(u,o,a),N(r,u,i),N(r,r,s),function(l,h){var p,f=B();for(p=0;p<16;p++)f[p]=h[p];for(p=250;p>=0;p--)He(f,f),p!==1&&N(f,f,h);for(p=0;p<16;p++)l[p]=f[p]}(r,r),N(r,r,i),N(r,r,s),N(r,r,s),N(n[0],r,s),He(t,n[0]),N(t,t,s),Ps(t,i)&&N(n[0],n[0],Iu),He(t,n[0]),N(t,t,s),Ps(t,i)?-1:(Qa(n[0])===e[31]>>7&&Ye(n[0],ai,n[0]),N(n[3],n[0],n[1]),0)}var Tt=64;function qt(){for(var n=0;n<arguments.length;n++)if(!(arguments[n]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}Q.scalarMult=function(n,e){if(qt(n,e),n.length!==32)throw Error("bad n size");if(e.length!==32)throw Error("bad p size");var r=new Uint8Array(32);return Ya(r,n,e),r},Q.box={},Q.box.keyPair=function(){var n=new Uint8Array(32),e=new Uint8Array(32);return function(r,t){si(t,32),Ks(r,t)}(n,e),{publicKey:n,secretKey:e}},Q.box.keyPair.fromSecretKey=function(n){if(qt(n),n.length!==32)throw Error("bad secret key size");var e=new Uint8Array(32);return Ks(e,n),{publicKey:e,secretKey:new Uint8Array(n)}},Q.sign=function(n,e){if(qt(n,e),e.length!==64)throw Error("bad secret key size");var r=new Uint8Array(Tt+n.length);return function(t,i,s,a){var o,u,l=new Uint8Array(64),h=new Uint8Array(64),p=new Uint8Array(64),f=new Float64Array(64),g=[B(),B(),B(),B()];for(wr(l,a,32),l[0]&=248,l[31]&=127,l[31]|=64,o=0;o<s;o++)t[64+o]=i[o];for(o=0;o<32;o++)t[32+o]=l[32+o];for(wr(p,t.subarray(32),s+32),Nn(p),ui(g,p),ci(t,g),o=32;o<64;o++)t[o]=a[o];for(wr(h,t,s+64),Nn(h),o=0;o<64;o++)f[o]=0;for(o=0;o<32;o++)f[o]=p[o];for(o=0;o<32;o++)for(u=0;u<32;u++)f[o+u]+=h[o]*l[u];eo(t.subarray(32),f)}(r,n,n.length,e),r},Q.sign.detached=function(n,e){for(var r=Q.sign(n,e),t=new Uint8Array(Tt),i=0;i<t.length;i++)t[i]=r[i];return t},Q.sign.detached.verify=function(n,e,r){if(qt(n,e,r),e.length!==Tt)throw Error("bad signature size");if(r.length!==32)throw Error("bad public key size");var t,i=new Uint8Array(Tt+n.length),s=new Uint8Array(Tt+n.length);for(t=0;t<Tt;t++)i[t]=e[t];for(t=0;t<n.length;t++)i[t+Tt]=n[t];return function(a,o,u,l){var h,p=new Uint8Array(32),f=new Uint8Array(64),g=[B(),B(),B(),B()],d=[B(),B(),B(),B()];if(u<64||Du(d,l))return-1;for(h=0;h<u;h++)a[h]=o[h];for(h=0;h<32;h++)a[h+32]=l[h];if(wr(f,a,u),Nn(f),Ja(g,d,f),ui(d,o.subarray(32)),oi(g,d),ci(p,g),u-=64,Va(o,0,p,0)){for(h=0;h<u;h++)a[h]=0;return-1}for(h=0;h<u;h++)a[h]=o[h+64];return u}(s,i,i.length,r)>=0},Q.sign.keyPair=function(){var n=new Uint8Array(32),e=new Uint8Array(64);return Cs(n,e),{publicKey:n,secretKey:e}},Q.sign.keyPair.fromSecretKey=function(n){if(qt(n),n.length!==64)throw Error("bad secret key size");for(var e=new Uint8Array(32),r=0;r<e.length;r++)e[r]=n[32+r];return{publicKey:e,secretKey:new Uint8Array(n)}},Q.sign.keyPair.fromSeed=function(n){if(qt(n),n.length!==32)throw Error("bad seed size");for(var e=new Uint8Array(32),r=new Uint8Array(64),t=0;t<32;t++)r[t]=n[t];return Cs(e,r,!0),{publicKey:e,secretKey:r}},Q.setPRNG=function(n){si=n},function(){Mn&&Mn.getRandomValues&&Q.setPRNG(function(n,e){var r,t=new Uint8Array(e);for(r=0;r<e;r+=65536)Mn.getRandomValues(t.subarray(r,r+Math.min(e-r,65536)));for(r=0;r<e;r++)n[r]=t[r];(function(i){for(var s=0;s<i.length;s++)i[s]=0})(t)})}();const Cu={"2a8648ce3d030107":c.curve.nistP256,"2b81040022":c.curve.nistP384,"2b81040023":c.curve.nistP521,"2b8104000a":c.curve.secp256k1,"2b06010401da470f01":c.curve.ed25519Legacy,"2b060104019755010501":c.curve.curve25519Legacy,"2b2403030208010107":c.curve.brainpoolP256r1,"2b240303020801010b":c.curve.brainpoolP384r1,"2b240303020801010d":c.curve.brainpoolP512r1};class ot{constructor(e){if(e instanceof ot)this.oid=e.oid;else if(y.isArray(e)||y.isUint8Array(e)){if((e=new Uint8Array(e))[0]===6){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){const r=e[0];if(e.length>=1+r)return this.oid=e.subarray(1,1+r),1+this.oid.length}throw Error("Invalid oid")}write(){return y.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return y.uint8ArrayToHex(this.oid)}getName(){const e=Cu[this.toHex()];if(!e)throw Error("Unknown curve object identifier.");return e}}function to(n){let e,r=0;const t=n[0];return t<192?([r]=n,e=1):t<255?(r=(n[0]-192<<8)+n[1]+192,e=2):t===255&&(r=y.readNumber(n.subarray(1,5)),e=5),{len:r,offset:e}}function mn(n){return n<192?new Uint8Array([n]):n>191&&n<8384?new Uint8Array([192+(n-192>>8),n-192&255]):y.concatUint8Array([new Uint8Array([255]),y.writeNumber(n,4)])}function xu(n){if(n<0||n>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+n])}function Yr(n){return new Uint8Array([192|n])}function xs(n,e){return y.concatUint8Array([Yr(n),mn(e)])}function zr(n){return[c.packet.literalData,c.packet.compressedData,c.packet.symmetricallyEncryptedData,c.packet.symEncryptedIntegrityProtectedData,c.packet.aeadEncryptedData].includes(n)}async function Bu(n,e){const r=ar(n);let t,i;try{const s=await r.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await r.readByte();let o,u,l=-1,h=-1;h=0,64&a&&(h=1),h?l=63&a:(l=(63&a)>>2,u=3&a);const p=zr(l);let f,g=null;if(p){if(y.isStream(n)==="array"){const m=new Fe;t=tt(m),g=m}else{const m=new TransformStream;t=tt(m.writable),g=m.readable}i=e({tag:l,packet:g})}else g=[];do{if(h){const m=await r.readByte();if(f=!1,m<192)o=m;else if(m>=192&&m<224)o=(m-192<<8)+await r.readByte()+192;else if(m>223&&m<255){if(o=1<<(31&m),f=!0,!p)throw new TypeError("This packet type does not support partial lengths.")}else o=await r.readByte()<<24|await r.readByte()<<16|await r.readByte()<<8|await r.readByte()}else switch(u){case 0:o=await r.readByte();break;case 1:o=await r.readByte()<<8|await r.readByte();break;case 2:o=await r.readByte()<<24|await r.readByte()<<16|await r.readByte()<<8|await r.readByte();break;default:o=1/0}if(o>0){let m=0;for(;;){t&&await t.ready;const{done:b,value:w}=await r.read();if(b){if(o===1/0)break;throw Error("Unexpected end of packet")}const v=o===1/0?w:w.subarray(0,o-m);if(t?await t.write(v):g.push(v),m+=w.length,m>=o){r.unshift(w.subarray(o-m+w.length));break}}}}while(f);const d=await r.peekBytes(p?1/0:2);return t?(await t.ready,await t.close()):(g=y.concatUint8Array(g),await e({tag:l,packet:g})),!d||!d.length}catch(s){if(t)return await t.abort(s),!0;throw s}finally{t&&await i,r.releaseLock()}}class Y extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Y),this.name="UnsupportedError"}}class ro extends Y{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Y),this.name="UnknownPacketError"}}class li{constructor(e,r){this.tag=e,this.rawContent=r}write(){return this.rawContent}}async function no(n){switch(n){case c.publicKey.ed25519:try{const e=y.getWebCrypto(),r=await e.generateKey("Ed25519",!0,["sign","verify"]),t=await e.exportKey("jwk",r.privateKey),i=await e.exportKey("jwk",r.publicKey);return{A:new Uint8Array($e(i.x)),seed:$e(t.d)}}catch(e){if(e.name!=="NotSupportedError"&&e.name!=="OperationError")throw e;const r=yt(ao(n)),{publicKey:t}=Q.sign.keyPair.fromSeed(r);return{A:t,seed:r}}case c.publicKey.ed448:{const e=await y.getNobleCurve(c.publicKey.ed448),r=e.utils.randomPrivateKey();return{A:e.getPublicKey(r),seed:r}}default:throw Error("Unsupported EdDSA algorithm")}}async function io(n,e,r,t,i,s){if(Be.getHashByteLength(e)<Be.getHashByteLength(Bi(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case c.publicKey.ed25519:try{const a=y.getWebCrypto(),o=Tu(n,t,i),u=await a.importKey("jwk",o,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await a.sign("Ed25519",u,s))}}catch(a){if(a.name!=="NotSupportedError")throw a;const o=y.concatUint8Array([i,t]);return{RS:Q.sign.detached(s,o)}}case c.publicKey.ed448:return{RS:(await y.getNobleCurve(c.publicKey.ed448)).sign(s,i)};default:throw Error("Unsupported EdDSA algorithm")}}async function so(n,e,{RS:r},t,i,s){if(Be.getHashByteLength(e)<Be.getHashByteLength(Bi(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case c.publicKey.ed25519:try{const a=y.getWebCrypto(),o=oo(n,i),u=await a.importKey("jwk",o,"Ed25519",!1,["verify"]);return await a.verify("Ed25519",u,r,s)}catch(a){if(a.name!=="NotSupportedError")throw a;return Q.sign.detached.verify(s,r,i)}case c.publicKey.ed448:return(await y.getNobleCurve(c.publicKey.ed448)).verify(r,s,i);default:throw Error("Unsupported EdDSA algorithm")}}function ao(n){switch(n){case c.publicKey.ed25519:return 32;case c.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function Bi(n){switch(n){case c.publicKey.ed25519:return c.hash.sha256;case c.publicKey.ed448:return c.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const oo=(n,e)=>{if(n===c.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:Ae(e),ext:!0};throw Error("Unsupported EdDSA algorithm")},Tu=(n,e,r)=>{if(n===c.publicKey.ed25519){const t=oo(n,e);return t.d=Ae(r),t}throw Error("Unsupported EdDSA algorithm")};var Lu=Object.freeze({__proto__:null,generate:no,getPayloadSize:ao,getPreferredHashAlgo:Bi,sign:io,validateParams:async function(n,e,r){switch(n){case c.publicKey.ed25519:{const{publicKey:t}=Q.sign.keyPair.fromSeed(r);return y.equalsUint8Array(e,t)}case c.publicKey.ed448:{const t=(await y.getNobleCurve(c.publicKey.ed448)).getPublicKey(r);return y.equalsUint8Array(e,t)}default:return!1}},verify:so});const er=y.getWebCrypto();async function Jr(n,e,r){const{keySize:t}=ke(n);if(!y.isAES(n)||e.length!==t)throw Error("Unexpected algorithm or key size");try{const i=await er.importKey("raw",e,{name:"AES-KW"},!1,["wrapKey"]),s=await er.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),a=await er.wrapKey("raw",s,i,{name:"AES-KW"});return new Uint8Array(a)}catch(i){if(i.name!=="NotSupportedError"&&(e.length!==24||i.name!=="OperationError"))throw i;y.printDebugError("Browser did not support operation: "+i.message)}return ja(e).encrypt(r)}async function en(n,e,r){const{keySize:t}=ke(n);if(!y.isAES(n)||e.length!==t)throw Error("Unexpected algorithm or key size");let i;try{i=await er.importKey("raw",e,{name:"AES-KW"},!1,["unwrapKey"])}catch(s){if(s.name!=="NotSupportedError"&&(e.length!==24||s.name!=="OperationError"))throw s;return y.printDebugError("Browser did not support operation: "+s.message),ja(e).decrypt(r)}try{const s=await er.unwrapKey("raw",r,i,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await er.exportKey("raw",s))}catch(s){throw s.name==="OperationError"?Error("Key Data Integrity failed"):s}}var Mu=Object.freeze({__proto__:null,unwrap:en,wrap:Jr});const Bs=y.getWebCrypto();async function br(n,e,r,t,i){const s=c.read(c.webHash,n);if(!s)throw Error("Hash algo not supported with HKDF");const a=await Bs.importKey("raw",e,"HKDF",!1,["deriveBits"]),o=await Bs.deriveBits({name:"HKDF",hash:s,salt:r,info:t},a,8*i);return new Uint8Array(o)}const Mr={x25519:y.encodeUTF8("OpenPGP X25519"),x448:y.encodeUTF8("OpenPGP X448")};async function co(n){switch(n){case c.publicKey.x25519:{const e=yt(32),{publicKey:r}=Q.box.keyPair.fromSecretKey(e);return{A:r,k:e}}case c.publicKey.x448:{const e=await y.getNobleCurve(c.publicKey.x448),r=e.utils.randomPrivateKey();return{A:e.getPublicKey(r),k:r}}default:throw Error("Unsupported ECDH algorithm")}}function uo(n){switch(n){case c.publicKey.x25519:return 32;case c.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function hi(n,e){switch(n){case c.publicKey.x25519:{const r=yt(uo(n)),t=Q.scalarMult(r,e);tn(t);const{publicKey:i}=Q.box.keyPair.fromSecretKey(r);return{ephemeralPublicKey:i,sharedSecret:t}}case c.publicKey.x448:{const r=await y.getNobleCurve(c.publicKey.x448),t=r.utils.randomPrivateKey(),i=r.getSharedSecret(t,e);return tn(i),{ephemeralPublicKey:r.getPublicKey(t),sharedSecret:i}}default:throw Error("Unsupported ECDH algorithm")}}async function yi(n,e,r,t){switch(n){case c.publicKey.x25519:{const i=Q.scalarMult(t,e);return tn(i),i}case c.publicKey.x448:{const i=(await y.getNobleCurve(c.publicKey.x448)).getSharedSecret(t,e);return tn(i),i}default:throw Error("Unsupported ECDH algorithm")}}function tn(n){let e=0;for(let r=0;r<n.length;r++)e|=n[r];if(e===0)throw Error("Unexpected low order point")}var Ru=Object.freeze({__proto__:null,decrypt:async function(n,e,r,t,i){const s=await yi(n,e,t,i),a=y.concatUint8Array([e,t,s]);switch(n){case c.publicKey.x25519:{const o=c.symmetric.aes128,{keySize:u}=ke(o);return en(o,await br(c.hash.sha256,a,new Uint8Array,Mr.x25519,u),r)}case c.publicKey.x448:{const o=c.symmetric.aes256,{keySize:u}=ke(c.symmetric.aes256);return en(o,await br(c.hash.sha512,a,new Uint8Array,Mr.x448,u),r)}default:throw Error("Unsupported ECDH algorithm")}},encrypt:async function(n,e,r){const{ephemeralPublicKey:t,sharedSecret:i}=await hi(n,r),s=y.concatUint8Array([t,r,i]);switch(n){case c.publicKey.x25519:{const a=c.symmetric.aes128,{keySize:o}=ke(a),u=await br(c.hash.sha256,s,new Uint8Array,Mr.x25519,o);return{ephemeralPublicKey:t,wrappedKey:await Jr(a,u,e)}}case c.publicKey.x448:{const a=c.symmetric.aes256,{keySize:o}=ke(c.symmetric.aes256),u=await br(c.hash.sha512,s,new Uint8Array,Mr.x448,o);return{ephemeralPublicKey:t,wrappedKey:await Jr(a,u,e)}}default:throw Error("Unsupported ECDH algorithm")}},generate:co,generateEphemeralEncryptionMaterial:hi,getPayloadSize:uo,recomputeSharedSecret:yi,validateParams:async function(n,e,r){switch(n){case c.publicKey.x25519:{const{publicKey:t}=Q.box.keyPair.fromSecretKey(r);return y.equalsUint8Array(e,t)}case c.publicKey.x448:{const t=(await y.getNobleCurve(c.publicKey.x448)).getPublicKey(r);return y.equalsUint8Array(e,t)}default:return!1}}});const On=y.getWebCrypto(),rn=y.getNodeCrypto(),et={[c.curve.nistP256]:"P-256",[c.curve.nistP384]:"P-384",[c.curve.nistP521]:"P-521"},it=rn?rn.getCurves():[],Ve=rn?{[c.curve.secp256k1]:it.includes("secp256k1")?"secp256k1":void 0,[c.curve.nistP256]:it.includes("prime256v1")?"prime256v1":void 0,[c.curve.nistP384]:it.includes("secp384r1")?"secp384r1":void 0,[c.curve.nistP521]:it.includes("secp521r1")?"secp521r1":void 0,[c.curve.ed25519Legacy]:it.includes("ED25519")?"ED25519":void 0,[c.curve.curve25519Legacy]:it.includes("X25519")?"X25519":void 0,[c.curve.brainpoolP256r1]:it.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[c.curve.brainpoolP384r1]:it.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[c.curve.brainpoolP512r1]:it.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},lo={[c.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:c.publicKey.ecdsa,hash:c.hash.sha256,cipher:c.symmetric.aes128,node:Ve[c.curve.nistP256],web:et[c.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[c.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:c.publicKey.ecdsa,hash:c.hash.sha384,cipher:c.symmetric.aes192,node:Ve[c.curve.nistP384],web:et[c.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[c.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:c.publicKey.ecdsa,hash:c.hash.sha512,cipher:c.symmetric.aes256,node:Ve[c.curve.nistP521],web:et[c.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[c.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:c.publicKey.ecdsa,hash:c.hash.sha256,cipher:c.symmetric.aes128,node:Ve[c.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[c.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:c.publicKey.eddsaLegacy,hash:c.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[c.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:c.publicKey.ecdh,hash:c.hash.sha256,cipher:c.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[c.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:c.publicKey.ecdsa,hash:c.hash.sha256,cipher:c.symmetric.aes128,node:Ve[c.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[c.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:c.publicKey.ecdsa,hash:c.hash.sha384,cipher:c.symmetric.aes192,node:Ve[c.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[c.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:c.publicKey.ecdsa,hash:c.hash.sha512,cipher:c.symmetric.aes256,node:Ve[c.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class ft{constructor(e){try{this.name=e instanceof ot?e.getName():c.write(c.curve,e)}catch{throw new Y("Unknown curve")}const r=lo[this.name];this.keyType=r.keyType,this.oid=r.oid,this.hash=r.hash,this.cipher=r.cipher,this.node=r.node,this.web=r.web,this.payloadSize=r.payloadSize,this.sharedSize=r.sharedSize,this.wireFormatLeadingByte=r.wireFormatLeadingByte,this.web&&y.getWebCrypto()?this.type="web":this.node&&y.getNodeCrypto()?this.type="node":this.name===c.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===c.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await async function(e,r){const t=await On.generateKey({name:"ECDSA",namedCurve:et[e]},!0,["sign","verify"]),i=await On.exportKey("jwk",t.privateKey),s=await On.exportKey("jwk",t.publicKey);return{publicKey:yo(s,r),privateKey:$e(i.d)}}(this.name,this.wireFormatLeadingByte)}catch(e){return y.printDebugError("Browser did not support generating ec key "+e.message),Ts(this.name)}case"node":return async function(e){const r=rn.createECDH(Ve[e]);return await r.generateKeys(),{publicKey:new Uint8Array(r.getPublicKey()),privateKey:new Uint8Array(r.getPrivateKey())}}(this.name);case"curve25519Legacy":{const{k:e,A:r}=await co(c.publicKey.x25519),t=e.slice().reverse();return t[0]=127&t[0]|64,t[31]&=248,{publicKey:y.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),r]),privateKey:t}}case"ed25519Legacy":{const{seed:e,A:r}=await no(c.publicKey.ed25519);return{publicKey:y.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),r]),privateKey:e}}default:return Ts(this.name)}}}async function ho(n,e,r,t){const i={[c.curve.nistP256]:!0,[c.curve.nistP384]:!0,[c.curve.nistP521]:!0,[c.curve.secp256k1]:!0,[c.curve.curve25519Legacy]:n===c.publicKey.ecdh,[c.curve.brainpoolP256r1]:!0,[c.curve.brainpoolP384r1]:!0,[c.curve.brainpoolP512r1]:!0},s=e.getName();if(!i[s])return!1;if(s===c.curve.curve25519Legacy){t=t.slice().reverse();const{publicKey:o}=Q.box.keyPair.fromSecretKey(t);r=new Uint8Array(r);const u=new Uint8Array([64,...o]);return!!y.equalsUint8Array(u,r)}const a=(await y.getNobleCurve(c.publicKey.ecdsa,s)).getPublicKey(t,!1);return!!y.equalsUint8Array(a,r)}function Nt(n,e){const{payloadSize:r,wireFormatLeadingByte:t,name:i}=n,s=i===c.curve.curve25519Legacy||i===c.curve.ed25519Legacy?r:2*r;if(e[0]!==t||e.length!==s+1)throw Error("Invalid point encoding")}async function Ts(n){const e=await y.getNobleCurve(c.publicKey.ecdsa,n),r=e.utils.randomPrivateKey();return{publicKey:e.getPublicKey(r,!1),privateKey:r}}function yo(n,e){const r=$e(n.x),t=$e(n.y),i=new Uint8Array(r.length+t.length+1);return i[0]=e,i.set(r,1),i.set(t,r.length+1),i}function wn(n,e,r){const t=n,i=r.slice(1,t+1),s=r.slice(t+1,2*t+1);return{kty:"EC",crv:e,x:Ae(i),y:Ae(s),ext:!0}}function po(n,e,r,t){const i=wn(n,e,r);return i.d=Ae(t),i}const nn=y.getWebCrypto(),fo=y.getNodeCrypto();async function Ls(n,e,r,t,i,s){const a=new ft(n);if(Nt(a,t),r&&!y.isStream(r)){const u={publicKey:t,privateKey:i};switch(a.type){case"web":try{return await async function(l,h,p,f){const g=l.payloadSize,d=po(l.payloadSize,et[l.name],f.publicKey,f.privateKey),m=await nn.importKey("jwk",d,{name:"ECDSA",namedCurve:et[l.name],hash:{name:c.read(c.webHash,l.hash)}},!1,["sign"]),b=new Uint8Array(await nn.sign({name:"ECDSA",namedCurve:et[l.name],hash:{name:c.read(c.webHash,h)}},m,p));return{r:b.slice(0,g),s:b.slice(g,g<<1)}}(a,e,r,u)}catch(l){if(a.name!=="nistP521"&&(l.name==="DataError"||l.name==="OperationError"))throw l;y.printDebugError("Browser did not support signing: "+l.message)}break;case"node":return async function(l,h,p,f){const g=y.nodeRequire("eckey-utils"),d=y.getNodeBuffer(),{privateKey:m}=g.generateDer({curveName:Ve[l.name],privateKey:d.from(f)}),b=fo.createSign(c.read(c.hash,h));b.write(p),b.end();const w=new Uint8Array(b.sign({key:m,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),v=l.payloadSize;return{r:w.subarray(0,v),s:w.subarray(v,v<<1)}}(a,e,r,i)}}const o=(await y.getNobleCurve(c.publicKey.ecdsa,a.name)).sign(s,i,{lowS:!1});return{r:oe(o.r,"be",a.payloadSize),s:oe(o.s,"be",a.payloadSize)}}async function Ms(n,e,r,t,i,s){const a=new ft(n);Nt(a,i);const o=async()=>s[0]===0&&Rs(a,r,s.subarray(1),i);if(t&&!y.isStream(t))switch(a.type){case"web":try{return await async function(l,h,{r:p,s:f},g,d){const m=wn(l.payloadSize,et[l.name],d),b=await nn.importKey("jwk",m,{name:"ECDSA",namedCurve:et[l.name],hash:{name:c.read(c.webHash,l.hash)}},!1,["verify"]),w=y.concatUint8Array([p,f]).buffer;return nn.verify({name:"ECDSA",namedCurve:et[l.name],hash:{name:c.read(c.webHash,h)}},b,w,g)}(a,e,r,t,i)||o()}catch(u){if(a.name!=="nistP521"&&(u.name==="DataError"||u.name==="OperationError"))throw u;y.printDebugError("Browser did not support verifying: "+u.message)}break;case"node":return await async function(l,h,{r:p,s:f},g,d){const m=y.nodeRequire("eckey-utils"),b=y.getNodeBuffer(),{publicKey:w}=m.generateDer({curveName:Ve[l.name],publicKey:b.from(d)}),v=fo.createVerify(c.read(c.hash,h));v.write(g),v.end();const E=y.concatUint8Array([p,f]);try{return v.verify({key:w,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},E)}catch{return!1}}(a,e,r,t,i)||o()}return await Rs(a,r,s,i)||o()}async function Rs(n,e,r,t){return(await y.getNobleCurve(c.publicKey.ecdsa,n.name)).verify(y.concatUint8Array([e.r,e.s]),r,t,{lowS:!1})}var Fu=Object.freeze({__proto__:null,sign:Ls,validateParams:async function(n,e,r){const t=new ft(n);if(t.keyType!==c.publicKey.ecdsa)return!1;switch(t.type){case"web":case"node":{const i=yt(8),s=c.hash.sha256,a=await Be.digest(s,i);try{const o=await Ls(n,s,i,e,r,a);return await Ms(n,s,o,i,e,a)}catch{return!1}}default:return ho(c.publicKey.ecdsa,n,e,r)}},verify:Ms}),Nu=Object.freeze({__proto__:null,sign:async function(n,e,r,t,i,s){if(Nt(new ft(n),t),Be.getHashByteLength(e)<Be.getHashByteLength(c.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await io(c.publicKey.ed25519,e,0,t.subarray(1),i,s);return{r:a.subarray(0,32),s:a.subarray(32)}},validateParams:async function(n,e,r){if(n.getName()!==c.curve.ed25519Legacy)return!1;const{publicKey:t}=Q.sign.keyPair.fromSeed(r),i=new Uint8Array([64,...t]);return y.equalsUint8Array(e,i)},verify:async function(n,e,{r,s:t},i,s,a){if(Nt(new ft(n),s),Be.getHashByteLength(e)<Be.getHashByteLength(c.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=y.concatUint8Array([r,t]);return so(c.publicKey.ed25519,e,{RS:o},0,s.subarray(1),a)}});function go(n){const e=8-n.length%8,r=new Uint8Array(n.length+e).fill(e);return r.set(n),r}function mo(n){const e=n.length;if(e>0){const r=n[e-1];if(r>=1){const t=n.subarray(e-r),i=new Uint8Array(r).fill(r);if(y.equalsUint8Array(t,i))return n.subarray(0,e-r)}}throw Error("Invalid padding")}var Ou=Object.freeze({__proto__:null,decode:mo,encode:go});const Pt=y.getWebCrypto(),wo=y.getNodeCrypto();function Fs(n,e,r,t){return y.concatUint8Array([e.write(),new Uint8Array([n]),r.write(),y.stringToUint8Array("Anonymous Sender    "),t])}async function Ns(n,e,r,t,i=!1,s=!1){let a;if(i){for(a=0;a<e.length&&e[a]===0;a++);e=e.subarray(a)}if(s){for(a=e.length-1;a>=0&&e[a]===0;a--);e=e.subarray(0,a+1)}return(await Be.digest(n,y.concatUint8Array([new Uint8Array([0,0,0,1]),e,t]))).subarray(0,r)}async function Hu(n,e){switch(n.type){case"curve25519Legacy":{const{sharedSecret:r,ephemeralPublicKey:t}=await hi(c.publicKey.x25519,e.subarray(1));return{publicKey:y.concatUint8Array([new Uint8Array([n.wireFormatLeadingByte]),t]),sharedKey:r}}case"web":if(n.web&&y.getWebCrypto())try{return await async function(r,t){const i=wn(r.payloadSize,r.web,t);let s=Pt.generateKey({name:"ECDH",namedCurve:r.web},!0,["deriveKey","deriveBits"]),a=Pt.importKey("jwk",i,{name:"ECDH",namedCurve:r.web},!1,[]);[s,a]=await Promise.all([s,a]);let o=Pt.deriveBits({name:"ECDH",namedCurve:r.web,public:a},s.privateKey,r.sharedSize),u=Pt.exportKey("jwk",s.publicKey);[o,u]=await Promise.all([o,u]);const l=new Uint8Array(o);return{publicKey:new Uint8Array(yo(u,r.wireFormatLeadingByte)),sharedKey:l}}(n,e)}catch(r){return y.printDebugError(r),Hs(n,e)}break;case"node":return async function(r,t){const i=wo.createECDH(r.node);i.generateKeys();const s=new Uint8Array(i.computeSecret(t));return{publicKey:new Uint8Array(i.getPublicKey()),sharedKey:s}}(n,e);default:return Hs(n,e)}}async function $u(n,e,r,t){if(t.length!==n.payloadSize){const i=new Uint8Array(n.payloadSize);i.set(t,n.payloadSize-t.length),t=i}switch(n.type){case"curve25519Legacy":{const i=t.slice().reverse();return{secretKey:i,sharedKey:await yi(c.publicKey.x25519,e.subarray(1),r.subarray(1),i)}}case"web":if(n.web&&y.getWebCrypto())try{return await async function(i,s,a,o){const u=po(i.payloadSize,i.web,a,o);let l=Pt.importKey("jwk",u,{name:"ECDH",namedCurve:i.web},!0,["deriveKey","deriveBits"]);const h=wn(i.payloadSize,i.web,s);let p=Pt.importKey("jwk",h,{name:"ECDH",namedCurve:i.web},!0,[]);[l,p]=await Promise.all([l,p]);let f=Pt.deriveBits({name:"ECDH",namedCurve:i.web,public:p},l,i.sharedSize),g=Pt.exportKey("jwk",l);[f,g]=await Promise.all([f,g]);const d=new Uint8Array(f);return{secretKey:$e(g.d),sharedKey:d}}(n,e,r,t)}catch(i){return y.printDebugError(i),Os(n,e,t)}break;case"node":return async function(i,s,a){const o=wo.createECDH(i.node);o.setPrivateKey(a);const u=new Uint8Array(o.computeSecret(s));return{secretKey:new Uint8Array(o.getPrivateKey()),sharedKey:u}}(n,e,t);default:return Os(n,e,t)}}async function Os(n,e,r){return{secretKey:r,sharedKey:(await y.getNobleCurve(c.publicKey.ecdh,n.name)).getSharedSecret(r,e).subarray(1)}}async function Hs(n,e){const r=await y.getNobleCurve(c.publicKey.ecdh,n.name),{publicKey:t,privateKey:i}=await n.genKeyPair();return{publicKey:t,sharedKey:r.getSharedSecret(i,e).subarray(1)}}var zu=Object.freeze({__proto__:null,decrypt:async function(n,e,r,t,i,s,a){const o=new ft(n);Nt(o,i),Nt(o,r);const{sharedKey:u}=await $u(o,r,i,s),l=Fs(c.publicKey.ecdh,n,e,a),{keySize:h}=ke(e.cipher);let p;for(let f=0;f<3;f++)try{const g=await Ns(e.hash,u,h,l,f===1,f===2);return mo(await en(e.cipher,g,t))}catch(g){p=g}throw p},encrypt:async function(n,e,r,t,i){const s=go(r),a=new ft(n);Nt(a,t);const{publicKey:o,sharedKey:u}=await Hu(a,t),l=Fs(c.publicKey.ecdh,n,e,i),{keySize:h}=ke(e.cipher),p=await Ns(e.hash,u,h,l);return{publicKey:o,wrappedKey:await Jr(e.cipher,p,s)}},validateParams:async function(n,e,r){return ho(c.publicKey.ecdh,n,e,r)}}),_u=Object.freeze({__proto__:null,CurveWithOID:ft,ecdh:zu,ecdhX:Ru,ecdsa:Fu,eddsa:Lu,eddsaLegacy:Nu,generate:async function(n){const e=new ft(n),{oid:r,hash:t,cipher:i}=e,s=await e.genKeyPair();return{oid:r,Q:s.publicKey,secret:y.leftPad(s.privateKey,e.payloadSize),hash:t,cipher:i}},getPreferredHashAlgo:function(n){return lo[n.getName()].hash}});const Rr=BigInt(0),lr=BigInt(1);var ju=Object.freeze({__proto__:null,sign:async function(n,e,r,t,i,s){const a=BigInt(0);let o,u,l,h;t=T(t),i=T(i),r=T(r),s=T(s),r=F(r,t),s=F(s,i);const p=F(T(e.subarray(0,Ke(i))),i);for(;;){if(o=pt(lr,i),u=F(le(r,o,t),i),u===a)continue;const f=F(s*u,i);if(h=F(p+f,i),l=F(Jt(o,i)*h,i),l!==a)break}return{r:oe(u,"be",Ke(t)),s:oe(l,"be",Ke(t))}},validateParams:async function(n,e,r,t,i){if(n=T(n),e=T(e),r=T(r),t=T(t),r<=lr||r>=n||F(n-lr,e)!==Rr||le(r,e,n)!==lr)return!1;const s=BigInt(ir(e));if(s<BigInt(150)||!Ga(e,null,32))return!1;i=T(i);const a=BigInt(2);return t===le(r,e*pt(a<<s-lr,a<<s)+i,n)},verify:async function(n,e,r,t,i,s,a,o){if(e=T(e),r=T(r),s=T(s),a=T(a),i=T(i),o=T(o),e<=Rr||e>=a||r<=Rr||r>=a)return y.printDebug("invalid DSA Signature"),!1;const u=F(T(t.subarray(0,Ke(a))),a),l=Jt(r,a);if(l===Rr)return y.printDebug("invalid DSA Signature"),!1;i=F(i,s),o=F(o,s);const h=F(u*l,a),p=F(e*l,a);return F(F(le(i,h,s)*le(o,p,s),s),a)===e}}),R={rsa:Su,elgamal:Eu,elliptic:_u,dsa:ju},qu=Object.freeze({__proto__:null,parseSignatureParams:function(n,e){let r=0;switch(n){case c.publicKey.rsaEncryptSign:case c.publicKey.rsaEncrypt:case c.publicKey.rsaSign:{const t=y.readMPI(e.subarray(r));return r+=t.length+2,{read:r,signatureParams:{s:t}}}case c.publicKey.dsa:case c.publicKey.ecdsa:{const t=y.readMPI(e.subarray(r));r+=t.length+2;const i=y.readMPI(e.subarray(r));return r+=i.length+2,{read:r,signatureParams:{r:t,s:i}}}case c.publicKey.eddsaLegacy:{const t=y.readMPI(e.subarray(r));r+=t.length+2;const i=y.readMPI(e.subarray(r));return r+=i.length+2,{read:r,signatureParams:{r:t,s:i}}}case c.publicKey.ed25519:case c.publicKey.ed448:{const t=2*R.elliptic.eddsa.getPayloadSize(n),i=y.readExactSubarray(e,r,r+t);return r+=i.length,{read:r,signatureParams:{RS:i}}}default:throw new Y("Unknown signature algorithm.")}},sign:async function(n,e,r,t,i,s){if(!r||!t)throw Error("Missing key parameters");switch(n){case c.publicKey.rsaEncryptSign:case c.publicKey.rsaEncrypt:case c.publicKey.rsaSign:{const{n:a,e:o}=r,{d:u,p:l,q:h,u:p}=t;return{s:await R.rsa.sign(e,i,a,o,u,l,h,p,s)}}case c.publicKey.dsa:{const{g:a,p:o,q:u}=r,{x:l}=t;return R.dsa.sign(e,s,a,o,u,l)}case c.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case c.publicKey.ecdsa:{const{oid:a,Q:o}=r,{d:u}=t;return R.elliptic.ecdsa.sign(a,e,i,o,u,s)}case c.publicKey.eddsaLegacy:{const{oid:a,Q:o}=r,{seed:u}=t;return R.elliptic.eddsaLegacy.sign(a,e,i,o,u,s)}case c.publicKey.ed25519:case c.publicKey.ed448:{const{A:a}=r,{seed:o}=t;return R.elliptic.eddsa.sign(n,e,i,a,o,s)}default:throw Error("Unknown signature algorithm.")}},verify:async function(n,e,r,t,i,s){switch(n){case c.publicKey.rsaEncryptSign:case c.publicKey.rsaEncrypt:case c.publicKey.rsaSign:{const{n:a,e:o}=t,u=y.leftPad(r.s,a.length);return R.rsa.verify(e,i,u,a,o,s)}case c.publicKey.dsa:{const{g:a,p:o,q:u,y:l}=t,{r:h,s:p}=r;return R.dsa.verify(e,h,p,s,a,o,u,l)}case c.publicKey.ecdsa:{const{oid:a,Q:o}=t,u=new R.elliptic.CurveWithOID(a).payloadSize,l=y.leftPad(r.r,u),h=y.leftPad(r.s,u);return R.elliptic.ecdsa.verify(a,e,{r:l,s:h},i,o,s)}case c.publicKey.eddsaLegacy:{const{oid:a,Q:o}=t,u=new R.elliptic.CurveWithOID(a).payloadSize,l=y.leftPad(r.r,u),h=y.leftPad(r.s,u);return R.elliptic.eddsaLegacy.verify(a,e,{r:l,s:h},i,o,s)}case c.publicKey.ed25519:case c.publicKey.ed448:{const{A:a}=t;return R.elliptic.eddsa.verify(n,e,r,i,a,s)}default:throw Error("Unknown signature algorithm.")}}});class $s{constructor(e){e&&(this.data=e)}read(e){if(e.length>=1){const r=e[0];if(e.length>=1+r)return this.data=e.subarray(1,1+r),1+this.data.length}throw Error("Invalid symmetric key")}write(){return y.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class zs{constructor(e){if(e){const{hash:r,cipher:t}=e;this.hash=r,this.cipher=t}else this.hash=null,this.cipher=null}read(e){if(e.length<4||e[0]!==3||e[1]!==1)throw new Y("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class sn{static fromObject({wrappedKey:e,algorithm:r}){const t=new sn;return t.wrappedKey=e,t.algorithm=r,t}read(e){let r=0,t=e[r++];this.algorithm=t%2?e[r++]:null,t-=t%2,this.wrappedKey=y.readExactSubarray(e,r,r+t),r+=t}write(){return y.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}function Hn(n){try{n.getName()}catch{throw new Y("Unknown curve OID")}}function Lt(n,e){switch(n){case c.publicKey.ecdsa:case c.publicKey.ecdh:case c.publicKey.eddsaLegacy:return new R.elliptic.CurveWithOID(e).payloadSize;case c.publicKey.ed25519:case c.publicKey.ed448:return R.elliptic.eddsa.getPayloadSize(n);case c.publicKey.x25519:case c.publicKey.x448:return R.elliptic.ecdhX.getPayloadSize(n);default:throw Error("Unknown elliptic algo")}}var Gu=Object.freeze({__proto__:null,generateParams:function(n,e,r){switch(n){case c.publicKey.rsaEncrypt:case c.publicKey.rsaEncryptSign:case c.publicKey.rsaSign:return R.rsa.generate(e,65537).then(({n:t,e:i,d:s,p:a,q:o,u})=>({privateParams:{d:s,p:a,q:o,u},publicParams:{n:t,e:i}}));case c.publicKey.ecdsa:return R.elliptic.generate(r).then(({oid:t,Q:i,secret:s})=>({privateParams:{d:s},publicParams:{oid:new ot(t),Q:i}}));case c.publicKey.eddsaLegacy:return R.elliptic.generate(r).then(({oid:t,Q:i,secret:s})=>({privateParams:{seed:s},publicParams:{oid:new ot(t),Q:i}}));case c.publicKey.ecdh:return R.elliptic.generate(r).then(({oid:t,Q:i,secret:s,hash:a,cipher:o})=>({privateParams:{d:s},publicParams:{oid:new ot(t),Q:i,kdfParams:new zs({hash:a,cipher:o})}}));case c.publicKey.ed25519:case c.publicKey.ed448:return R.elliptic.eddsa.generate(n).then(({A:t,seed:i})=>({privateParams:{seed:i},publicParams:{A:t}}));case c.publicKey.x25519:case c.publicKey.x448:return R.elliptic.ecdhX.generate(n).then(({A:t,k:i})=>({privateParams:{k:i},publicParams:{A:t}}));case c.publicKey.dsa:case c.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}},generateSessionKey:function(n){const{keySize:e}=ke(n);return yt(e)},getAEADMode:function(n){const e=c.read(c.aead,n);return qa[e]},getCipherParams:ke,getCurvePayloadSize:Lt,getPreferredCurveHashAlgo:function(n,e){switch(n){case c.publicKey.ecdsa:case c.publicKey.eddsaLegacy:return R.elliptic.getPreferredHashAlgo(e);case c.publicKey.ed25519:case c.publicKey.ed448:return R.elliptic.eddsa.getPreferredHashAlgo(n);default:throw Error("Unknown elliptic signing algo")}},getPrefixRandom:async function(n){const{blockSize:e}=ke(n),r=await yt(e),t=new Uint8Array([r[r.length-2],r[r.length-1]]);return y.concat([r,t])},parseEncSessionKeyParams:function(n,e){let r=0;switch(n){case c.publicKey.rsaEncrypt:case c.publicKey.rsaEncryptSign:return{c:y.readMPI(e.subarray(r))};case c.publicKey.elgamal:{const t=y.readMPI(e.subarray(r));return r+=t.length+2,{c1:t,c2:y.readMPI(e.subarray(r))}}case c.publicKey.ecdh:{const t=y.readMPI(e.subarray(r));r+=t.length+2;const i=new $s;return i.read(e.subarray(r)),{V:t,C:i}}case c.publicKey.x25519:case c.publicKey.x448:{const t=Lt(n),i=y.readExactSubarray(e,r,r+t);r+=i.length;const s=new sn;return s.read(e.subarray(r)),{ephemeralPublicKey:i,C:s}}default:throw new Y("Unknown public key encryption algorithm.")}},parsePrivateKeyParams:function(n,e,r){let t=0;switch(n){case c.publicKey.rsaEncrypt:case c.publicKey.rsaEncryptSign:case c.publicKey.rsaSign:{const i=y.readMPI(e.subarray(t));t+=i.length+2;const s=y.readMPI(e.subarray(t));t+=s.length+2;const a=y.readMPI(e.subarray(t));t+=a.length+2;const o=y.readMPI(e.subarray(t));return t+=o.length+2,{read:t,privateParams:{d:i,p:s,q:a,u:o}}}case c.publicKey.dsa:case c.publicKey.elgamal:{const i=y.readMPI(e.subarray(t));return t+=i.length+2,{read:t,privateParams:{x:i}}}case c.publicKey.ecdsa:case c.publicKey.ecdh:{const i=Lt(n,r.oid);let s=y.readMPI(e.subarray(t));return t+=s.length+2,s=y.leftPad(s,i),{read:t,privateParams:{d:s}}}case c.publicKey.eddsaLegacy:{const i=Lt(n,r.oid);if(r.oid.getName()!==c.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let s=y.readMPI(e.subarray(t));return t+=s.length+2,s=y.leftPad(s,i),{read:t,privateParams:{seed:s}}}case c.publicKey.ed25519:case c.publicKey.ed448:{const i=Lt(n),s=y.readExactSubarray(e,t,t+i);return t+=s.length,{read:t,privateParams:{seed:s}}}case c.publicKey.x25519:case c.publicKey.x448:{const i=Lt(n),s=y.readExactSubarray(e,t,t+i);return t+=s.length,{read:t,privateParams:{k:s}}}default:throw new Y("Unknown public key encryption algorithm.")}},parsePublicKeyParams:function(n,e){let r=0;switch(n){case c.publicKey.rsaEncrypt:case c.publicKey.rsaEncryptSign:case c.publicKey.rsaSign:{const t=y.readMPI(e.subarray(r));r+=t.length+2;const i=y.readMPI(e.subarray(r));return r+=i.length+2,{read:r,publicParams:{n:t,e:i}}}case c.publicKey.dsa:{const t=y.readMPI(e.subarray(r));r+=t.length+2;const i=y.readMPI(e.subarray(r));r+=i.length+2;const s=y.readMPI(e.subarray(r));r+=s.length+2;const a=y.readMPI(e.subarray(r));return r+=a.length+2,{read:r,publicParams:{p:t,q:i,g:s,y:a}}}case c.publicKey.elgamal:{const t=y.readMPI(e.subarray(r));r+=t.length+2;const i=y.readMPI(e.subarray(r));r+=i.length+2;const s=y.readMPI(e.subarray(r));return r+=s.length+2,{read:r,publicParams:{p:t,g:i,y:s}}}case c.publicKey.ecdsa:{const t=new ot;r+=t.read(e),Hn(t);const i=y.readMPI(e.subarray(r));return r+=i.length+2,{read:r,publicParams:{oid:t,Q:i}}}case c.publicKey.eddsaLegacy:{const t=new ot;if(r+=t.read(e),Hn(t),t.getName()!==c.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let i=y.readMPI(e.subarray(r));return r+=i.length+2,i=y.leftPad(i,33),{read:r,publicParams:{oid:t,Q:i}}}case c.publicKey.ecdh:{const t=new ot;r+=t.read(e),Hn(t);const i=y.readMPI(e.subarray(r));r+=i.length+2;const s=new zs;return r+=s.read(e.subarray(r)),{read:r,publicParams:{oid:t,Q:i,kdfParams:s}}}case c.publicKey.ed25519:case c.publicKey.ed448:case c.publicKey.x25519:case c.publicKey.x448:{const t=y.readExactSubarray(e,r,r+Lt(n));return r+=t.length,{read:r,publicParams:{A:t}}}default:throw new Y("Unknown public key encryption algorithm.")}},publicKeyDecrypt:async function(n,e,r,t,i,s){switch(n){case c.publicKey.rsaEncryptSign:case c.publicKey.rsaEncrypt:{const{c:a}=t,{n:o,e:u}=e,{d:l,p:h,q:p,u:f}=r;return R.rsa.decrypt(a,o,u,l,h,p,f,s)}case c.publicKey.elgamal:{const{c1:a,c2:o}=t,u=e.p,l=r.x;return R.elgamal.decrypt(a,o,u,l,s)}case c.publicKey.ecdh:{const{oid:a,Q:o,kdfParams:u}=e,{d:l}=r,{V:h,C:p}=t;return R.elliptic.ecdh.decrypt(a,u,h,p.data,o,l,i)}case c.publicKey.x25519:case c.publicKey.x448:{const{A:a}=e,{k:o}=r,{ephemeralPublicKey:u,C:l}=t;if(l.algorithm!==null&&!y.isAES(l.algorithm))throw Error("AES session key expected");return R.elliptic.ecdhX.decrypt(n,u,l.wrappedKey,a,o)}default:throw Error("Unknown public key encryption algorithm.")}},publicKeyEncrypt:async function(n,e,r,t,i){switch(n){case c.publicKey.rsaEncrypt:case c.publicKey.rsaEncryptSign:{const{n:s,e:a}=r;return{c:await R.rsa.encrypt(t,s,a)}}case c.publicKey.elgamal:{const{p:s,g:a,y:o}=r;return R.elgamal.encrypt(t,s,a,o)}case c.publicKey.ecdh:{const{oid:s,Q:a,kdfParams:o}=r,{publicKey:u,wrappedKey:l}=await R.elliptic.ecdh.encrypt(s,o,t,a,i);return{V:u,C:new $s(l)}}case c.publicKey.x25519:case c.publicKey.x448:{if(e&&!y.isAES(e))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:s}=r,{ephemeralPublicKey:a,wrappedKey:o}=await R.elliptic.ecdhX.encrypt(n,t,s);return{ephemeralPublicKey:a,C:sn.fromObject({algorithm:e,wrappedKey:o})}}default:return[]}},serializeParams:function(n,e){const r=new Set([c.publicKey.ed25519,c.publicKey.x25519,c.publicKey.ed448,c.publicKey.x448]),t=Object.keys(e).map(i=>{const s=e[i];return y.isUint8Array(s)?r.has(n)?s:y.uint8ArrayToMPI(s):s.write()});return y.concatUint8Array(t)},validateParams:async function(n,e,r){if(!e||!r)throw Error("Missing key parameters");switch(n){case c.publicKey.rsaEncrypt:case c.publicKey.rsaEncryptSign:case c.publicKey.rsaSign:{const{n:t,e:i}=e,{d:s,p:a,q:o,u}=r;return R.rsa.validateParams(t,i,s,a,o,u)}case c.publicKey.dsa:{const{p:t,q:i,g:s,y:a}=e,{x:o}=r;return R.dsa.validateParams(t,i,s,a,o)}case c.publicKey.elgamal:{const{p:t,g:i,y:s}=e,{x:a}=r;return R.elgamal.validateParams(t,i,s,a)}case c.publicKey.ecdsa:case c.publicKey.ecdh:{const t=R.elliptic[c.read(c.publicKey,n)],{oid:i,Q:s}=e,{d:a}=r;return t.validateParams(i,s,a)}case c.publicKey.eddsaLegacy:{const{Q:t,oid:i}=e,{seed:s}=r;return R.elliptic.eddsaLegacy.validateParams(i,t,s)}case c.publicKey.ed25519:case c.publicKey.ed448:{const{A:t}=e,{seed:i}=r;return R.elliptic.eddsa.validateParams(n,t,i)}case c.publicKey.x25519:case c.publicKey.x448:{const{A:t}=e,{k:i}=r;return R.elliptic.ecdhX.validateParams(n,t,i)}default:throw Error("Unknown public key algorithm.")}}});const M={cipher:Yc,hash:Be,mode:qa,publicKey:R,signature:qu,random:ku,pkcs1:Au,pkcs5:Ou,aesKW:Mu};Object.assign(M,Gu);class Ti extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Ti),this.name="Argon2OutOfMemoryError"}}let Fr,hr;class Wu{constructor(e=L){const{passes:r,parallelism:t,memoryExponent:i}=e.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=r,this.p=t,this.encodedM=i}generateSalt(){this.salt=M.random.getRandomBytes(16)}read(e){let r=0;return this.salt=e.subarray(r,r+16),r+=16,this.t=e[r++],this.p=e[r++],this.encodedM=e[r++],r}write(){const e=[new Uint8Array([c.write(c.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return y.concatUint8Array(e)}async produceKey(e,r){const t=2<<this.encodedM-1;try{Fr=Fr||(await yn(async()=>{const{default:a}=await import("./argon2id.min-CNcW1-Gk.js");return{default:a}},[],import.meta.url)).default,hr=hr||Fr();const i=await hr,s=i({version:19,type:2,password:y.encodeUTF8(e),salt:this.salt,tagLength:r,memorySize:t,parallelism:this.p,passes:this.t});return t>1048576&&(hr=Fr(),hr.catch(()=>{})),s}catch(i){throw i.message&&(i.message.includes("Unable to grow instance memory")||i.message.includes("failed to grow memory")||i.message.includes("WebAssembly.Memory.grow")||i.message.includes("Out of memory"))?new Ti("Could not allocate required memory for Argon2"):i}}}class Vu{constructor(e,r=L){this.algorithm=c.hash.sha256,this.type=c.read(c.s2k,e),this.c=r.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=M.random.getRandomBytes(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let r=0;switch(this.algorithm=e[r++],this.type){case"simple":break;case"salted":this.salt=e.subarray(r,r+8),r+=8;break;case"iterated":this.salt=e.subarray(r,r+8),r+=8,this.c=e[r++];break;case"gnu":if(y.uint8ArrayToString(e.subarray(r,r+3))!=="GNU")throw new Y("Unknown s2k type.");if(r+=3,1e3+e[r++]!==1001)throw new Y("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new Y("Unknown s2k type.")}return r}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...y.stringToUint8Array("GNU"),1]);const e=[new Uint8Array([c.write(c.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return y.concatUint8Array(e)}async produceKey(e,r){e=y.encodeUTF8(e);const t=[];let i=0,s=0;for(;i<r;){let a;switch(this.type){case"simple":a=y.concatUint8Array([new Uint8Array(s),e]);break;case"salted":a=y.concatUint8Array([new Uint8Array(s),this.salt,e]);break;case"iterated":{const u=y.concatUint8Array([this.salt,e]);let l=u.length;const h=Math.max(this.getCount(),l);a=new Uint8Array(s+h),a.set(u,s);for(let p=s+l;p<h;p+=l,l*=2)a.copyWithin(p,s,p);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const o=await M.hash.digest(this.algorithm,a);t.push(o),i+=o.length,s++}return y.concatUint8Array(t).subarray(0,r)}}const Qu=new Set([c.s2k.argon2,c.s2k.iterated]);function pi(n,e=L){switch(n){case c.s2k.argon2:return new Wu(e);case c.s2k.iterated:case c.s2k.gnu:case c.s2k.salted:case c.s2k.simple:return new Vu(n,e);default:throw new Y("Unsupported S2K type")}}function Zu(n){const{s2kType:e}=n;if(!Qu.has(e))throw Error("The provided `config.s2kType` value is not allowed");return pi(e,n)}var Ir=Uint8Array,bo=Uint16Array,Xu=Uint32Array,Yu=new Ir([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ju=new Ir([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ko=function(n,e){for(var r=new bo(31),t=0;t<31;++t)r[t]=e+=1<<n[t-1];var i=new Xu(r[30]);for(t=1;t<30;++t)for(var s=r[t];s<r[t+1];++s)i[s]=s-r[t]<<5|t;return[r,i]},vo=ko(Yu,2),el=vo[0],tl=vo[1];el[28]=258,tl[258]=28;for(var _s=ko(Ju,0),Ol=_s[0],Hl=_s[1],rl=new bo(32768),W=0;W<32768;++W){var Mt=(43690&W)>>>1|(21845&W)<<1;Mt=(61680&(Mt=(52428&Mt)>>>2|(13107&Mt)<<2))>>>4|(3855&Mt)<<4,rl[W]=((65280&Mt)>>>8|(255&Mt)<<8)>>>1}var bn=new Ir(288);for(W=0;W<144;++W)bn[W]=8;for(W=144;W<256;++W)bn[W]=9;for(W=256;W<280;++W)bn[W]=7;for(W=280;W<288;++W)bn[W]=8;var nl=new Ir(32);for(W=0;W<32;++W)nl[W]=5;var il=new Ir(0),sl=typeof TextDecoder<"u"&&new TextDecoder;try{sl.decode(il,{stream:!0})}catch{}class Ht{constructor(){this.bytes=""}read(e){return this.bytes=y.uint8ArrayToString(e.subarray(0,8)),this.bytes.length}write(){return y.stringToUint8Array(this.bytes)}toHex(){return y.uint8ArrayToHex(y.stringToUint8Array(this.bytes))}equals(e,r=!1){return r&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){const r=new Ht;return r.read(y.hexToUint8Array(e)),r}static wildcard(){const e=new Ht;return e.read(new Uint8Array(8)),e}}const yr=Symbol("verified"),js="salt@notations.openpgpjs.org",al=new Set([c.signatureSubpacket.issuerKeyID,c.signatureSubpacket.issuerFingerprint,c.signatureSubpacket.embeddedSignature]);class ut{static get tag(){return c.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Ht,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[yr]=null}read(e,r=L){let t=0;if(this.version=e[t++],this.version===5&&!r.enableParsingV5Entities)throw new Y("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version!==4&&this.version!==5&&this.version!==6)throw new Y(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[t++],this.publicKeyAlgorithm=e[t++],this.hashAlgorithm=e[t++],t+=this.readSubPackets(e.subarray(t,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=e.subarray(0,t),t+=this.readSubPackets(e.subarray(t,e.length),!1),this.signedHashValue=e.subarray(t,t+2),t+=2,this.version===6){const o=e[t++];this.salt=e.subarray(t,t+o),t+=o}const i=e.subarray(t,e.length),{read:s,signatureParams:a}=M.signature.parseSignatureParams(this.publicKeyAlgorithm,i);if(s<i.length)throw Error("Error reading MPIs");this.params=a}writeParams(){return this.params instanceof Promise?Si(async()=>M.serializeParams(this.publicKeyAlgorithm,await this.params)):M.serializeParams(this.publicKeyAlgorithm,this.params)}write(){const e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),this.version===6&&(e.push(new Uint8Array([this.salt.length])),e.push(this.salt)),e.push(this.writeParams()),y.concat(e)}async sign(e,r,t=new Date,i=!1,s){this.version=e.version,this.created=y.normalizeDate(t),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID();const a=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(this.version===6){const h=$n(this.hashAlgorithm);if(this.salt===null)this.salt=M.random.getRandomBytes(h);else if(h!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(s.nonDeterministicSignaturesViaNotation){if(this.rawNotations.filter(({name:h})=>h===js).length!==0)throw Error("Unexpected existing salt notation");{const h=M.random.getRandomBytes($n(this.hashAlgorithm));this.rawNotations.push({name:js,value:h,humanReadable:!1,critical:!1})}}a.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=y.concat(a);const o=this.toHash(this.signatureType,r,i),u=await this.hash(this.signatureType,r,o,i);this.signedHashValue=xe(qr(u),0,2);const l=async()=>M.signature.sign(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,o,await nr(u));y.isStream(u)?this.params=l():(this.params=await l(),this[yr]=!0)}writeHashedSubPackets(){const e=c.signatureSubpacket,r=[];let t;if(this.created===null)throw Error("Missing signature creation time");r.push(_(e.signatureCreationTime,!0,y.writeDate(this.created))),this.signatureExpirationTime!==null&&r.push(_(e.signatureExpirationTime,!0,y.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&r.push(_(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(t=new Uint8Array([this.trustLevel,this.trustAmount]),r.push(_(e.trustSignature,!0,t))),this.regularExpression!==null&&r.push(_(e.regularExpression,!0,this.regularExpression)),this.revocable!==null&&r.push(_(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&r.push(_(e.keyExpirationTime,!0,y.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(t=y.stringToUint8Array(y.uint8ArrayToString(this.preferredSymmetricAlgorithms)),r.push(_(e.preferredSymmetricAlgorithms,!1,t))),this.revocationKeyClass!==null&&(t=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),t=y.concat([t,this.revocationKeyFingerprint]),r.push(_(e.revocationKey,!1,t))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&r.push(_(e.issuerKeyID,!0,this.issuerKeyID.write())),this.rawNotations.forEach(({name:a,value:o,humanReadable:u,critical:l})=>{t=[new Uint8Array([u?128:0,0,0,0])];const h=y.encodeUTF8(a);t.push(y.writeNumber(h.length,2)),t.push(y.writeNumber(o.length,2)),t.push(h),t.push(o),t=y.concat(t),r.push(_(e.notationData,l,t))}),this.preferredHashAlgorithms!==null&&(t=y.stringToUint8Array(y.uint8ArrayToString(this.preferredHashAlgorithms)),r.push(_(e.preferredHashAlgorithms,!1,t))),this.preferredCompressionAlgorithms!==null&&(t=y.stringToUint8Array(y.uint8ArrayToString(this.preferredCompressionAlgorithms)),r.push(_(e.preferredCompressionAlgorithms,!1,t))),this.keyServerPreferences!==null&&(t=y.stringToUint8Array(y.uint8ArrayToString(this.keyServerPreferences)),r.push(_(e.keyServerPreferences,!1,t))),this.preferredKeyServer!==null&&r.push(_(e.preferredKeyServer,!1,y.encodeUTF8(this.preferredKeyServer))),this.isPrimaryUserID!==null&&r.push(_(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&r.push(_(e.policyURI,!1,y.encodeUTF8(this.policyURI))),this.keyFlags!==null&&(t=y.stringToUint8Array(y.uint8ArrayToString(this.keyFlags)),r.push(_(e.keyFlags,!0,t))),this.signersUserID!==null&&r.push(_(e.signersUserID,!1,y.encodeUTF8(this.signersUserID))),this.reasonForRevocationFlag!==null&&(t=y.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),r.push(_(e.reasonForRevocation,!0,t))),this.features!==null&&(t=y.stringToUint8Array(y.uint8ArrayToString(this.features)),r.push(_(e.features,!1,t))),this.signatureTargetPublicKeyAlgorithm!==null&&(t=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],t.push(y.stringToUint8Array(this.signatureTargetHash)),t=y.concat(t),r.push(_(e.signatureTarget,!0,t))),this.embeddedSignature!==null&&r.push(_(e.embeddedSignature,!0,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(t=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],t=y.concat(t),r.push(_(e.issuerFingerprint,this.version>=5,t))),this.preferredAEADAlgorithms!==null&&(t=y.stringToUint8Array(y.uint8ArrayToString(this.preferredAEADAlgorithms)),r.push(_(e.preferredAEADAlgorithms,!1,t))),this.preferredCipherSuites!==null&&(t=new Uint8Array([].concat(...this.preferredCipherSuites)),r.push(_(e.preferredCipherSuites,!1,t)));const i=y.concat(r),s=y.writeNumber(i.length,this.version===6?4:2);return y.concat([s,i])}writeUnhashedSubPackets(){const e=this.unhashedSubpackets.map(({type:i,critical:s,body:a})=>_(i,s,a)),r=y.concat(e),t=y.writeNumber(r.length,this.version===6?4:2);return y.concat([t,r])}readSubPacket(e,r=!0){let t=0;const i=!!(128&e[t]),s=127&e[t];if(t++,r||(this.unhashedSubpackets.push({type:s,critical:i,body:e.subarray(t,e.length)}),al.has(s)))switch(s){case c.signatureSubpacket.signatureCreationTime:this.created=y.readDate(e.subarray(t,e.length));break;case c.signatureSubpacket.signatureExpirationTime:{const a=y.readNumber(e.subarray(t,e.length));this.signatureNeverExpires=a===0,this.signatureExpirationTime=a;break}case c.signatureSubpacket.exportableCertification:this.exportable=e[t++]===1;break;case c.signatureSubpacket.trustSignature:this.trustLevel=e[t++],this.trustAmount=e[t++];break;case c.signatureSubpacket.regularExpression:this.regularExpression=e[t];break;case c.signatureSubpacket.revocable:this.revocable=e[t++]===1;break;case c.signatureSubpacket.keyExpirationTime:{const a=y.readNumber(e.subarray(t,e.length));this.keyExpirationTime=a,this.keyNeverExpires=a===0;break}case c.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(t,e.length)];break;case c.signatureSubpacket.revocationKey:this.revocationKeyClass=e[t++],this.revocationKeyAlgorithm=e[t++],this.revocationKeyFingerprint=e.subarray(t,t+20);break;case c.signatureSubpacket.issuerKeyID:if(this.version===4)this.issuerKeyID.read(e.subarray(t,e.length));else if(r)throw Error("Unexpected Issuer Key ID subpacket");break;case c.signatureSubpacket.notationData:{const a=!!(128&e[t]);t+=4;const o=y.readNumber(e.subarray(t,t+2));t+=2;const u=y.readNumber(e.subarray(t,t+2));t+=2;const l=y.decodeUTF8(e.subarray(t,t+o)),h=e.subarray(t+o,t+o+u);this.rawNotations.push({name:l,humanReadable:a,value:h,critical:i}),a&&(this.notations[l]=y.decodeUTF8(h));break}case c.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(t,e.length)];break;case c.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(t,e.length)];break;case c.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(t,e.length)];break;case c.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=y.decodeUTF8(e.subarray(t,e.length));break;case c.signatureSubpacket.primaryUserID:this.isPrimaryUserID=e[t++]!==0;break;case c.signatureSubpacket.policyURI:this.policyURI=y.decodeUTF8(e.subarray(t,e.length));break;case c.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(t,e.length)];break;case c.signatureSubpacket.signersUserID:this.signersUserID=y.decodeUTF8(e.subarray(t,e.length));break;case c.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[t++],this.reasonForRevocationString=y.decodeUTF8(e.subarray(t,e.length));break;case c.signatureSubpacket.features:this.features=[...e.subarray(t,e.length)];break;case c.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[t++],this.signatureTargetHashAlgorithm=e[t++];const a=M.getHashByteLength(this.signatureTargetHashAlgorithm);this.signatureTargetHash=y.uint8ArrayToString(e.subarray(t,t+a));break}case c.signatureSubpacket.embeddedSignature:this.embeddedSignature=new ut,this.embeddedSignature.read(e.subarray(t,e.length));break;case c.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[t++],this.issuerFingerprint=e.subarray(t,e.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case c.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(t,e.length)];break;case c.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let a=t;a<e.length;a+=2)this.preferredCipherSuites.push([e[a],e[a+1]]);break;default:this.unknownSubpackets.push({type:s,critical:i,body:e.subarray(t,e.length)})}}readSubPackets(e,r=!0,t){const i=this.version===6?4:2,s=y.readNumber(e.subarray(0,i));let a=i;for(;a<2+s;){const o=to(e.subarray(a,e.length));a+=o.offset,this.readSubPacket(e.subarray(a,a+o.len),r,t),a+=o.len}return a}toSign(e,r){const t=c.signature;switch(e){case t.binary:return r.text!==null?y.encodeUTF8(r.getText(!0)):r.getBytes(!0);case t.text:{const i=r.getBytes(!0);return y.canonicalizeEOL(i)}case t.standalone:return new Uint8Array(0);case t.certGeneric:case t.certPersona:case t.certCasual:case t.certPositive:case t.certRevocation:{let i,s;if(r.userID)s=180,i=r.userID;else{if(!r.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");s=209,i=r.userAttribute}const a=i.write();return y.concat([this.toSign(t.key,r),new Uint8Array([s]),y.writeNumber(a.length,4),a])}case t.subkeyBinding:case t.subkeyRevocation:case t.keyBinding:return y.concat([this.toSign(t.key,r),this.toSign(t.key,{key:r.bind})]);case t.key:if(r.key===void 0)throw Error("Key packet is required for this signature.");return r.key.writeForHash(this.version);case t.keyRevocation:return this.toSign(t.key,r);case t.timestamp:return new Uint8Array(0);case t.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,r){let t=0;return ne(qr(this.signatureData),i=>{t+=i.length},()=>{const i=[];return this.version!==5||this.signatureType!==c.signature.binary&&this.signatureType!==c.signature.text||(r?i.push(new Uint8Array(6)):i.push(e.writeHeader())),i.push(new Uint8Array([this.version,255])),this.version===5&&i.push(new Uint8Array(4)),i.push(y.writeNumber(t,4)),y.concat(i)})}toHash(e,r,t=!1){const i=this.toSign(e,r);return y.concat([this.salt||new Uint8Array,i,this.signatureData,this.calculateTrailer(r,t)])}async hash(e,r,t,i=!1){if(this.version===6&&this.salt.length!==$n(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return t||(t=this.toHash(e,r,i)),M.hash.digest(this.hashAlgorithm,t)}async verify(e,r,t,i=new Date,s=!1,a=L){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const o=r===c.signature.binary||r===c.signature.text;if(!(this[yr]&&!o)){let l,h;if(this.hashed?h=await this.hashed:(l=this.toHash(r,t,s),h=await this.hash(r,t,l)),h=await nr(h),this.signedHashValue[0]!==h[0]||this.signedHashValue[1]!==h[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[yr]=await M.signature.verify(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,l,h),!this[yr])throw Error("Signature verification failed")}const u=y.normalizeDate(i);if(u&&this.created>u)throw Error("Signature creation time is in the future");if(u&&u>=this.getExpirationTime())throw Error("Signature is expired");if(a.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+c.read(c.hash,this.hashAlgorithm).toUpperCase());if(a.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[c.signature.binary,c.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+c.read(c.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach(({type:l,critical:h})=>{if(h)throw Error("Unknown critical signature subpacket type "+l)}),this.rawNotations.forEach(({name:l,critical:h})=>{if(h&&a.knownNotations.indexOf(l)<0)throw Error("Unknown critical notation: "+l)}),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(e=new Date){const r=y.normalizeDate(e);return r!==null&&!(this.created<=r&&r<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function _(n,e,r){const t=[];return t.push(mn(r.length+1)),t.push(new Uint8Array([(e?128:0)|n])),t.push(r),y.concat(t)}function $n(n){switch(n){case c.hash.sha256:return 16;case c.hash.sha384:return 24;case c.hash.sha512:return 32;case c.hash.sha224:case c.hash.sha3_256:return 16;case c.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class vr{static get tag(){return c.packet.onePassSignature}static fromSignaturePacket(e,r){const t=new vr;return t.version=e.version===6?6:3,t.signatureType=e.signatureType,t.hashAlgorithm=e.hashAlgorithm,t.publicKeyAlgorithm=e.publicKeyAlgorithm,t.issuerKeyID=e.issuerKeyID,t.salt=e.salt,t.issuerFingerprint=e.issuerFingerprint,t.flags=r?1:0,t}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(e){let r=0;if(this.version=e[r++],this.version!==3&&this.version!==6)throw new Y(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=e[r++],this.hashAlgorithm=e[r++],this.publicKeyAlgorithm=e[r++],this.version===6){const t=e[r++];this.salt=e.subarray(r,r+t),r+=t,this.issuerFingerprint=e.subarray(r,r+32),r+=32,this.issuerKeyID=new Ht,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new Ht,this.issuerKeyID.read(e.subarray(r,r+8)),r+=8;return this.flags=e[r++],this}write(){const e=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return this.version===6?e.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):e.push(this.issuerKeyID.write()),e.push(new Uint8Array([this.flags])),y.concatUint8Array(e)}calculateTrailer(...e){return Si(async()=>ut.prototype.calculateTrailer.apply(await this.correspondingSig,e))}async verify(){const e=await this.correspondingSig;if(!e||e.constructor.tag!==c.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID)||this.version===3&&e.version===6||this.version===6&&e.version!==6||this.version===6&&!y.equalsUint8Array(e.issuerFingerprint,this.issuerFingerprint)||this.version===6&&!y.equalsUint8Array(e.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)}}function ol(n,e){if(!e[n]){let r;try{r=c.read(c.packet,n)}catch{throw new ro("Unknown packet type with tag: "+n)}throw Error("Packet not allowed in this context: "+r)}return new e[n]}vr.prototype.hash=ut.prototype.hash,vr.prototype.toHash=ut.prototype.toHash,vr.prototype.toSign=ut.prototype.toSign;class Oe extends Array{static async fromBinary(e,r,t=L){const i=new Oe;return await i.read(e,r,t),i}async read(e,r,t=L){t.additionalAllowedPackets.length&&(r={...r,...y.constructAllowedPackets(t.additionalAllowedPackets)}),this.stream=fn(e,async(s,a)=>{const o=tt(a);try{for(;;)if(await o.ready,await Bu(s,async u=>{try{if(u.tag===c.packet.marker||u.tag===c.packet.trust||u.tag===c.packet.padding)return;const l=ol(u.tag,r);l.packets=new Oe,l.fromStream=y.isStream(u.packet),await l.read(u.packet,t),await o.write(l)}catch(l){if(l instanceof ro){if(!(u.tag<=39))return;await o.abort(l)}const h=!t.ignoreUnsupportedPackets&&l instanceof Y,p=!(t.ignoreMalformedPackets||l instanceof Y);if(h||p||zr(u.tag))await o.abort(l);else{const f=new li(u.tag,u.packet);await o.write(f)}y.printDebugError(l)}}))return await o.ready,void await o.close()}catch(u){await o.abort(u)}});const i=ar(this.stream);for(;;){const{done:s,value:a}=await i.read();if(s?this.stream=null:this.push(a),s||zr(a.constructor.tag))break}i.releaseLock()}write(){const e=[];for(let r=0;r<this.length;r++){const t=this[r]instanceof li?this[r].tag:this[r].constructor.tag,i=this[r].write();if(y.isStream(i)&&zr(this[r].constructor.tag)){let s=[],a=0;const o=512;e.push(Yr(t)),e.push(ne(i,u=>{if(s.push(u),a+=u.length,a>=o){const l=Math.min(Math.log(a)/Math.LN2|0,30),h=2**l,p=y.concat([xu(l)].concat(s));return s=[p.subarray(1+h)],a=s[0].length,p.subarray(0,1+h)}},()=>y.concat([mn(a)].concat(s))))}else{if(y.isStream(i)){let s=0;e.push(ne(qr(i),a=>{s+=a.length},()=>xs(t,s)))}else e.push(xs(t,i.length));e.push(i)}}return y.concat(e)}filterByTag(...e){const r=new Oe,t=i=>s=>i===s;for(let i=0;i<this.length;i++)e.some(t(this[i].constructor.tag))&&r.push(this[i]);return r}findPacket(e){return this.find(r=>r.constructor.tag===e)}indexOfTag(...e){const r=[],t=this,i=s=>a=>s===a;for(let s=0;s<this.length;s++)e.some(i(t[s].constructor.tag))&&r.push(s);return r}}class Je{static get tag(){return c.packet.publicKey}constructor(e=new Date,r=L){this.version=r.v6Keys?6:4,this.created=y.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){const r=new Je,{version:t,created:i,algorithm:s,publicParams:a,keyID:o,fingerprint:u}=e;return r.version=t,r.created=i,r.algorithm=s,r.publicParams=a,r.keyID=o,r.fingerprint=u,r}async read(e,r=L){let t=0;if(this.version=e[t++],this.version===5&&!r.enableParsingV5Entities)throw new Y("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version===4||this.version===5||this.version===6){this.created=y.readDate(e.subarray(t,t+4)),t+=4,this.algorithm=e[t++],this.version>=5&&(t+=4);const{read:i,publicParams:s}=M.parsePublicKeyParams(this.algorithm,e.subarray(t));if(this.version===6&&s.oid&&(s.oid.getName()===c.curve.curve25519Legacy||s.oid.getName()===c.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=s,t+=i,await this.computeFingerprintAndKeyID(),t}throw new Y(`Version ${this.version} of the key packet is unsupported.`)}write(){const e=[];e.push(new Uint8Array([this.version])),e.push(y.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));const r=M.serializeParams(this.algorithm,this.publicParams);return this.version>=5&&e.push(y.writeNumber(r.length,4)),e.push(r),y.concatUint8Array(e)}writeForHash(e){const r=this.writePublicKey(),t=149+e,i=e>=5?4:2;return y.concatUint8Array([new Uint8Array([t]),y.writeNumber(r.length,i),r])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new Ht,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const e=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await M.hash.sha256(e);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=await M.hash.sha1(e)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return y.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&y.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){const e={};e.algorithm=c.read(c.publicKey,this.algorithm);const r=this.publicParams.n||this.publicParams.p;return r?e.bits=y.uint8ArrayBitLength(r):this.publicParams.oid&&(e.curve=this.publicParams.oid.getName()),e}}Je.prototype.readPublicKey=Je.prototype.read,Je.prototype.writePublicKey=Je.prototype.write;class kn extends Je{static get tag(){return c.packet.publicSubkey}constructor(e,r){super(e,r)}static fromSecretSubkeyPacket(e){const r=new kn,{version:t,created:i,algorithm:s,publicParams:a,keyID:o,fingerprint:u}=e;return r.version=t,r.created=i,r.algorithm=s,r.publicParams=a,r.keyID=o,r.fingerprint=u,r}}class Li{static get tag(){return c.packet.userAttribute}constructor(){this.attributes=[]}read(e){let r=0;for(;r<e.length;){const t=to(e.subarray(r,e.length));r+=t.offset,this.attributes.push(y.uint8ArrayToString(e.subarray(r,r+t.len))),r+=t.len}}write(){const e=[];for(let r=0;r<this.attributes.length;r++)e.push(mn(this.attributes[r].length)),e.push(y.stringToUint8Array(this.attributes[r]));return y.concatUint8Array(e)}equals(e){return!!(e&&e instanceof Li)&&this.attributes.every(function(r,t){return r===e.attributes[t]})}}class Mi extends Je{static get tag(){return c.packet.secretKey}constructor(e=new Date,r=L){super(e,r),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.isLegacyAEAD=null,this.privateParams=null,this.usedModernAEAD=null}async read(e,r=L){let t=await this.readPublicKey(e,r);const i=t;this.s2kUsage=e[t++],this.version===5&&t++,this.version===6&&this.s2kUsage&&t++;try{if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){this.symmetric=e[t++],this.s2kUsage===253&&(this.aead=e[t++]),this.version===6&&t++;const s=e[t++];if(this.s2k=pi(s),t+=this.s2k.read(e.subarray(t,e.length)),this.s2k.type==="gnu-dummy")return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.isLegacyAEAD=this.s2kUsage===253&&(this.version===5||this.version===4&&r.parseAEADEncryptedV4KeysAsLegacy),this.s2kUsage!==253||this.isLegacyAEAD?(this.iv=e.subarray(t,t+M.getCipherParams(this.symmetric).blockSize),this.usedModernAEAD=!1):(this.iv=e.subarray(t,t+M.getAEADMode(this.aead).ivLength),this.usedModernAEAD=!0),t+=this.iv.length)}catch(s){if(!this.s2kUsage)throw s;this.unparseableKeyMaterial=e.subarray(i),this.isEncrypted=!0}if(this.version===5&&(t+=4),this.keyMaterial=e.subarray(t),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let s;if(this.version===6)s=this.keyMaterial;else if(s=this.keyMaterial.subarray(0,-2),!y.equalsUint8Array(y.writeChecksum(s),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{read:a,privateParams:o}=M.parsePrivateKeyParams(this.algorithm,s,this.publicParams);if(a<s.length)throw Error("Error reading MPIs");this.privateParams=o}catch(a){throw a instanceof Y?a:Error("Error reading MPIs")}}}write(){const e=this.writePublicKey();if(this.unparseableKeyMaterial)return y.concatUint8Array([e,this.unparseableKeyMaterial]);const r=[e];r.push(new Uint8Array([this.s2kUsage]));const t=[];if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){t.push(this.symmetric),this.s2kUsage===253&&t.push(this.aead);const i=this.s2k.write();this.version===6&&t.push(i.length),t.push(...i)}return this.s2kUsage&&this.s2k.type!=="gnu-dummy"&&t.push(...this.iv),(this.version===5||this.version===6&&this.s2kUsage)&&r.push(new Uint8Array([t.length])),r.push(new Uint8Array(t)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=M.serializeParams(this.algorithm,this.privateParams)),this.version===5&&r.push(y.writeNumber(this.keyMaterial.length,4)),r.push(this.keyMaterial),this.s2kUsage||this.version===6||r.push(y.writeChecksum(this.keyMaterial))),y.concatUint8Array(r)}isDecrypted(){return this.isEncrypted===!1}isMissingSecretKeyMaterial(){return this.unparseableKeyMaterial!==void 0||this.isDummy()}isDummy(){return!(!this.s2k||this.s2k.type!=="gnu-dummy")}makeDummy(e=L){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=pi(c.s2k.gnu,e),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=c.symmetric.aes256,this.isLegacyAEAD=null,this.usedModernAEAD=null)}async encrypt(e,r=L){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!e)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=Zu(r),this.s2k.generateSalt();const t=M.serializeParams(this.algorithm,this.privateParams);this.symmetric=c.symmetric.aes256;const{blockSize:i}=M.getCipherParams(this.symmetric);if(r.aeadProtect){this.s2kUsage=253,this.aead=r.preferredAEADAlgorithm;const s=M.getAEADMode(this.aead);this.isLegacyAEAD=this.version===5,this.usedModernAEAD=!this.isLegacyAEAD;const a=Yr(this.constructor.tag),o=await zn(this.version,this.s2k,e,this.symmetric,this.aead,a,this.isLegacyAEAD),u=await s(this.symmetric,o);this.iv=this.isLegacyAEAD?M.random.getRandomBytes(i):M.random.getRandomBytes(s.ivLength);const l=this.isLegacyAEAD?new Uint8Array:y.concatUint8Array([a,this.writePublicKey()]);this.keyMaterial=await u.encrypt(t,this.iv.subarray(0,s.ivLength),l)}else{this.s2kUsage=254,this.usedModernAEAD=!1;const s=await zn(this.version,this.s2k,e,this.symmetric);this.iv=M.random.getRandomBytes(i),this.keyMaterial=await M.mode.cfb.encrypt(this.symmetric,s,y.concatUint8Array([t,await M.hash.sha1(t,r)]),this.iv,r)}}async decrypt(e){if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let r;const t=Yr(this.constructor.tag);if(this.s2kUsage!==254&&this.s2kUsage!==253)throw this.s2kUsage===255?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");let i;if(r=await zn(this.version,this.s2k,e,this.symmetric,this.aead,t,this.isLegacyAEAD),this.s2kUsage===253){const s=M.getAEADMode(this.aead),a=await s(this.symmetric,r);try{const o=this.isLegacyAEAD?new Uint8Array:y.concatUint8Array([t,this.writePublicKey()]);i=await a.decrypt(this.keyMaterial,this.iv.subarray(0,s.ivLength),o)}catch(o){throw o.message==="Authentication tag mismatch"?Error("Incorrect key passphrase: "+o.message):o}}else{const s=await M.mode.cfb.decrypt(this.symmetric,r,this.keyMaterial,this.iv);i=s.subarray(0,-20);const a=await M.hash.sha1(i);if(!y.equalsUint8Array(a,s.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:s}=M.parsePrivateKeyParams(this.algorithm,i,this.publicParams);this.privateParams=s}catch{throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0,this.aead=null,this.symmetric=null,this.isLegacyAEAD=null}async validate(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");if(this.usedModernAEAD)return;let e;try{e=await M.validateParams(this.algorithm,this.publicParams,this.privateParams)}catch{e=!1}if(!e)throw Error("Key is invalid")}async generate(e,r){if(this.version===6&&(this.algorithm===c.publicKey.ecdh&&r===c.curve.curve25519Legacy||this.algorithm===c.publicKey.eddsaLegacy))throw Error(`Cannot generate v6 keys of type 'ecc' with curve ${r}. Generate a key of type 'curve25519' instead`);const{privateParams:t,publicParams:i}=await M.generateParams(this.algorithm,e,r);this.privateParams=t,this.publicParams=i,this.isEncrypted=!1}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach(e=>{this.privateParams[e].fill(0),delete this.privateParams[e]}),this.privateParams=null,this.isEncrypted=!0)}}async function zn(n,e,r,t,i,s,a){if(e.type==="argon2"&&!i)throw Error("Using Argon2 S2K without AEAD is not allowed");if(e.type==="simple"&&n===6)throw Error("Using Simple S2K with version 6 keys is not allowed");const{keySize:o}=M.getCipherParams(t),u=await e.produceKey(r,o);if(!i||n===5||a)return u;const l=y.concatUint8Array([s,new Uint8Array([n,t,i])]);return br(c.hash.sha256,u,new Uint8Array,l,o)}class vn{static get tag(){return c.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(e){if(y.isString(e)||e.name&&!y.isString(e.name)||e.email&&!y.isEmailAddress(e.email)||e.comment&&!y.isString(e.comment))throw Error("Invalid user ID format");const r=new vn;Object.assign(r,e);const t=[];return r.name&&t.push(r.name),r.comment&&t.push(`(${r.comment})`),r.email&&t.push(`<${r.email}>`),r.userID=t.join(" "),r}read(e,r=L){const t=y.decodeUTF8(e);if(t.length>r.maxUserIDLength)throw Error("User ID string is too long");const i=/^(?<name>[^()]+\s+)?(?<comment>\([^()]+\)\s+)?(?<email><\S+@\S+>)$/.exec(t);if(i!==null){const{name:s,comment:a,email:o}=i.groups;this.comment=a?.replace(/^\(|\)|\s$/g,"").trim()||"",this.name=s?.trim()||"",this.email=o.substring(1,o.length-1)}else/^[^\s@]+@[^\s@]+$/.test(t)&&(this.email=t);this.userID=t}write(){return y.encodeUTF8(this.userID)}equals(e){return e&&e.userID===this.userID}}class Ri extends Mi{static get tag(){return c.packet.secretSubkey}constructor(e=new Date,r=L){super(e,r)}}async function Ao(n,e){const r=new Ri(n.date,e);return r.packets=null,r.algorithm=c.write(c.publicKey,n.algorithm),await r.generate(n.rsaBits,n.curve),await r.computeFingerprintAndKeyID(),r}async function cl(n,e){const r=new Mi(n.date,e);return r.packets=null,r.algorithm=c.write(c.publicKey,n.algorithm),await r.generate(n.rsaBits,n.curve,n.config),await r.computeFingerprintAndKeyID(),r}async function Le(n,e,r,t,i=new Date,s){let a,o;for(let u=n.length-1;u>=0;u--)try{(!a||n[u].created>=a.created)&&(await n[u].verify(e,r,t,i,void 0,s),a=n[u])}catch(l){o=l}if(!a)throw y.wrapError(`Could not find valid ${c.read(c.signature,r)} signature in key ${e.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(u,l,h)=>l+" "+h.toLowerCase()),o);return a}function fi(n,e,r=new Date){const t=y.normalizeDate(r);if(t!==null){const i=an(n,e);return!(n.created<=t&&t<i)}return!1}async function So(n,e,r,t){const i={};i.key=e,i.bind=n;const s={signatureType:c.signature.subkeyBinding};return r.sign?(s.keyFlags=[c.keyFlags.signData],s.embeddedSignature=await lt(i,[],n,{signatureType:c.signature.keyBinding},r.date,void 0,void 0,void 0,t)):s.keyFlags=[c.keyFlags.encryptCommunication|c.keyFlags.encryptStorage],r.keyExpirationTime>0&&(s.keyExpirationTime=r.keyExpirationTime,s.keyNeverExpires=!1),await lt(i,[],e,s,r.date,void 0,void 0,void 0,t)}async function lt(n,e,r,t,i,s,a=[],o=!1,u){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");const l=new ut;return Object.assign(l,t),l.publicKeyAlgorithm=r.algorithm,l.hashAlgorithm=await async function(h,p,f=new Date,g=[],d){const m=c.hash.sha256,b=d.preferredHashAlgorithm,w=await Promise.all(h.map(async(U,C)=>(await U.getPrimarySelfSignature(f,g[C],d)).preferredHashAlgorithms)),v=new Map;for(const U of w)for(const C of U)try{const I=c.write(c.hash,C);v.set(I,v.has(I)?v.get(I)+1:1)}catch{}const E=U=>h.length===0||v.get(U)===h.length||U===m,A=()=>{if(v.size===0)return m;const U=Array.from(v.keys()).filter(C=>E(C)).sort((C,I)=>M.hash.getHashByteLength(C)-M.hash.getHashByteLength(I))[0];return M.hash.getHashByteLength(U)>=M.hash.getHashByteLength(m)?U:m};if(new Set([c.publicKey.ecdsa,c.publicKey.eddsaLegacy,c.publicKey.ed25519,c.publicKey.ed448]).has(p.algorithm)){const U=M.getPreferredCurveHashAlgo(p.algorithm,p.publicParams.oid),C=E(b),I=M.hash.getHashByteLength(b)>=M.hash.getHashByteLength(U);if(C&&I)return b;{const k=A();return M.hash.getHashByteLength(k)>=M.hash.getHashByteLength(U)?k:U}}return E(b)?b:A()}(e,r,i,s,u),l.rawNotations=[...a],await l.sign(r,n,i,o,u),l}async function Ot(n,e,r,t=new Date,i){(n=n[r])&&(e[r].length?await Promise.all(n.map(async function(s){s.isExpired(t)||i&&!await i(s)||e[r].some(function(a){return y.equalsUint8Array(a.writeParams(),s.writeParams())})||e[r].push(s)})):e[r]=n)}async function sr(n,e,r,t,i,s,a=new Date,o){s=s||n;const u=[];return await Promise.all(t.map(async function(l){try{if(!i||l.issuerKeyID.equals(i.issuerKeyID)){const h=![c.reasonForRevocation.keyRetired,c.reasonForRevocation.keySuperseded,c.reasonForRevocation.userIDInvalid].includes(l.reasonForRevocationFlag);await l.verify(s,e,r,h?null:a,!1,o),u.push(l.issuerKeyID)}}catch{}})),i?(i.revoked=!!u.some(l=>l.equals(i.issuerKeyID))||i.revoked||!1,i.revoked):u.length>0}function an(n,e){let r;return e.keyNeverExpires===!1&&(r=n.created.getTime()+1e3*e.keyExpirationTime),r?new Date(r):1/0}function gi(n,e={}){switch(n.type=n.type||e.type,n.curve=n.curve||e.curve,n.rsaBits=n.rsaBits||e.rsaBits,n.keyExpirationTime=n.keyExpirationTime!==void 0?n.keyExpirationTime:e.keyExpirationTime,n.passphrase=y.isString(n.passphrase)?n.passphrase:e.passphrase,n.date=n.date||e.date,n.sign=n.sign||!1,n.type){case"ecc":try{n.curve=c.write(c.curve,n.curve)}catch{throw Error("Unknown curve")}n.curve!==c.curve.ed25519Legacy&&n.curve!==c.curve.curve25519Legacy&&n.curve!=="ed25519"&&n.curve!=="curve25519"||(n.curve=n.sign?c.curve.ed25519Legacy:c.curve.curve25519Legacy),n.sign?n.algorithm=n.curve===c.curve.ed25519Legacy?c.publicKey.eddsaLegacy:c.publicKey.ecdsa:n.algorithm=c.publicKey.ecdh;break;case"curve25519":n.algorithm=n.sign?c.publicKey.ed25519:c.publicKey.x25519;break;case"curve448":n.algorithm=n.sign?c.publicKey.ed448:c.publicKey.x448;break;case"rsa":n.algorithm=c.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+n.type)}return n}function qs(n,e,r){switch(n.algorithm){case c.publicKey.rsaEncryptSign:case c.publicKey.rsaSign:case c.publicKey.dsa:case c.publicKey.ecdsa:case c.publicKey.eddsaLegacy:case c.publicKey.ed25519:case c.publicKey.ed448:if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!e.keyFlags||!!(e.keyFlags[0]&c.keyFlags.signData);default:return!1}}function Gs(n,e,r){switch(n.algorithm){case c.publicKey.rsaEncryptSign:case c.publicKey.rsaEncrypt:case c.publicKey.elgamal:case c.publicKey.ecdh:case c.publicKey.x25519:case c.publicKey.x448:if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!e.keyFlags||!!(e.keyFlags[0]&c.keyFlags.encryptCommunication)||!!(e.keyFlags[0]&c.keyFlags.encryptStorage);default:return!1}}function Ws(n,e,r){if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");switch(n.algorithm){case c.publicKey.rsaEncryptSign:case c.publicKey.rsaEncrypt:case c.publicKey.elgamal:case c.publicKey.ecdh:case c.publicKey.x25519:case c.publicKey.x448:return!(!(!e.keyFlags||e.keyFlags[0]&c.keyFlags.signData)||!r.allowInsecureDecryptionWithSigningKeys)||!e.keyFlags||!!(e.keyFlags[0]&c.keyFlags.encryptCommunication)||!!(e.keyFlags[0]&c.keyFlags.encryptStorage);default:return!1}}function vt(n,e){const r=c.write(c.publicKey,n.algorithm),t=n.getAlgorithmInfo();if(e.rejectPublicKeyAlgorithms.has(r))throw Error(t.algorithm+" keys are considered too weak.");switch(r){case c.publicKey.rsaEncryptSign:case c.publicKey.rsaSign:case c.publicKey.rsaEncrypt:if(t.bits<e.minRSABits)throw Error(`RSA keys shorter than ${e.minRSABits} bits are considered too weak.`);break;case c.publicKey.ecdsa:case c.publicKey.eddsaLegacy:case c.publicKey.ecdh:if(e.rejectCurves.has(t.curve))throw Error(`Support for ${t.algorithm} keys using curve ${t.curve} is disabled.`)}}class Ar{constructor(e,r){this.userID=e.constructor.tag===c.packet.userID?e:null,this.userAttribute=e.constructor.tag===c.packet.userAttribute?e:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=r}toPacketList(){const e=new Oe;return e.push(this.userID||this.userAttribute),e.push(...this.revocationSignatures),e.push(...this.selfCertifications),e.push(...this.otherCertifications),e}clone(){const e=new Ar(this.userID||this.userAttribute,this.mainKey);return e.selfCertifications=[...this.selfCertifications],e.otherCertifications=[...this.otherCertifications],e.revocationSignatures=[...this.revocationSignatures],e}async certify(e,r,t){const i=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:i},a=new Ar(s.userID||s.userAttribute,this.mainKey);return a.otherCertifications=await Promise.all(e.map(async function(o){if(!o.isPrivate())throw Error("Need private key for signing");if(o.hasSameFingerprintAs(i))throw Error("The user's own key can only be used for self-certifications");const u=await o.getSigningKey(void 0,r,void 0,t);return lt(s,[o],u.keyPacket,{signatureType:c.signature.certGeneric,keyFlags:[c.keyFlags.certifyKeys|c.keyFlags.signData]},r,void 0,void 0,void 0,t)})),await a.update(this,r,t),a}async isRevoked(e,r,t=new Date,i=L){const s=this.mainKey.keyPacket;return sr(s,c.signature.certRevocation,{key:s,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,e,r,t,i)}async verifyCertificate(e,r,t=new Date,i){const s=this,a=this.mainKey.keyPacket,o={userID:this.userID,userAttribute:this.userAttribute,key:a},{issuerKeyID:u}=e,l=r.filter(h=>h.getKeys(u).length>0);return l.length===0?null:(await Promise.all(l.map(async h=>{const p=await h.getSigningKey(u,e.created,void 0,i);if(e.revoked||await s.isRevoked(e,p.keyPacket,t,i))throw Error("User certificate is revoked");try{await e.verify(p.keyPacket,c.signature.certGeneric,o,t,void 0,i)}catch(f){throw y.wrapError("User certificate is invalid",f)}})),!0)}async verifyAllCertifications(e,r=new Date,t){const i=this,s=this.selfCertifications.concat(this.otherCertifications);return Promise.all(s.map(async a=>({keyID:a.issuerKeyID,valid:await i.verifyCertificate(a,e,r,t).catch(()=>!1)})))}async verify(e=new Date,r){if(!this.selfCertifications.length)throw Error("No self-certifications found");const t=this,i=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:i};let a;for(let o=this.selfCertifications.length-1;o>=0;o--)try{const u=this.selfCertifications[o];if(u.revoked||await t.isRevoked(u,void 0,e,r))throw Error("Self-certification is revoked");try{await u.verify(i,c.signature.certGeneric,s,e,void 0,r)}catch(l){throw y.wrapError("Self-certification is invalid",l)}return!0}catch(u){a=u}throw a}async update(e,r,t){const i=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:i};await Ot(e,this,"selfCertifications",r,async function(a){try{return await a.verify(i,c.signature.certGeneric,s,r,!1,t),!0}catch{return!1}}),await Ot(e,this,"otherCertifications",r),await Ot(e,this,"revocationSignatures",r,function(a){return sr(i,c.signature.certRevocation,s,[a],void 0,void 0,r,t)})}async revoke(e,{flag:r=c.reasonForRevocation.noReason,string:t=""}={},i=new Date,s=L){const a={userID:this.userID,userAttribute:this.userAttribute,key:e},o=new Ar(a.userID||a.userAttribute,this.mainKey);return o.revocationSignatures.push(await lt(a,[],e,{signatureType:c.signature.certRevocation,reasonForRevocationFlag:c.write(c.reasonForRevocation,r),reasonForRevocationString:t},i,void 0,void 0,!1,s)),await o.update(this),o}}class $t{constructor(e,r){this.keyPacket=e,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=r}toPacketList(){const e=new Oe;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.bindingSignatures),e}clone(){const e=new $t(this.keyPacket,this.mainKey);return e.bindingSignatures=[...this.bindingSignatures],e.revocationSignatures=[...this.revocationSignatures],e}async isRevoked(e,r,t=new Date,i=L){const s=this.mainKey.keyPacket;return sr(s,c.signature.subkeyRevocation,{key:s,bind:this.keyPacket},this.revocationSignatures,e,r,t,i)}async verify(e=new Date,r=L){const t=this.mainKey.keyPacket,i={key:t,bind:this.keyPacket},s=await Le(this.bindingSignatures,t,c.signature.subkeyBinding,i,e,r);if(s.revoked||await this.isRevoked(s,null,e,r))throw Error("Subkey is revoked");if(fi(this.keyPacket,s,e))throw Error("Subkey is expired");return s}async getExpirationTime(e=new Date,r=L){const t=this.mainKey.keyPacket,i={key:t,bind:this.keyPacket};let s;try{s=await Le(this.bindingSignatures,t,c.signature.subkeyBinding,i,e,r)}catch{return null}const a=an(this.keyPacket,s),o=s.getExpirationTime();return a<o?a:o}async update(e,r=new Date,t=L){const i=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(e))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===c.packet.publicSubkey&&e.keyPacket.constructor.tag===c.packet.secretSubkey&&(this.keyPacket=e.keyPacket);const s=this,a={key:i,bind:s.keyPacket};await Ot(e,this,"bindingSignatures",r,async function(o){for(let u=0;u<s.bindingSignatures.length;u++)if(s.bindingSignatures[u].issuerKeyID.equals(o.issuerKeyID))return o.created>s.bindingSignatures[u].created&&(s.bindingSignatures[u]=o),!1;try{return await o.verify(i,c.signature.subkeyBinding,a,r,void 0,t),!0}catch{return!1}}),await Ot(e,this,"revocationSignatures",r,function(o){return sr(i,c.signature.subkeyRevocation,a,[o],void 0,void 0,r,t)})}async revoke(e,{flag:r=c.reasonForRevocation.noReason,string:t=""}={},i=new Date,s=L){const a={key:e,bind:this.keyPacket},o=new $t(this.keyPacket,this.mainKey);return o.revocationSignatures.push(await lt(a,[],e,{signatureType:c.signature.subkeyRevocation,reasonForRevocationFlag:c.write(c.reasonForRevocation,r),reasonForRevocationString:t},i,void 0,void 0,!1,s)),await o.update(this),o}hasSameFingerprintAs(e){return this.keyPacket.hasSameFingerprintAs(e.keyPacket||e)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(n=>{$t.prototype[n]=function(){return this.keyPacket[n]()}});const ul=y.constructAllowedPackets([ut]),Vs=new Set([c.packet.publicKey,c.packet.privateKey]),Qs=new Set([c.packet.publicKey,c.packet.privateKey,c.packet.publicSubkey,c.packet.privateSubkey]);class Eo{packetListToStructure(e,r=new Set){let t,i,s,a;for(const o of e){if(o instanceof li){Qs.has(o.tag)&&!a&&(a=Vs.has(o.tag)?Vs:Qs);continue}const u=o.constructor.tag;if(a){if(!a.has(u))continue;a=null}if(r.has(u))throw Error("Unexpected packet type: "+u);switch(u){case c.packet.publicKey:case c.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=o,i=this.getKeyID(),!i)throw Error("Missing Key ID");break;case c.packet.userID:case c.packet.userAttribute:t=new Ar(o,this),this.users.push(t);break;case c.packet.publicSubkey:case c.packet.secretSubkey:t=null,s=new $t(o,this),this.subkeys.push(s);break;case c.packet.signature:switch(o.signatureType){case c.signature.certGeneric:case c.signature.certPersona:case c.signature.certCasual:case c.signature.certPositive:if(!t){y.printDebug("Dropping certification signatures without preceding user packet");continue}o.issuerKeyID.equals(i)?t.selfCertifications.push(o):t.otherCertifications.push(o);break;case c.signature.certRevocation:t?t.revocationSignatures.push(o):this.directSignatures.push(o);break;case c.signature.key:this.directSignatures.push(o);break;case c.signature.subkeyBinding:if(!s){y.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}s.bindingSignatures.push(o);break;case c.signature.keyRevocation:this.revocationSignatures.push(o);break;case c.signature.subkeyRevocation:if(!s){y.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}s.revocationSignatures.push(o)}}}}toPacketList(){const e=new Oe;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.directSignatures),this.users.map(r=>e.push(...r.toPacketList())),this.subkeys.map(r=>e.push(...r.toPacketList())),e}clone(e=!1){const r=new this.constructor(this.toPacketList());return e&&r.getKeys().forEach(t=>{if(t.keyPacket=Object.create(Object.getPrototypeOf(t.keyPacket),Object.getOwnPropertyDescriptors(t.keyPacket)),!t.keyPacket.isDecrypted())return;const i={};Object.keys(t.keyPacket.privateParams).forEach(s=>{i[s]=new Uint8Array(t.keyPacket.privateParams[s])}),t.keyPacket.privateParams=i}),r}getSubkeys(e=null){return this.subkeys.filter(r=>!e||r.getKeyID().equals(e,!0))}getKeys(e=null){const r=[];return e&&!this.getKeyID().equals(e,!0)||r.push(this),r.concat(this.getSubkeys(e))}getKeyIDs(){return this.getKeys().map(e=>e.getKeyID())}getUserIDs(){return this.users.map(e=>e.userID?e.userID.userID:null).filter(e=>e!==null)}write(){return this.toPacketList().write()}async getSigningKey(e=null,r=new Date,t={},i=L){await this.verifyPrimaryKey(r,t,i);const s=this.keyPacket;try{vt(s,i)}catch(u){throw y.wrapError("Could not verify primary key",u)}const a=this.subkeys.slice().sort((u,l)=>l.keyPacket.created-u.keyPacket.created);let o;for(const u of a)if(!e||u.getKeyID().equals(e))try{await u.verify(r,i);const l={key:s,bind:u.keyPacket},h=await Le(u.bindingSignatures,s,c.signature.subkeyBinding,l,r,i);if(!qs(u.keyPacket,h,i))continue;if(!h.embeddedSignature)throw Error("Missing embedded signature");return await Le([h.embeddedSignature],u.keyPacket,c.signature.keyBinding,l,r,i),vt(u.keyPacket,i),u}catch(l){o=l}try{const u=await this.getPrimarySelfSignature(r,t,i);if((!e||s.getKeyID().equals(e))&&qs(s,u,i))return vt(s,i),this}catch(u){o=u}throw y.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),o)}async getEncryptionKey(e,r=new Date,t={},i=L){await this.verifyPrimaryKey(r,t,i);const s=this.keyPacket;try{vt(s,i)}catch(u){throw y.wrapError("Could not verify primary key",u)}const a=this.subkeys.slice().sort((u,l)=>l.keyPacket.created-u.keyPacket.created);let o;for(const u of a)if(!e||u.getKeyID().equals(e))try{await u.verify(r,i);const l={key:s,bind:u.keyPacket},h=await Le(u.bindingSignatures,s,c.signature.subkeyBinding,l,r,i);if(Gs(u.keyPacket,h,i))return vt(u.keyPacket,i),u}catch(l){o=l}try{const u=await this.getPrimarySelfSignature(r,t,i);if((!e||s.getKeyID().equals(e))&&Gs(s,u,i))return vt(s,i),this}catch(u){o=u}throw y.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),o)}async isRevoked(e,r,t=new Date,i=L){return sr(this.keyPacket,c.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,e,r,t,i)}async verifyPrimaryKey(e=new Date,r={},t=L){const i=this.keyPacket;if(await this.isRevoked(null,null,e,t))throw Error("Primary key is revoked");if(fi(i,await this.getPrimarySelfSignature(e,r,t),e))throw Error("Primary key is expired");if(i.version!==6){const s=await Le(this.directSignatures,i,c.signature.key,{key:i},e,t).catch(()=>{});if(s&&fi(i,s,e))throw Error("Primary key is expired")}}async getExpirationTime(e,r=L){let t;try{const i=await this.getPrimarySelfSignature(null,e,r),s=an(this.keyPacket,i),a=i.getExpirationTime(),o=this.keyPacket.version!==6&&await Le(this.directSignatures,this.keyPacket,c.signature.key,{key:this.keyPacket},null,r).catch(()=>{});if(o){const u=an(this.keyPacket,o);t=Math.min(s,a,u)}else t=s<a?s:a}catch{t=null}return y.normalizeDate(t)}async getPrimarySelfSignature(e=new Date,r={},t=L){const i=this.keyPacket;if(i.version===6)return Le(this.directSignatures,i,c.signature.key,{key:i},e,t);const{selfCertification:s}=await this.getPrimaryUser(e,r,t);return s}async getPrimaryUser(e=new Date,r={},t=L){const i=this.keyPacket,s=[];let a;for(let h=0;h<this.users.length;h++)try{const p=this.users[h];if(!p.userID)continue;if(r.name!==void 0&&p.userID.name!==r.name||r.email!==void 0&&p.userID.email!==r.email||r.comment!==void 0&&p.userID.comment!==r.comment)throw Error("Could not find user that matches that user ID");const f={userID:p.userID,key:i},g=await Le(p.selfCertifications,i,c.signature.certGeneric,f,e,t);s.push({index:h,user:p,selfCertification:g})}catch(p){a=p}if(!s.length)throw a||Error("Could not find primary user");await Promise.all(s.map(async function(h){return h.selfCertification.revoked||h.user.isRevoked(h.selfCertification,null,e,t)}));const o=s.sort(function(h,p){const f=h.selfCertification,g=p.selfCertification;return g.revoked-f.revoked||f.isPrimaryUserID-g.isPrimaryUserID||f.created-g.created}).pop(),{user:u,selfCertification:l}=o;if(l.revoked||await u.isRevoked(l,null,e,t))throw Error("Primary user is revoked");return o}async update(e,r=new Date,t=L){if(!this.hasSameFingerprintAs(e))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&e.isPrivate()){if(!(this.subkeys.length===e.subkeys.length&&this.subkeys.every(s=>e.subkeys.some(a=>s.hasSameFingerprintAs(a)))))throw Error("Cannot update public key with private key if subkeys mismatch");return e.update(this,t)}const i=this.clone();return await Ot(e,i,"revocationSignatures",r,s=>sr(i.keyPacket,c.signature.keyRevocation,i,[s],null,e.keyPacket,r,t)),await Ot(e,i,"directSignatures",r),await Promise.all(e.users.map(async s=>{const a=i.users.filter(o=>s.userID&&s.userID.equals(o.userID)||s.userAttribute&&s.userAttribute.equals(o.userAttribute));if(a.length>0)await Promise.all(a.map(o=>o.update(s,r,t)));else{const o=s.clone();o.mainKey=i,i.users.push(o)}})),await Promise.all(e.subkeys.map(async s=>{const a=i.subkeys.filter(o=>o.hasSameFingerprintAs(s));if(a.length>0)await Promise.all(a.map(o=>o.update(s,r,t)));else{const o=s.clone();o.mainKey=i,i.subkeys.push(o)}})),i}async getRevocationCertificate(e=new Date,r=L){const t={key:this.keyPacket},i=await Le(this.revocationSignatures,this.keyPacket,c.signature.keyRevocation,t,e,r),s=new Oe;s.push(i);const a=this.keyPacket.version!==6;return Ei(c.armor.publicKey,s.write(),null,null,"This is a revocation certificate",a,r)}async applyRevocationCertificate(e,r=new Date,t=L){const i=await xa(e),s=(await Oe.fromBinary(i.data,ul,t)).findPacket(c.packet.signature);if(!s||s.signatureType!==c.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!s.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await s.verify(this.keyPacket,c.signature.keyRevocation,{key:this.keyPacket},r,void 0,t)}catch(o){throw y.wrapError("Could not verify revocation signature",o)}const a=this.clone();return a.revocationSignatures.push(s),a}async signPrimaryUser(e,r,t,i=L){const{index:s,user:a}=await this.getPrimaryUser(r,t,i),o=await a.certify(e,r,i),u=this.clone();return u.users[s]=o,u}async signAllUsers(e,r=new Date,t=L){const i=this.clone();return i.users=await Promise.all(this.users.map(function(s){return s.certify(e,r,t)})),i}async verifyPrimaryUser(e,r=new Date,t,i=L){const s=this.keyPacket,{user:a}=await this.getPrimaryUser(r,t,i);return e?await a.verifyAllCertifications(e,r,i):[{keyID:s.getKeyID(),valid:await a.verify(r,i).catch(()=>!1)}]}async verifyAllUsers(e,r=new Date,t=L){const i=this.keyPacket,s=[];return await Promise.all(this.users.map(async a=>{const o=e?await a.verifyAllCertifications(e,r,t):[{keyID:i.getKeyID(),valid:await a.verify(r,t).catch(()=>!1)}];s.push(...o.map(u=>({userID:a.userID?a.userID.userID:null,userAttribute:a.userAttribute,keyID:u.keyID,valid:u.valid})))})),s}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(n=>{Eo.prototype[n]=$t.prototype[n]});class Zs extends Eo{constructor(e){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],e&&(this.packetListToStructure(e,new Set([c.packet.secretKey,c.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(e=L){const r=this.keyPacket.version!==6;return Ei(c.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,r,e)}}class An extends Zs{constructor(e){if(super(),this.packetListToStructure(e,new Set([c.packet.publicKey,c.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const e=new Oe,r=this.toPacketList();for(const t of r)switch(t.constructor.tag){case c.packet.secretKey:{const i=Je.fromSecretKeyPacket(t);e.push(i);break}case c.packet.secretSubkey:{const i=kn.fromSecretSubkeyPacket(t);e.push(i);break}default:e.push(t)}return new Zs(e)}armor(e=L){const r=this.keyPacket.version!==6;return Ei(c.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,r,e)}async getDecryptionKeys(e,r=new Date,t={},i=L){const s=this.keyPacket,a=[];let o=null;for(let l=0;l<this.subkeys.length;l++)if(!e||this.subkeys[l].getKeyID().equals(e,!0)){if(this.subkeys[l].keyPacket.isDummy()){o=o||Error("Gnu-dummy key packets cannot be used for decryption");continue}try{const h={key:s,bind:this.subkeys[l].keyPacket},p=await Le(this.subkeys[l].bindingSignatures,s,c.signature.subkeyBinding,h,r,i);Ws(this.subkeys[l].keyPacket,p,i)&&a.push(this.subkeys[l])}catch(h){o=h}}const u=await this.getPrimarySelfSignature(r,t,i);if(e&&!s.getKeyID().equals(e,!0)||!Ws(s,u,i)||(s.isDummy()?o=o||Error("Gnu-dummy key packets cannot be used for decryption"):a.push(this)),a.length===0)throw o||Error("No decryption key packets found");return a}isDecrypted(){return this.getKeys().some(({keyPacket:e})=>e.isDecrypted())}async validate(e=L){if(!this.isPrivate())throw Error("Cannot validate a public key");let r;if(this.keyPacket.isDummy()){const t=await this.getSigningKey(null,null,void 0,{...e,rejectPublicKeyAlgorithms:new Set,minRSABits:0});t&&!t.keyPacket.isDummy()&&(r=t.keyPacket)}else r=this.keyPacket;if(r)return r.validate();{const t=this.getKeys();if(t.map(i=>i.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(t.map(async i=>i.keyPacket.validate()))}}clearPrivateParams(){this.getKeys().forEach(({keyPacket:e})=>{e.isDecrypted()&&e.clearPrivateParams()})}async revoke({flag:e=c.reasonForRevocation.noReason,string:r=""}={},t=new Date,i=L){if(!this.isPrivate())throw Error("Need private key for revoking");const s={key:this.keyPacket},a=this.clone();return a.revocationSignatures.push(await lt(s,[],this.keyPacket,{signatureType:c.signature.keyRevocation,reasonForRevocationFlag:c.write(c.reasonForRevocation,e),reasonForRevocationString:r},t,void 0,void 0,void 0,i)),a}async addSubkey(e={}){const r={...L,...e.config};if(e.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(e.rsaBits<r.minRSABits)throw Error(`rsaBits should be at least ${r.minRSABits}, got: ${e.rsaBits}`);const t=this.keyPacket;if(t.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!t.isDecrypted())throw Error("Key is not decrypted");const i=t.getAlgorithmInfo();i.type=function(u){switch(c.write(c.publicKey,u)){case c.publicKey.rsaEncrypt:case c.publicKey.rsaEncryptSign:case c.publicKey.rsaSign:case c.publicKey.dsa:return"rsa";case c.publicKey.ecdsa:case c.publicKey.eddsaLegacy:return"ecc";case c.publicKey.ed25519:return"curve25519";case c.publicKey.ed448:return"curve448";default:throw Error("Unsupported algorithm")}}(i.algorithm),i.rsaBits=i.bits||4096,i.curve=i.curve||"curve25519Legacy",e=gi(e,i);const s=await Ao(e,{...r,v6Keys:this.keyPacket.version===6});vt(s,r);const a=await So(s,t,e,r),o=this.toPacketList();return o.push(s,a),new An(o)}}const ll=y.constructAllowedPackets([Je,kn,Mi,Ri,vn,Li,ut]);async function Po(n,e,r,t){r.passphrase&&await n.encrypt(r.passphrase,t),await Promise.all(e.map(async function(u,l){const h=r.subkeys[l].passphrase;h&&await u.encrypt(h,t)}));const i=new Oe;function s(u,l){return[l,...u.filter(h=>h!==l)]}function a(){const u={};u.keyFlags=[c.keyFlags.certifyKeys|c.keyFlags.signData];const l=s([c.symmetric.aes256,c.symmetric.aes128],t.preferredSymmetricAlgorithm);if(u.preferredSymmetricAlgorithms=l,t.aeadProtect){const h=s([c.aead.gcm,c.aead.eax,c.aead.ocb],t.preferredAEADAlgorithm);u.preferredCipherSuites=h.flatMap(p=>l.map(f=>[f,p]))}return u.preferredHashAlgorithms=s([c.hash.sha256,c.hash.sha512,c.hash.sha3_256,c.hash.sha3_512],t.preferredHashAlgorithm),u.preferredCompressionAlgorithms=s([c.compression.uncompressed,c.compression.zlib,c.compression.zip],t.preferredCompressionAlgorithm),u.features=[0],u.features[0]|=c.features.modificationDetection,t.aeadProtect&&(u.features[0]|=c.features.seipdv2),r.keyExpirationTime>0&&(u.keyExpirationTime=r.keyExpirationTime,u.keyNeverExpires=!1),u}if(i.push(n),n.version===6){const u={key:n},l=a();l.signatureType=c.signature.key;const h=await lt(u,[],n,l,r.date,void 0,void 0,void 0,t);i.push(h)}await Promise.all(r.userIDs.map(async function(u,l){const h=vn.fromObject(u),p={userID:h,key:n},f=n.version!==6?a():{};return f.signatureType=c.signature.certPositive,l===0&&(f.isPrimaryUserID=!0),{userIDPacket:h,signaturePacket:await lt(p,[],n,f,r.date,void 0,void 0,void 0,t)}})).then(u=>{u.forEach(({userIDPacket:l,signaturePacket:h})=>{i.push(l),i.push(h)})}),await Promise.all(e.map(async function(u,l){const h=r.subkeys[l];return{secretSubkeyPacket:u,subkeySignaturePacket:await So(u,n,h,t)}})).then(u=>{u.forEach(({secretSubkeyPacket:l,subkeySignaturePacket:h})=>{i.push(l),i.push(h)})});const o={key:n};return i.push(await lt(o,[],n,{signatureType:c.signature.keyRevocation,reasonForRevocationFlag:c.reasonForRevocation.noReason,reasonForRevocationString:""},r.date,void 0,void 0,void 0,t)),r.passphrase&&n.clearPrivateParams(),await Promise.all(e.map(async function(u,l){r.subkeys[l].passphrase&&u.clearPrivateParams()})),new An(i)}async function Ko({armoredKey:n,binaryKey:e,config:r,...t}){if(r={...L,...r},!n&&!e)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(n&&!y.isString(n))throw Error("readPrivateKey: options.armoredKey must be a string");if(e&&!y.isUint8Array(e))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");const i=Object.keys(t);if(i.length>0)throw Error("Unknown option: "+i.join(", "));let s;if(n){const{type:u,data:l}=await xa(n);if(u!==c.armor.privateKey)throw Error("Armored text not of type private key");s=l}else s=e;const a=await Oe.fromBinary(s,ll,r),o=a.indexOfTag(c.packet.publicKey,c.packet.secretKey);for(let u=0;u<o.length;u++){if(a[o[u]].constructor.tag===c.packet.publicKey)continue;const l=a.slice(o[u],o[u+1]);return new An(l)}throw Error("No secret key packet found")}async function hl({userIDs:n=[],passphrase:e,type:r,curve:t,rsaBits:i=4096,keyExpirationTime:s=0,date:a=new Date,subkeys:o=[{}],format:u="armored",config:l,...h}){Io(l={...L,...l}),r||t?(r=r||"ecc",t=t||"curve25519Legacy"):(r=l.v6Keys?"curve25519":"ecc",t="curve25519Legacy"),n=Do(n);const p=Object.keys(h);if(p.length>0)throw Error("Unknown option: "+p.join(", "));if(n.length===0&&!l.v6Keys)throw Error("UserIDs are required for V4 keys");if(r==="rsa"&&i<l.minRSABits)throw Error(`rsaBits should be at least ${l.minRSABits}, got: ${i}`);const f={userIDs:n,passphrase:e,type:r,rsaBits:i,curve:t,keyExpirationTime:s,date:a,subkeys:o};try{const{key:g,revocationCertificate:d}=await async function(m,b){m.sign=!0,(m=gi(m)).subkeys=m.subkeys.map((U,C)=>gi(m.subkeys[C],m));let w=[cl(m,b)];w=w.concat(m.subkeys.map(U=>Ao(U,b)));const v=await Promise.all(w),E=await Po(v[0],v.slice(1),m,b),A=await E.getRevocationCertificate(m.date,b);return E.revocationSignatures=[],{key:E,revocationCertificate:A}}(f,l);return g.getKeys().forEach(({keyPacket:m})=>vt(m,l)),{privateKey:on(g,u,l),publicKey:on(g.toPublic(),u,l),revocationCertificate:d}}catch(g){throw y.wrapError("Error generating keypair",g)}}async function Uo({privateKey:n,userIDs:e=[],passphrase:r,keyExpirationTime:t=0,date:i,format:s="armored",config:a,...o}){Io(a={...L,...a}),e=Do(e);const u=Object.keys(o);if(u.length>0)throw Error("Unknown option: "+u.join(", "));if(e.length===0&&n.keyPacket.version!==6)throw Error("UserIDs are required for V4 keys");const l={privateKey:n,userIDs:e,passphrase:r,keyExpirationTime:t,date:i};try{const{key:h,revocationCertificate:p}=await async function(f,g){f=E(f);const{privateKey:d}=f;if(!d.isPrivate())throw Error("Cannot reformat a public key");if(d.keyPacket.isDummy())throw Error("Cannot reformat a gnu-dummy primary key");if(!d.getKeys().every(({keyPacket:A})=>A.isDecrypted()))throw Error("Key is not decrypted");const m=d.keyPacket;f.subkeys||(f.subkeys=await Promise.all(d.subkeys.map(async A=>{const U=A.keyPacket,C={key:m,bind:U},I=await Le(A.bindingSignatures,m,c.signature.subkeyBinding,C,null,g).catch(()=>({}));return{sign:I.keyFlags&&I.keyFlags[0]&c.keyFlags.signData}})));const b=d.subkeys.map(A=>A.keyPacket);if(f.subkeys.length!==b.length)throw Error("Number of subkey options does not match number of subkeys");f.subkeys=f.subkeys.map(A=>E(A,f));const w=await Po(m,b,f,g),v=await w.getRevocationCertificate(f.date,g);return w.revocationSignatures=[],{key:w,revocationCertificate:v};function E(A,U={}){return A.keyExpirationTime=A.keyExpirationTime||U.keyExpirationTime,A.passphrase=y.isString(A.passphrase)?A.passphrase:U.passphrase,A.date=A.date||U.date,A}}(l,a);return{privateKey:on(h,s,a),publicKey:on(h.toPublic(),s,a),revocationCertificate:p}}catch(h){throw y.wrapError("Error reformatting keypair",h)}}const yl=Object.keys(L).length;function Io(n){const e=Object.keys(n);if(e.length!==yl){for(const r of e)if(L[r]===void 0)throw Error("Unknown config property: "+r)}}function Do(n){return n&&!y.isArray(n)&&(n=[n]),n}function on(n,e,r){switch(e){case"object":return n;case"armored":return n.armor(r);case"binary":return n.write();default:throw Error("Unsupported format "+e)}}/*! @gera2ld/tarjs v0.3.1 | MIT License */const pl=new TextEncoder,Co=n=>pl.encode(n);new TextDecoder;function fl(n){return typeof n=="string"?Co(n).buffer:n instanceof ArrayBuffer?n:ArrayBuffer.isView(n)?new Uint8Array(n).buffer:n.arrayBuffer()}let di=function(n){return n[n.File=0]="File",n[n.Dir=53]="Dir",n}({});class gl{#e;constructor(){this.#e=[]}addFile(e,r,t){const i=fl(r),s=i.byteLength??r.size,a={name:e,type:di.File,data:i,size:s,opts:t};this.#e.push(a)}addFolder(e,r){this.#e.push({name:e,type:di.Dir,data:null,size:0,opts:r})}async write(){const e=dl(this.#e),r=new Uint8Array(e);let t=0;for(const i of this.#e){ml(e,i.name,t),wl(e,i.type,t),bl(e,i.size,t),Ul(e,t,i.opts,i.type),Kl(e,t);const s=await i.data;if(s){const a=new Uint8Array(s);r.set(a,t+512)}t+=512+512*Math.floor((i.size+511)/512)}return new Blob([e],{type:"application/x-tar"})}}function dl(n){const e=n.reduce((t,i)=>t+512+512*Math.floor((i.size+511)/512),0),r=10240*Math.floor((e+10240-1)/10240);return new ArrayBuffer(r)}function _e(n,e,r,t){const i=Co(e),s=new Uint8Array(n,r,t);for(let a=0;a<t;a+=1)s[a]=a<i.length?i[a]:0}function ml(n,e,r){_e(n,e,r,100)}function wl(n,e,r){const t=new Uint8Array(n,r+156,1);t[0]=e}function bl(n,e,r){const t=e.toString(8).padStart(11,"0");_e(n,t,r+124,12)}function kl(n,e,r){_e(n,e.toString(8).padStart(7,"0"),r+100,8)}function vl(n,e,r){_e(n,e.toString(8).padStart(7,"0"),r+108,8)}function Al(n,e,r){_e(n,e.toString(8).padStart(7,"0"),r+116,8)}function Sl(n,e,r){_e(n,e.toString(8).padStart(11,"0"),r+136,12)}function El(n,e,r){_e(n,e,r+265,32)}function Pl(n,e,r){_e(n,e,r+297,32)}function Kl(n,e){const r=new Uint8Array(n,e,512);for(let i=0;i<8;i+=1)r[148+i]=32;let t=0;for(let i=0;i<512;i+=1)t+=r[i];_e(n,t.toString(8).padEnd(8," "),e+148,8)}function Ul(n,e,r,t){const{uid:i,gid:s,mode:a,mtime:o,user:u,group:l}={uid:1e3,gid:1e3,mode:t===di.File?436:509,mtime:~~(Date.now()/1e3),user:"gera2ld",group:"tarjs",...r};kl(n,a,e),vl(n,i,e),Al(n,s,e),Sl(n,o,e),_e(n,"ustar",e+257,6),_e(n,"00",e+263,2),El(n,u,e),Pl(n,l,e)}const Il=`#version 300 es
in vec4 pos;void main(){gl_Position=pos;}`,Dl=`#version 300 es
precision highp float;precision highp int;
#define ROTL(x,n)(((x)<<(n))|((x)>>(32-(n))))
#define __INJECTS__
#ifdef __INJECTS__
#define LENGTH (0)
#define FILTER(h)(false)
#endif
uniform uint width,height,iteration,hashData[LENGTH];out vec4 outColor;void main(){uint i[LENGTH];for(int f=0;f<LENGTH;f++)i[f]=hashData[f];uint u=i[1],f=width*height;for(uint h=0u;h<iteration;h++){i[1]=u-h*f-uint(gl_FragCoord.x)-uint(gl_FragCoord.y)*width;if(i[1]>u)break;uint n[]=uint[](1732584193u,4023233417u,2562383102u,271733878u,3285377520u);for(int f=0;f<LENGTH/16;f++){uint h[80];for(int n=0;n<16;n++)h[n]=i[f*16+n];for(int f=16;f<80;f++)h[f]=ROTL(h[f-3]^h[f-8]^h[f-14]^h[f-16],1);uint u=n[0],t=n[1],R=n[2],r=n[3],v=n[4],x,C,H;for(int f=0;f<80;f++)C=f<20?x=r^t&(R^r),1518500249u:f<40?x=t^R^r,1859775393u:f<60?x=t&R|t&r|R&r,2400959708u:(x=t^R^r,3395469782u),H=ROTL(u,5)+x+v+C+h[f],v=r,r=R,R=ROTL(t,30),t=u,u=H;n[0]+=u;n[1]+=t;n[2]+=R;n[3]+=r;n[4]+=v;}if(FILTER(n)){outColor=vec4(float(i[1]>>0&255u)/255.,float(i[1]>>8&255u)/255.,float(i[1]>>16&255u)/255.,float(i[1]>>24&255u)/255.);return;}}outColor=vec4(0);}`,Cl=async(n,e)=>(n=await Ko({armoredKey:n.armor()}),await Promise.all([n.keyPacket,...n.subkeys.map(r=>r.keyPacket)].map(r=>(r.created=e,r.computeFingerprintAndKeyID()))),await Uo({privateKey:n,userIDs:n.users.map(r=>r.userID),date:e,format:"object"})),xl=n=>((n&255)<<24|(n&65280)<<8|n>>8&65280|n>>24&255)>>>0,Xs=n=>{if(n=n.replaceAll(" ",""),n.length!=40)throw new Error("Invalid pattern");return[...[0,8,16,24,32].map((e,r)=>{const t=n.substring(e,e+8);let i="",s="",a=!1;for(let o=0;o<8;o++)t[o].match(/[\da-f]/gi)?(i+="F",s+=t[o].toUpperCase(),a=!0):(i+="0",s+="0");return a?`(h[${r}] & 0x${i}u) == 0x${s}u`:""}),...n.split("").map((e,r)=>e.toUpperCase()==="X"?r:null).filter(Boolean).reduce((e,r,t,i)=>{const s=Math.floor(i[t-1]/8),a=Math.floor(r/8),o=7-i[t-1]%8,u=7-r%8;return t&&e.push(`((h[${s}] ${u>o?"<<":">>"} ${Math.abs(u-o)*4}) & 0xF${"0".repeat(u)}u) == (h[${a}] & 0xF${"0".repeat(u)}u)`),e},[])].filter(Boolean).join(" && ")||"true"},Bl=async(n,e,r,t,i=()=>{},s=()=>!1,a=!1)=>{const o=Math.round(Math.sqrt(r)),u=new OffscreenCanvas(o,o),l=u.getContext("webgl2");let h=!1,p,f,g=new Uint8Array,d=new Uint8Array,m=new ArrayBuffer(0),b=new Uint8Array,w=new Uint32Array;const v=new ArrayBuffer(u.width*u.height*4),E=new Uint8Array(v),A=new Uint32Array(v);let U=0;const C=performance.now();return await new Promise((I,k)=>{const S=async()=>{try{if(l.isContextLost())throw new Error("WebGL context lost");const D=await hl({...n,format:"object"});if(g=(a?D.publicKey.subkeys[0]:D.publicKey).keyPacket.write(),!h){d=new Uint8Array(g.length+3),d[0]=153,m=new ArrayBuffer(Math.ceil((d.length+1+8)/64)*64),b=new Uint8Array(m),w=new Uint32Array(m);const K=l.createShader(l.VERTEX_SHADER),x=l.createShader(l.FRAGMENT_SHADER);l.shaderSource(K,Il),l.shaderSource(x,Dl.replaceAll("#define __INJECTS__",Object.entries({"FILTER(h)":e,LENGTH:w.length}).map(([V,ce])=>`#define ${V} (${ce})`).join(`
`))),l.compileShader(K),l.compileShader(x),p=l.createProgram(),l.attachShader(p,K),l.attachShader(p,x),l.linkProgram(p),l.useProgram(p),l.uniform1ui(l.getUniformLocation(p,"width"),u.width),l.uniform1ui(l.getUniformLocation(p,"height"),u.height),l.uniform1ui(l.getUniformLocation(p,"iteration"),t),f=l.getUniformLocation(p,"hashData");const G=l.getAttribLocation(p,"pos");l.enableVertexAttribArray(G),l.bindBuffer(l.ARRAY_BUFFER,l.createBuffer()),l.bufferData(l.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),l.STATIC_DRAW),l.vertexAttribPointer(G,2,l.FLOAT,!1,0,0),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT),h=!0}d.set([g.length>>8&255,g.length&255],1),d.set(g,3),w[d.length>>2]=0,b.set(d),b[d.length]=128;for(let K=0;K<w.length;K++)w[K]=xl(w[K]);w[w.length-1]=d.length*8,l.uniform1uiv(f,w);let P=0;l.drawArrays(l.TRIANGLES,0,6),l.readPixels(0,0,u.width,u.height,l.RGBA,l.UNSIGNED_BYTE,E);for(let K=0;K<A.length;K++)if(A[K]){P=A[K];break}U+=Math.min(Math.floor(Date.now()/1e3),o*o*t),i(U,performance.now()-C),P?I(await Cl(D.privateKey,new Date(P*1e3))):s(U,performance.now()-C)?I(void 0):setTimeout(S,0)}catch(D){k(D)}};setTimeout(S,0)})},Tl="data:audio/ogg;base64,T2dnUwACAAAAAAAAAACINwAAAAAAACdKrQABE09wdXNIZWFkAQI4AUSsAAAAAABPZ2dTAAAAAAAAAAAAAIg3AAABAAAAIhsOmgFPT3B1c1RhZ3M/AAAAbGlib3B1cyAxLjMuMS0xNTgtZ2JjZTFmMzkyLCBsaWJvcHVzZW5jIDAuMi4xLTE0LWdmNTFjM2FhLWRpcnR5AAAAAE9nZ1MAAIC7AAAAAAAAiDcAAAIAAACCtYTOMg4gJy0SFCoqJCgnICkgIyEiIyMhHSMeIyQiHSAfJCEeIR0cIyAgICEeHSMgIB0eIxkbaAvkwTbsxY2MSUhCbNBIgAJ/wFoICGrVNJtHGCG/y4s/cumjd1AWCabaS3AFEEiI7GedO4W8JnSetfb2Fj6YqIF6R51/9u27fA2k5e6CLlI3jOuB4UiJGwo1HXqrfyG9u5taxt7BQQrzkNEA+2yDZ/EErNUcegIwdV/qPHZ8IG31UEiHODQDlzIIkEtVbiIYnIxXgEiAFKWvb3VlJyWmK55ukQUS8siASJZQ6mX5ZBEnKZqAchhAj5K3bP7JpfBvNOX/bY/3lq6EdUxUhmEHOFvoSJbwjXoxmahW3m+vwOgqId2wwcyyhJQ3DG2IY6ORVhva3OqfwAJA52rASLv4jqS7JF1eh8COgxXe+HVhNXu/25Qg6YKyIqx187oD6HZoSLvtJdwp6y3+Gbh6LFzr1lBdqjMtOyL+k+mFClHYtD5akgrRY/o8QEi6adWe9/jbxJnMPWqrbpZJpkModt26Uhphz4M0SHPqEHWQnawzgEi4ogZwIJ2aIKXW5K9BYctvIjgscm2cMqOLdtn4NUpNSL/SG1iVDV1Q5ZIrrk0uLAoZmEnQV8pD+/FkfrUb4WAfzm1QQ5m+/41IvFvSWCFZ++zIrDyiWWMXyz/JE5q3nef/sVCJPIo5gEi8dV7hVX+rOCf+nw4RVvpbnmgNp67qWON8M3TOykJAERTwSLxx7HehY+s2BJEbMDrOaGBwq/VtMwJ2eNPoNeCaoF0WSLxLuxN6OiutnkZLsttnLVMd+gKFFJheKSoDY39S+Ur47ki8S7ggGj1AGmwm21DBm0yL+h0+3M10k2rO10evE+9c4qkoSLxPwFSoTHqnDwchwB6lxMoSwr4tLqXD2PsNVD7WUMsuUBRIvErhwhRm6UnUgkl3d6KBtnHkI2sSuWNP0LXQCMWF3YBIvCt9njPNoJlRKkRpPqitu1diIoH9pI4Izg6UqUi8JBWSpaHnjpLew2HHmiKvO2+P3h5vpoFAoDe+OjpEFyiASLwiAdx0xx+AWE6BngXUIseW3ufd8HPCEcThRnqsSLwiF/IcPciRVNPuT6t+wh0tchO8dhwVQS2pC5j056dMj3BIvDHM2EsjmAWx5Bd6R0pF+TUdMAp2NSOsVLto8W773mv+KoBIvCIYQwp79V2avQIZObZT6IuN8b2a2H/YDPBya+OTY99NSLwrih5EQhPMMqLNxhO4jVqJSlskqmmDIDjlIOBIvFAUr4lFBtcggWnjv/cnlEhVXPCoyG+6AeolrzLDfUi8Th2MEP1gTcKxYD313QqIAcxP0LlXbqOCCys1mVZIvCgeVsJkOxJl+Nu5TCe7xoyRZ4hVaoUpuRBV7Yi0OfmyOEBIvHflNd2ykBP8d1rbL7+dlicbCZic0GPibE7g4ak6LCNIvGvwr3ntZE9w5nmitSy4u9OUNVoQxwPQ1daaAPBIvE5GwQK7d22cloq84jsYdsrB0i6gbbgzGsqVxONHhfBIvEJJApUlCeozT9ShtB+7FmB4qXrff+lXwmNhIEi8GGhC5uyW/+iwMB2PW3NEvm4NYCVoIDkIuw5Iu/57jlP/ZlbAxQ5x26Mcxwpp9PvGPQm0WCn4ZDCw/lnFwEi8HcMkULO43Jq53iwK+o5rZvm4ZDlnApocvrMOd+zCSLv6u44YqwupV4XiU/hS3MRQpEipmzZTIjEvlOW2FqBIvAJna9BV3OJVLGNvsLFua34r/tsZ9AoEwOO9grSneEi8S8EcTZlNBMeayUhkk2xEz+QX1mEs9ZbmPI8g3UyOgEi8S6bhKGlLpnE+dd2M4jTZKEQ+lQkp44aKEK6gY0i8Tba7Sg65V+MjINqFVzL7ceGuLjw7wULabOVBSLwiHzAOaZaW980wBzeoimhz7EfA882H7+GVvrwab/BbIUBIvCIcERJBxXzXAARu/lQNQbERkTH+AdEaKYqX9yvLqEi8IxygSkDqYCOJV5VkbpqzjpwUT0dov7w65yIcKDCgSLxQMdxSAmH+Pbr3koPtirGcnRsuEK8w7ZOAHIBIvEF1AXg/YrvJcwjpU2RleoJUzZBXwebcg5ZiY7BIvCu1zlAiUaXI/2Iwpbyt6H8ojAdk1cJSdlYqTqfaUcmaoEi8S9MNXyC6XVYU4HAcsswsMQpLdHJieohIvFCTCkMbBXWhc06BC9N+EbiEpN6rI70uLYBPZ2dTAAAAdwEAAAAAAIg3AAADAAAAVUNZajIdHCAdHiYmIRseHhwaGBoaFRkbGRkZGhkYGR0bGRoWFR4fHRkYFx0eFxcdGx0bHRwbG0i8S+AJ1YNHGkB/rROH1RzNcEwtukN8YlHgqKQuSLxHSSEHpgpJbnaHER+A3EpmGHx0r7PjSGU+fki8HeQJHpx7BGoQI/Ur+dXmF20W7ATVbKQLhbgMb5xgSLwiRZAiY7BDZ6o8YVy9ySMXP3om2fd4tbBbJfBIvCIj6QfzFT56ZEY2UCHSa7agw/Fh4WzQNyhls/BIvB6zYtAiOYIVZ1MkaTrbo3K0sjfB9A030j32RFAtOnM4kgFL4Ei/5ih3I1nHW9Sl5g2H10XtXxH6XJL4OpGnUwPa4Tx+cUkG/irOSLv+78hYVMXaL/4bf0QXSI8BSj1vZrfqCv9f1hKekFRISLxKV3a8X+qbIwW2ubQdiDOMKchuv42xYGkISLxL7+4eYl+H9JQPVDGpc4ocoPqhH5zKdXbfkuqASLwkzYiKSU9js0zmRnS3ovGHg3ZimtC0Zqw7eSgqSLwetqQIEZaIHfT/0oC5KxK6vsDhk4E4qqZlgEi77f3pBVeXfPKVnaNR/JN6o0yP+oEF8A7wSD+ApyWqTYzneLbed/DizaBNxmkR1MxESD94UZrBB59OrAwFS5aQnBQqt5GtXOi8H/BIP2nLNNvz17azdjyGb/NPqf+VjiDqNqf6wEg/VHaNXTEYcZ5e5+rQGSPjOC/8mEg/CXOQZMDpytlxjiCwe172SZf4YtY+SExIPrFnCg60l4lWzdbEWV8X04eru5M48WbO3e5IPiPKx90OVfkrW2gQgmdOsKy8B5ZEBr6ASD4ZRkUtO3/WTkOwJCt9XpMmoHoH0EbigEg9rn3HtGWTiH/DETt0U/DbY53Si7gKOoRIPLkpj+ruwjftHf9MSWvOctNAsWM6USJIwEg8O++4TARIF/KvN8FuLmi6vR8V9m6ODxNIPMiw9FKj03weP4jSThzS6mhoSonfDgxIPLgCQuPPN3pxAUdJiIDAWjm4GEz/lVTASDtfaKHy5zwKZIlJ3SsHKLEl/lB4eH16IsgsyJBIO2bQdEwvtgLlFb+3yG8g+oYUbyuISCL6x8hIOyBm8yPLYnL/gTpOVYxRgRBazT+bGbecSDmymi/OHBHBRnL0vc8cCTLyl87x6L4YJkhIBcxHLswsDgIauQBzcknhE/StkwwwSAXgLDdG9SMHEceBY18p1PxS+2yASDmYPLCXcjgkBN2K9Oi20nV09a3kKe1a2Iqs3sOASDm+h+wQ6Huvqn+2jP5zUXYORq1dv7QI9M0LUuOmhEg5p1QlIaB/AA5T8eVCL5eer3GDNm336Jcw9gj8SDjKmdYIurFxvATlpsDd1hz98LCpL40w0kg4Hafp+MpFlOunKQ/Gh8FmuheQxAhr6Eg4E3JlF+DCAw9jnqVBhPOti+Uh0TNwSDfT61sN+etsM2AGTy60hsCTOrFatV+cOdUJQYBINohm6uWU6YZ20umfpv3cJpkfztJo6ZfU8l1JXoBINzjPJwzCxgwKLnSu6Kd0vduZemMrYEg2c86Hr9U0/WORW0esI3W823Ivm+hASDYxZX7ER7vX/ZmfoQC0fhO6CpYq++zERcmACmxIMT3LPBmH2/jaKRbkTqvo9VJnOL/0L0UE2iVIL0Q/Y6kG+U8hqUAPDWGQW8ASm5mKD4bi4ObgoEguti/CVXygO6NtNB3O3KvO5fJzTd/9bKlgakgrM7C5ZLivbOiNbSkp4hJgMfW/UPYfHqcImmCgSCmwP6QO52uQssOm2dG8gTD7DIYx9O9h8EByNEgnYehILZSQvVAu8nbmOeiTMFiK3UJiqXKg2EgkjosHKHOc8AmOYZHhcvRcL9H1Is2QN4+4eE9nZ1MABGapAQAAAAAAiDcAAAQAAACp+OkrDhMVEA0LCw8PDQ0OFxMTSB5QrQsQij6OfsmueZFvkWEGaEgXbZzAw6O0RN/9PHbeQPTuwJryMEgM4J0hLqjQM35diZguxlxICnmWD+LrTKQ2qSlQSAp5wjhcl1l9hZdICnmNzNyMcyecoEgKeZYPteQPaakwPtmduUgKeb8pWO+1pVlOVFtfZEgKeoRz6CHXHnEPFIBICnqZ8csaOpHWGFaASAp6dFHZJX0LUpaksyhoCi6eQgRL8gZ39ARZfa6zXOyILjsQOmgHyXnIyVfA/sgrO5VSIDJ6WcBoB8l5yMlXwP7IKz564iAyelnE",Ll="data:audio/ogg;base64,T2dnUwACAAAAAAAAAAAAAAAAAAAAAGS5xGoBE09wdXNIZWFkAQE4AUAfAAAAAABPZ2dTAAAAAAAAAAAAAAAAAAABAAAA88vQ2wEWT3B1c1RhZ3MGAAAAZmZtcGVnAAAAAE9nZ1MAAIC7AAAAAAAAAAAAAAIAAAC2VBw+MgoLCgsLCwoLCQoJCgoKCgwKCwoMCgoMCgsKDAoKDAoKCgsMCgsMCgoLCQoKCgwKCwoLCBbP6DOOu0lxQAg5MrclO8vjGojYCDtq4OKFyV1LGAg8O1DiYEBmNzeACDzDZbbqoXqqmIAIPMNltuqheqqYgAg8w2W26p3dR5gIPMNltuqheqqYgAg8w2W26pGf4Ag8rK3nGSvqu0AIO+wUQL5PPvAIOneJrh5RIn+ACDl4SOArl/gswAg3I3wSEVzTq6gIMJBdCfSbRlzACCPwrXc/hmBF9vzgCCpEn/qQ9hOpYgg2wWclMuJauH6ICDkKwsV8Arku1Ag6mnDiTc5jg4e3eAg7auDicvT9VCgIPCL7IEMqwmIgCDzDZbZZA+psYseACDzNd4nR3Unmigg9GaW2WOunv1zACD0ZpbZX99OUbQg9GaW2WQPqbGLHgAg9GaW2uaSJPXgIPRmltlj6Yeb4CD0ZpbZZA+psYseACD0Zpba5pGFKaAg9GaW2WOuXW0AIPRmltljrl1tACD0C7eb26uEdm+AIPLjIgDf8PwxFmVgIPAlUiBuv/mIwCDsZKOAYJxN6zOgIOXhI4BgxTXVtrCQINyQ5J8gt4zxYCDCQXQny/b31DAghH4SVYktK6Yh4CCoA6rM5pRrQCDbBZyU7yyzOkAg5CsLFjnbilvwIOppw4oXJXUr0CDtq4OJzjedlXWh4CDwi+yGjILbD4Ag8w2W26qF6qpiACDzNd4nZp/XZ6gg9GaW26qF6qpiAT2dnUwAEuLwAAAAAAAAAAAAAAwAAAFYTyTUBCQg9FUY1cWxXpQ==",Ml=new Audio(Tl),cn=new Audio(Ll);cn.volume=.01;cn.loop=!0;const Rl={keyType:"curve25519Legacy",userIDInput:{name:"",email:""},userID:[],thread:1048576,iteration:512,pattern:"",patternNumber:"0123456789ABCDEFXXXX"[Math.floor(Math.random()*20)],patternLength:6+Math.floor(Math.random()*3),filter:"",vanitySubkey:!1,notification:{sfx:!1,ntfy:!1,ntfyTopic:""},nonstopMode:!1,saveToDirectory:!1,saveToDirectoryHandle:void 0,get backTime(){return this.thread*this.iteration},get estimatedHashCount(){let n=0,e=0;for(const r of this.pattern.toUpperCase())"0123456789ABCDEF".includes(r)?n++:r==="X"&&e++;return 16n**BigInt(n+(e?e-1:0))},subkeyCombinerArmoredA:"",subkeyCombinerArmoredB:"",running:!1,generatedKey:void 0,generatedKeyHistory:[],hashCount:0,runningTime:0,formatFingerprint(n){return n.toUpperCase().match(/[^]{1,4}/g).join(" ")},mounted(){this.patternHelper(),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&(this.thread=1024,this.iteration=256)},addUserID(){!this.userIDInput.name||!this.userIDInput.email||(this.userID.push({...this.userIDInput}),this.userIDInput.name=this.userIDInput.email="")},patternHelper(){this.pattern=this.formatFingerprint("*".repeat(40-this.patternLength)+this.patternNumber.repeat(this.patternLength))},async setSaveDirectory(){if(!window.showDirectoryPicker)return alert(`你的浏览器不支持 File System Access API。
参见：https://caniuse.com/native-filesystem-api`);this.saveToDirectoryHandle=await window.showDirectoryPicker({mode:"readwrite"}).catch(()=>{})},showAutoFilter(){alert(Xs(this.pattern))},async bulkDownload(){if(!this.generatedKeyHistory.length)return;const n=new gl;this.generatedKeyHistory.forEach(r=>n.addFile(`${r.privateKey.getFingerprint().toUpperCase()}-sec.asc`,r.privateKey.armor()));const e=document.createElement("a");e.href=URL.createObjectURL(await n.write()),e.download="vanity-keys.tar",e.click(),URL.revokeObjectURL(e.href)},async toggleKeygen(){if(this.running){this.running=!1;return}this.userID.length||(!this.userIDInput.name&&!this.userIDInput.email&&(this.userIDInput.name="Dummy",this.userIDInput.email="dummy@example.com"),this.addUserID()),this.hashCount=0,this.runningTime=0,this.running=!0,cn.play();try{const n={userIDs:this.userID};switch(this.keyType){case"curve25519Legacy":case"nistP256":case"nistP384":case"nistP521":case"brainpoolP256r1":case"brainpoolP384r1":case"brainpoolP512r1":n.type="ecc",n.curve=this.keyType;break;case"2048":case"3072":case"4096":n.type="rsa",n.rsaBits=parseInt(this.keyType);break}do{const e=await Bl(n,this.filter.replaceAll(`
`," ")||Xs(this.pattern),this.thread,this.iteration,(r,t)=>{this.hashCount=r,this.runningTime=t},()=>!this.running,this.vanitySubkey);if(e&&(this.generatedKey=e,this.generatedKeyHistory.push(e),this.notification.sfx&&Ml.play(),this.notification.ntfy&&this.notification.ntfyTopic&&fetch("https://ntfy.sh/",{method:"POST",body:JSON.stringify({topic:this.notification.ntfyTopic,markdown:!0,title:"webgl-vanity-gpg 计算出了新的密钥！",message:"Fingerprint: `"+this.formatFingerprint(e.publicKey.getFingerprint())+`\`

Created: `+e.publicKey.getCreationTime().toISOString()+`

请回到打开的 webgl-vanity-gpg 页面，在页面上/控制台中查看生成的密钥。`})}),this.saveToDirectory&&this.saveToDirectoryHandle)){const t=await(await this.saveToDirectoryHandle.getFileHandle(`${e.privateKey.getFingerprint().toUpperCase()}-sec.asc`,{create:!0})).createWritable();await t.write(new Blob([e.privateKey.armor()])),await t.close()}}while(this.running&&this.nonstopMode)}catch(n){alert(n)}finally{this.running=!1,cn.pause()}},async subkeyCombine(){try{const[n,e]=await Promise.all([this.subkeyCombinerArmoredA,this.subkeyCombinerArmoredB].map(i=>Ko({armoredKey:i})));n.subkeys.push(new $t(Object.assign(new Ri,e.keyPacket),n.toPublic()),...e.subkeys);const r=await Uo({privateKey:n,userIDs:n.users.map(i=>i.userID),date:n.keyPacket.created,format:"object"}),t=document.createElement("a");t.href=`data:text/plain;charset=utf-8,${encodeURIComponent(r.privateKey.armor())}`,t.download=`${r.privateKey.getFingerprint().toUpperCase()}-sec.asc`,t.click()}catch(n){alert(n)}}};Aa(Rl).mount();export{c as T};
